{"version":3,"sources":["canvas-to-blob.js","sortable.js","purify.js","fileinput.js","ru.js","uk.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5yBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrtGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"fileinput.js","sourcesContent":["/*\n * JavaScript Canvas to Blob 2.0.5\n * https://github.com/blueimp/JavaScript-Canvas-to-Blob\n *\n * Copyright 2012, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * http://www.opensource.org/licenses/MIT\n *\n * Based on stackoverflow user Stoive's code snippet:\n * http://stackoverflow.com/q/4998908\n */\n\n/*jslint nomen: true, regexp: true */\n/*global window, atob, Blob, ArrayBuffer, Uint8Array, define */\n\n(function (window) {\n    'use strict';\n    var CanvasPrototype = window.HTMLCanvasElement &&\n            window.HTMLCanvasElement.prototype,\n        hasBlobConstructor = window.Blob && (function () {\n            try {\n                return Boolean(new Blob());\n            } catch (e) {\n                return false;\n            }\n        }()),\n        hasArrayBufferViewSupport = hasBlobConstructor && window.Uint8Array &&\n            (function () {\n                try {\n                    return new Blob([new Uint8Array(100)]).size === 100;\n                } catch (e) {\n                    return false;\n                }\n            }()),\n        BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder ||\n            window.MozBlobBuilder || window.MSBlobBuilder,\n        dataURLtoBlob = (hasBlobConstructor || BlobBuilder) && window.atob &&\n            window.ArrayBuffer && window.Uint8Array && function (dataURI) {\n                var byteString,\n                    arrayBuffer,\n                    intArray,\n                    i,\n                    mimeString,\n                    bb;\n                if (dataURI.split(',')[0].indexOf('base64') >= 0) {\n                    // Convert base64 to raw binary data held in a string:\n                    byteString = atob(dataURI.split(',')[1]);\n                } else {\n                    // Convert base64/URLEncoded data component to raw binary data:\n                    byteString = decodeURIComponent(dataURI.split(',')[1]);\n                }\n                // Write the bytes of the string to an ArrayBuffer:\n                arrayBuffer = new ArrayBuffer(byteString.length);\n                intArray = new Uint8Array(arrayBuffer);\n                for (i = 0; i < byteString.length; i += 1) {\n                    intArray[i] = byteString.charCodeAt(i);\n                }\n                // Separate out the mime component:\n                mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\n                // Write the ArrayBuffer (or ArrayBufferView) to a blob:\n                if (hasBlobConstructor) {\n                    return new Blob(\n                        [hasArrayBufferViewSupport ? intArray : arrayBuffer],\n                        {type: mimeString}\n                    );\n                }\n                bb = new BlobBuilder();\n                bb.append(arrayBuffer);\n                return bb.getBlob(mimeString);\n            };\n    if (window.HTMLCanvasElement && !CanvasPrototype.toBlob) {\n        if (CanvasPrototype.mozGetAsFile) {\n            CanvasPrototype.toBlob = function (callback, type, quality) {\n                if (quality && CanvasPrototype.toDataURL && dataURLtoBlob) {\n                    callback(dataURLtoBlob(this.toDataURL(type, quality)));\n                } else {\n                    callback(this.mozGetAsFile('blob', type));\n                }\n            };\n        } else if (CanvasPrototype.toDataURL && dataURLtoBlob) {\n            CanvasPrototype.toBlob = function (callback, type, quality) {\n                callback(dataURLtoBlob(this.toDataURL(type, quality)));\n            };\n        }\n    }\n    if (typeof define === 'function' && define.amd) {\n        define(function () {\n            return dataURLtoBlob;\n        });\n    } else {\n        window.dataURLtoBlob = dataURLtoBlob;\n    }\n}(window));\n","/**!\n * KvSortable\n * @author\tRubaXa   <trash@rubaxa.org>\n * @license MIT\n *\n * Changed kvsortable plugin naming to prevent conflict with JQuery UI KvSortable\n * @author Kartik Visweswaran\n */\n(function (factory) {\n\t\"use strict\";\n\n\tif (typeof define === \"function\" && define.amd) {\n\t\tdefine(factory);\n\t}\n\telse if (typeof module != \"undefined\" && typeof module.exports != \"undefined\") {\n\t\tmodule.exports = factory();\n\t}\n\telse if (typeof Package !== \"undefined\") {\n\t\tKvSortable = factory();  // export for Meteor.js\n\t}\n\telse {\n\t\t/* jshint sub:true */\n\t\twindow[\"KvSortable\"] = factory();\n\t}\n})(function () {\n\t\"use strict\";\n\t\n\tif (typeof window === \"undefined\" || typeof window.document == \"undefined\") {\n\t\treturn function() {\n\t\t\tthrow new Error( \"sortable.js requires a window with a document\" );\n\t\t}\n\t}\n\n\tvar dragEl,\n\t\tparentEl,\n\t\tghostEl,\n\t\tcloneEl,\n\t\trootEl,\n\t\tnextEl,\n\n\t\tscrollEl,\n\t\tscrollParentEl,\n\n\t\tlastEl,\n\t\tlastCSS,\n\t\tlastParentCSS,\n\n\t\toldIndex,\n\t\tnewIndex,\n\n\t\tactiveGroup,\n\t\tautoScroll = {},\n\n\t\ttapEvt,\n\t\ttouchEvt,\n\n\t\tmoved,\n\n\t\t/** @const */\n\t\tRSPACE = /\\s+/g,\n\n\t\texpando = 'KvSortable' + (new Date).getTime(),\n\n\t\twin = window,\n\t\tdocument = win.document,\n\t\tparseInt = win.parseInt,\n\n\t\tsupportDraggable = !!('draggable' in document.createElement('div')),\n\t\tsupportCssPointerEvents = (function (el) {\n\t\t\tel = document.createElement('x');\n\t\t\tel.style.cssText = 'pointer-events:auto';\n\t\t\treturn el.style.pointerEvents === 'auto';\n\t\t})(),\n\n\t\t_silent = false,\n\n\t\tabs = Math.abs,\n\t\tslice = [].slice,\n\n\t\ttouchDragOverListeners = [],\n\n\t\t_autoScroll = _throttle(function (/**Event*/evt, /**Object*/options, /**HTMLElement*/rootEl) {\n\t\t\t// Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=505521\n\t\t\tif (rootEl && options.scroll) {\n\t\t\t\tvar el,\n\t\t\t\t\trect,\n\t\t\t\t\tsens = options.scrollSensitivity,\n\t\t\t\t\tspeed = options.scrollSpeed,\n\n\t\t\t\t\tx = evt.clientX,\n\t\t\t\t\ty = evt.clientY,\n\n\t\t\t\t\twinWidth = window.innerWidth,\n\t\t\t\t\twinHeight = window.innerHeight,\n\n\t\t\t\t\tvx,\n\t\t\t\t\tvy\n\t\t\t\t;\n\n\t\t\t\t// Delect scrollEl\n\t\t\t\tif (scrollParentEl !== rootEl) {\n\t\t\t\t\tscrollEl = options.scroll;\n\t\t\t\t\tscrollParentEl = rootEl;\n\n\t\t\t\t\tif (scrollEl === true) {\n\t\t\t\t\t\tscrollEl = rootEl;\n\n\t\t\t\t\t\tdo {\n\t\t\t\t\t\t\tif ((scrollEl.offsetWidth < scrollEl.scrollWidth) ||\n\t\t\t\t\t\t\t\t(scrollEl.offsetHeight < scrollEl.scrollHeight)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/* jshint boss:true */\n\t\t\t\t\t\t} while (scrollEl = scrollEl.parentNode);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (scrollEl) {\n\t\t\t\t\tel = scrollEl;\n\t\t\t\t\trect = scrollEl.getBoundingClientRect();\n\t\t\t\t\tvx = (abs(rect.right - x) <= sens) - (abs(rect.left - x) <= sens);\n\t\t\t\t\tvy = (abs(rect.bottom - y) <= sens) - (abs(rect.top - y) <= sens);\n\t\t\t\t}\n\n\n\t\t\t\tif (!(vx || vy)) {\n\t\t\t\t\tvx = (winWidth - x <= sens) - (x <= sens);\n\t\t\t\t\tvy = (winHeight - y <= sens) - (y <= sens);\n\n\t\t\t\t\t/* jshint expr:true */\n\t\t\t\t\t(vx || vy) && (el = win);\n\t\t\t\t}\n\n\n\t\t\t\tif (autoScroll.vx !== vx || autoScroll.vy !== vy || autoScroll.el !== el) {\n\t\t\t\t\tautoScroll.el = el;\n\t\t\t\t\tautoScroll.vx = vx;\n\t\t\t\t\tautoScroll.vy = vy;\n\n\t\t\t\t\tclearInterval(autoScroll.pid);\n\n\t\t\t\t\tif (el) {\n\t\t\t\t\t\tautoScroll.pid = setInterval(function () {\n\t\t\t\t\t\t\tif (el === win) {\n\t\t\t\t\t\t\t\twin.scrollTo(win.pageXOffset + vx * speed, win.pageYOffset + vy * speed);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvy && (el.scrollTop += vy * speed);\n\t\t\t\t\t\t\t\tvx && (el.scrollLeft += vx * speed);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 24);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, 30),\n\n\t\t_prepareGroup = function (options) {\n\t\t\tvar group = options.group;\n\n\t\t\tif (!group || typeof group != 'object') {\n\t\t\t\tgroup = options.group = {name: group};\n\t\t\t}\n\n\t\t\t['pull', 'put'].forEach(function (key) {\n\t\t\t\tif (!(key in group)) {\n\t\t\t\t\tgroup[key] = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\toptions.groups = ' ' + group.name + (group.put.join ? ' ' + group.put.join(' ') : '') + ' ';\n\t\t}\n\t;\n\n\n\n\t/**\n\t * @class  KvSortable\n\t * @param  {HTMLElement}  el\n\t * @param  {Object}       [options]\n\t */\n\tfunction KvSortable(el, options) {\n\t\tif (!(el && el.nodeType && el.nodeType === 1)) {\n\t\t\tthrow 'KvSortable: `el` must be HTMLElement, and not ' + {}.toString.call(el);\n\t\t}\n\n\t\tthis.el = el; // root element\n\t\tthis.options = options = _extend({}, options);\n\n\n\t\t// Export instance\n\t\tel[expando] = this;\n\n\n\t\t// Default options\n\t\tvar defaults = {\n\t\t\tgroup: Math.random(),\n\t\t\tsort: true,\n\t\t\tdisabled: false,\n\t\t\tstore: null,\n\t\t\thandle: null,\n\t\t\tscroll: true,\n\t\t\tscrollSensitivity: 30,\n\t\t\tscrollSpeed: 10,\n\t\t\tdraggable: /[uo]l/i.test(el.nodeName) ? 'li' : '>*',\n\t\t\tghostClass: 'kvsortable-ghost',\n\t\t\tchosenClass: 'kvsortable-chosen',\n\t\t\tignore: 'a, img',\n\t\t\tfilter: null,\n\t\t\tanimation: 0,\n\t\t\tsetData: function (dataTransfer, dragEl) {\n\t\t\t\tdataTransfer.setData('Text', dragEl.textContent);\n\t\t\t},\n\t\t\tdropBubble: false,\n\t\t\tdragoverBubble: false,\n\t\t\tdataIdAttr: 'data-id',\n\t\t\tdelay: 0,\n\t\t\tforceFallback: false,\n\t\t\tfallbackClass: 'kvsortable-fallback',\n\t\t\tfallbackOnBody: false\n\t\t};\n\n\n\t\t// Set default options\n\t\tfor (var name in defaults) {\n\t\t\t!(name in options) && (options[name] = defaults[name]);\n\t\t}\n\n\t\t_prepareGroup(options);\n\n\t\t// Bind all private methods\n\t\tfor (var fn in this) {\n\t\t\tif (fn.charAt(0) === '_') {\n\t\t\t\tthis[fn] = this[fn].bind(this);\n\t\t\t}\n\t\t}\n\n\t\t// Setup drag mode\n\t\tthis.nativeDraggable = options.forceFallback ? false : supportDraggable;\n\n\t\t// Bind events\n\t\t_on(el, 'mousedown', this._onTapStart);\n\t\t_on(el, 'touchstart', this._onTapStart);\n\n\t\tif (this.nativeDraggable) {\n\t\t\t_on(el, 'dragover', this);\n\t\t\t_on(el, 'dragenter', this);\n\t\t}\n\n\t\ttouchDragOverListeners.push(this._onDragOver);\n\n\t\t// Restore sorting\n\t\toptions.store && this.sort(options.store.get(this));\n\t}\n\n\n\tKvSortable.prototype = /** @lends KvSortable.prototype */ {\n\t\tconstructor: KvSortable,\n\n\t\t_onTapStart: function (/** Event|TouchEvent */evt) {\n\t\t\tvar _this = this,\n\t\t\t\tel = this.el,\n\t\t\t\toptions = this.options,\n\t\t\t\ttype = evt.type,\n\t\t\t\ttouch = evt.touches && evt.touches[0],\n\t\t\t\ttarget = (touch || evt).target,\n\t\t\t\toriginalTarget = target,\n\t\t\t\tfilter = options.filter;\n\n\n\t\t\tif (type === 'mousedown' && evt.button !== 0 || options.disabled) {\n\t\t\t\treturn; // only left button or enabled\n\t\t\t}\n\n\t\t\ttarget = _closest(target, options.draggable, el);\n\n\t\t\tif (!target) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// get the index of the dragged element within its parent\n\t\t\toldIndex = _index(target, options.draggable);\n\n\t\t\t// Check filter\n\t\t\tif (typeof filter === 'function') {\n\t\t\t\tif (filter.call(this, evt, target, this)) {\n\t\t\t\t\t_dispatchEvent(_this, originalTarget, 'filter', target, el, oldIndex);\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\treturn; // cancel dnd\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (filter) {\n\t\t\t\tfilter = filter.split(',').some(function (criteria) {\n\t\t\t\t\tcriteria = _closest(originalTarget, criteria.trim(), el);\n\n\t\t\t\t\tif (criteria) {\n\t\t\t\t\t\t_dispatchEvent(_this, criteria, 'filter', target, el, oldIndex);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (filter) {\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\treturn; // cancel dnd\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tif (options.handle && !_closest(originalTarget, options.handle, el)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\n\t\t\t// Prepare `dragstart`\n\t\t\tthis._prepareDragStart(evt, touch, target);\n\t\t},\n\n\t\t_prepareDragStart: function (/** Event */evt, /** Touch */touch, /** HTMLElement */target) {\n\t\t\tvar _this = this,\n\t\t\t\tel = _this.el,\n\t\t\t\toptions = _this.options,\n\t\t\t\townerDocument = el.ownerDocument,\n\t\t\t\tdragStartFn;\n\n\t\t\tif (target && !dragEl && (target.parentNode === el)) {\n\t\t\t\ttapEvt = evt;\n\n\t\t\t\trootEl = el;\n\t\t\t\tdragEl = target;\n\t\t\t\tparentEl = dragEl.parentNode;\n\t\t\t\tnextEl = dragEl.nextSibling;\n\t\t\t\tactiveGroup = options.group;\n\n\t\t\t\tdragStartFn = function () {\n\t\t\t\t\t// Delayed drag has been triggered\n\t\t\t\t\t// we can re-enable the events: touchmove/mousemove\n\t\t\t\t\t_this._disableDelayedDrag();\n\n\t\t\t\t\t// Make the element draggable\n\t\t\t\t\tdragEl.draggable = true;\n\n\t\t\t\t\t// Chosen item\n\t\t\t\t\t_toggleClass(dragEl, _this.options.chosenClass, true);\n\n\t\t\t\t\t// Bind the events: dragstart/dragend\n\t\t\t\t\t_this._triggerDragStart(touch);\n\t\t\t\t};\n\n\t\t\t\t// Disable \"draggable\"\n\t\t\t\toptions.ignore.split(',').forEach(function (criteria) {\n\t\t\t\t\t_find(dragEl, criteria.trim(), _disableDraggable);\n\t\t\t\t});\n\n\t\t\t\t_on(ownerDocument, 'mouseup', _this._onDrop);\n\t\t\t\t_on(ownerDocument, 'touchend', _this._onDrop);\n\t\t\t\t_on(ownerDocument, 'touchcancel', _this._onDrop);\n\n\t\t\t\tif (options.delay) {\n\t\t\t\t\t// If the user moves the pointer or let go the click or touch\n\t\t\t\t\t// before the delay has been reached:\n\t\t\t\t\t// disable the delayed drag\n\t\t\t\t\t_on(ownerDocument, 'mouseup', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchend', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchcancel', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'mousemove', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchmove', _this._disableDelayedDrag);\n\n\t\t\t\t\t_this._dragStartTimer = setTimeout(dragStartFn, options.delay);\n\t\t\t\t} else {\n\t\t\t\t\tdragStartFn();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_disableDelayedDrag: function () {\n\t\t\tvar ownerDocument = this.el.ownerDocument;\n\n\t\t\tclearTimeout(this._dragStartTimer);\n\t\t\t_off(ownerDocument, 'mouseup', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchend', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchcancel', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'mousemove', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchmove', this._disableDelayedDrag);\n\t\t},\n\n\t\t_triggerDragStart: function (/** Touch */touch) {\n\t\t\tif (touch) {\n\t\t\t\t// Touch device support\n\t\t\t\ttapEvt = {\n\t\t\t\t\ttarget: dragEl,\n\t\t\t\t\tclientX: touch.clientX,\n\t\t\t\t\tclientY: touch.clientY\n\t\t\t\t};\n\n\t\t\t\tthis._onDragStart(tapEvt, 'touch');\n\t\t\t}\n\t\t\telse if (!this.nativeDraggable) {\n\t\t\t\tthis._onDragStart(tapEvt, true);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t_on(dragEl, 'dragend', this);\n\t\t\t\t_on(rootEl, 'dragstart', this._onDragStart);\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tif (document.selection) {\n\t\t\t\t\tdocument.selection.empty();\n\t\t\t\t} else {\n\t\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t}\n\t\t},\n\n\t\t_dragStarted: function () {\n\t\t\tif (rootEl && dragEl) {\n\t\t\t\t// Apply effect\n\t\t\t\t_toggleClass(dragEl, this.options.ghostClass, true);\n\n\t\t\t\tKvSortable.active = this;\n\n\t\t\t\t// Drag start event\n\t\t\t\t_dispatchEvent(this, rootEl, 'start', dragEl, rootEl, oldIndex);\n\t\t\t}\n\t\t},\n\n\t\t_emulateDragOver: function () {\n\t\t\tif (touchEvt) {\n\t\t\t\tif (this._lastX === touchEvt.clientX && this._lastY === touchEvt.clientY) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis._lastX = touchEvt.clientX;\n\t\t\t\tthis._lastY = touchEvt.clientY;\n\n\t\t\t\tif (!supportCssPointerEvents) {\n\t\t\t\t\t_css(ghostEl, 'display', 'none');\n\t\t\t\t}\n\n\t\t\t\tvar target = document.elementFromPoint(touchEvt.clientX, touchEvt.clientY),\n\t\t\t\t\tparent = target,\n\t\t\t\t\tgroupName = ' ' + this.options.group.name + '',\n\t\t\t\t\ti = touchDragOverListeners.length;\n\n\t\t\t\tif (parent) {\n\t\t\t\t\tdo {\n\t\t\t\t\t\tif (parent[expando] && parent[expando].options.groups.indexOf(groupName) > -1) {\n\t\t\t\t\t\t\twhile (i--) {\n\t\t\t\t\t\t\t\ttouchDragOverListeners[i]({\n\t\t\t\t\t\t\t\t\tclientX: touchEvt.clientX,\n\t\t\t\t\t\t\t\t\tclientY: touchEvt.clientY,\n\t\t\t\t\t\t\t\t\ttarget: target,\n\t\t\t\t\t\t\t\t\trootEl: parent\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttarget = parent; // store last element\n\t\t\t\t\t}\n\t\t\t\t\t/* jshint boss:true */\n\t\t\t\t\twhile (parent = parent.parentNode);\n\t\t\t\t}\n\n\t\t\t\tif (!supportCssPointerEvents) {\n\t\t\t\t\t_css(ghostEl, 'display', '');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\t\t_onTouchMove: function (/**TouchEvent*/evt) {\n\t\t\tif (tapEvt) {\n\t\t\t\t// only set the status to dragging, when we are actually dragging\n\t\t\t\tif (!KvSortable.active) {\n\t\t\t\t\tthis._dragStarted();\n\t\t\t\t}\n\n\t\t\t\t// as well as creating the ghost element on the document body\n\t\t\t\tthis._appendGhost();\n\n\t\t\t\tvar touch = evt.touches ? evt.touches[0] : evt,\n\t\t\t\t\tdx = touch.clientX - tapEvt.clientX,\n\t\t\t\t\tdy = touch.clientY - tapEvt.clientY,\n\t\t\t\t\ttranslate3d = evt.touches ? 'translate3d(' + dx + 'px,' + dy + 'px,0)' : 'translate(' + dx + 'px,' + dy + 'px)';\n\n\t\t\t\tmoved = true;\n\t\t\t\ttouchEvt = touch;\n\n\t\t\t\t_css(ghostEl, 'webkitTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'mozTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'msTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'transform', translate3d);\n\n\t\t\t\tevt.preventDefault();\n\t\t\t}\n\t\t},\n\n\t\t_appendGhost: function () {\n\t\t\tif (!ghostEl) {\n\t\t\t\tvar rect = dragEl.getBoundingClientRect(),\n\t\t\t\t\tcss = _css(dragEl),\n\t\t\t\t\toptions = this.options,\n\t\t\t\t\tghostRect;\n\n\t\t\t\tghostEl = dragEl.cloneNode(true);\n\n\t\t\t\t_toggleClass(ghostEl, options.ghostClass, false);\n\t\t\t\t_toggleClass(ghostEl, options.fallbackClass, true);\n\n\t\t\t\t_css(ghostEl, 'top', rect.top - parseInt(css.marginTop, 10));\n\t\t\t\t_css(ghostEl, 'left', rect.left - parseInt(css.marginLeft, 10));\n\t\t\t\t_css(ghostEl, 'width', rect.width);\n\t\t\t\t_css(ghostEl, 'height', rect.height);\n\t\t\t\t_css(ghostEl, 'opacity', '0.8');\n\t\t\t\t_css(ghostEl, 'position', 'fixed');\n\t\t\t\t_css(ghostEl, 'zIndex', '100000');\n\t\t\t\t_css(ghostEl, 'pointerEvents', 'none');\n\n\t\t\t\toptions.fallbackOnBody && document.body.appendChild(ghostEl) || rootEl.appendChild(ghostEl);\n\n\t\t\t\t// Fixing dimensions.\n\t\t\t\tghostRect = ghostEl.getBoundingClientRect();\n\t\t\t\t_css(ghostEl, 'width', rect.width * 2 - ghostRect.width);\n\t\t\t\t_css(ghostEl, 'height', rect.height * 2 - ghostRect.height);\n\t\t\t}\n\t\t},\n\n\t\t_onDragStart: function (/**Event*/evt, /**boolean*/useFallback) {\n\t\t\tvar dataTransfer = evt.dataTransfer,\n\t\t\t\toptions = this.options;\n\n\t\t\tthis._offUpEvents();\n\n\t\t\tif (activeGroup.pull == 'clone') {\n\t\t\t\tcloneEl = dragEl.cloneNode(true);\n\t\t\t\t_css(cloneEl, 'display', 'none');\n\t\t\t\trootEl.insertBefore(cloneEl, dragEl);\n\t\t\t}\n\n\t\t\tif (useFallback) {\n\n\t\t\t\tif (useFallback === 'touch') {\n\t\t\t\t\t// Bind touch events\n\t\t\t\t\t_on(document, 'touchmove', this._onTouchMove);\n\t\t\t\t\t_on(document, 'touchend', this._onDrop);\n\t\t\t\t\t_on(document, 'touchcancel', this._onDrop);\n\t\t\t\t} else {\n\t\t\t\t\t// Old brwoser\n\t\t\t\t\t_on(document, 'mousemove', this._onTouchMove);\n\t\t\t\t\t_on(document, 'mouseup', this._onDrop);\n\t\t\t\t}\n\n\t\t\t\tthis._loopId = setInterval(this._emulateDragOver, 50);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (dataTransfer) {\n\t\t\t\t\tdataTransfer.effectAllowed = 'move';\n\t\t\t\t\toptions.setData && options.setData.call(this, dataTransfer, dragEl);\n\t\t\t\t}\n\n\t\t\t\t_on(document, 'drop', this);\n\t\t\t\tsetTimeout(this._dragStarted, 0);\n\t\t\t}\n\t\t},\n\n\t\t_onDragOver: function (/**Event*/evt) {\n\t\t\tvar el = this.el,\n\t\t\t\ttarget,\n\t\t\t\tdragRect,\n\t\t\t\trevert,\n\t\t\t\toptions = this.options,\n\t\t\t\tgroup = options.group,\n\t\t\t\tgroupPut = group.put,\n\t\t\t\tisOwner = (activeGroup === group),\n\t\t\t\tcanSort = options.sort;\n\n\t\t\tif (evt.preventDefault !== void 0) {\n\t\t\t\tevt.preventDefault();\n\t\t\t\t!options.dragoverBubble && evt.stopPropagation();\n\t\t\t}\n\n\t\t\tmoved = true;\n\n\t\t\tif (activeGroup && !options.disabled &&\n\t\t\t\t(isOwner\n\t\t\t\t\t? canSort || (revert = !rootEl.contains(dragEl)) // Reverting item into the original list\n\t\t\t\t\t: activeGroup.pull && groupPut && (\n\t\t\t\t\t\t(activeGroup.name === group.name) || // by Name\n\t\t\t\t\t\t(groupPut.indexOf && ~groupPut.indexOf(activeGroup.name)) // by Array\n\t\t\t\t\t)\n\t\t\t\t) &&\n\t\t\t\t(evt.rootEl === void 0 || evt.rootEl === this.el) // touch fallback\n\t\t\t) {\n\t\t\t\t// Smart auto-scrolling\n\t\t\t\t_autoScroll(evt, options, this.el);\n\n\t\t\t\tif (_silent) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\ttarget = _closest(evt.target, options.draggable, el);\n\t\t\t\tdragRect = dragEl.getBoundingClientRect();\n\n\t\t\t\tif (revert) {\n\t\t\t\t\t_cloneHide(true);\n\n\t\t\t\t\tif (cloneEl || nextEl) {\n\t\t\t\t\t\trootEl.insertBefore(dragEl, cloneEl || nextEl);\n\t\t\t\t\t}\n\t\t\t\t\telse if (!canSort) {\n\t\t\t\t\t\trootEl.appendChild(dragEl);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\n\t\t\t\tif ((el.children.length === 0) || (el.children[0] === ghostEl) ||\n\t\t\t\t\t(el === evt.target) && (target = _ghostIsLast(el, evt))\n\t\t\t\t) {\n\n\t\t\t\t\tif (target) {\n\t\t\t\t\t\tif (target.animated) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttargetRect = target.getBoundingClientRect();\n\t\t\t\t\t}\n\n\t\t\t\t\t_cloneHide(isOwner);\n\n\t\t\t\t\tif (_onMove(rootEl, el, dragEl, dragRect, target, targetRect) !== false) {\n\t\t\t\t\t\tif (!dragEl.contains(el)) {\n\t\t\t\t\t\t\tel.appendChild(dragEl);\n\t\t\t\t\t\t\tparentEl = el; // actualization\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis._animate(dragRect, dragEl);\n\t\t\t\t\t\ttarget && this._animate(targetRect, target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (target && !target.animated && target !== dragEl && (target.parentNode[expando] !== void 0)) {\n\t\t\t\t\tif (lastEl !== target) {\n\t\t\t\t\t\tlastEl = target;\n\t\t\t\t\t\tlastCSS = _css(target);\n\t\t\t\t\t\tlastParentCSS = _css(target.parentNode);\n\t\t\t\t\t}\n\n\n\t\t\t\t\tvar targetRect = target.getBoundingClientRect(),\n\t\t\t\t\t\twidth = targetRect.right - targetRect.left,\n\t\t\t\t\t\theight = targetRect.bottom - targetRect.top,\n\t\t\t\t\t\tfloating = /left|right|inline/.test(lastCSS.cssFloat + lastCSS.display)\n\t\t\t\t\t\t\t|| (lastParentCSS.display == 'flex' && lastParentCSS['flex-direction'].indexOf('row') === 0),\n\t\t\t\t\t\tisWide = (target.offsetWidth > dragEl.offsetWidth),\n\t\t\t\t\t\tisLong = (target.offsetHeight > dragEl.offsetHeight),\n\t\t\t\t\t\thalfway = (floating ? (evt.clientX - targetRect.left) / width : (evt.clientY - targetRect.top) / height) > 0.5,\n\t\t\t\t\t\tnextSibling = target.nextElementSibling,\n\t\t\t\t\t\tmoveVector = _onMove(rootEl, el, dragEl, dragRect, target, targetRect),\n\t\t\t\t\t\tafter\n\t\t\t\t\t;\n\n\t\t\t\t\tif (moveVector !== false) {\n\t\t\t\t\t\t_silent = true;\n\t\t\t\t\t\tsetTimeout(_unsilent, 30);\n\n\t\t\t\t\t\t_cloneHide(isOwner);\n\n\t\t\t\t\t\tif (moveVector === 1 || moveVector === -1) {\n\t\t\t\t\t\t\tafter = (moveVector === 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (floating) {\n\t\t\t\t\t\t\tvar elTop = dragEl.offsetTop,\n\t\t\t\t\t\t\t\ttgTop = target.offsetTop;\n\n\t\t\t\t\t\t\tif (elTop === tgTop) {\n\t\t\t\t\t\t\t\tafter = (target.previousElementSibling === dragEl) && !isWide || halfway && isWide;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tafter = tgTop > elTop;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tafter = (nextSibling !== dragEl) && !isLong || halfway && isLong;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!dragEl.contains(el)) {\n\t\t\t\t\t\t\tif (after && !nextSibling) {\n\t\t\t\t\t\t\t\tel.appendChild(dragEl);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttarget.parentNode.insertBefore(dragEl, after ? nextSibling : target);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tparentEl = dragEl.parentNode; // actualization\n\n\t\t\t\t\t\tthis._animate(dragRect, dragEl);\n\t\t\t\t\t\tthis._animate(targetRect, target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_animate: function (prevRect, target) {\n\t\t\tvar ms = this.options.animation;\n\n\t\t\tif (ms) {\n\t\t\t\tvar currentRect = target.getBoundingClientRect();\n\n\t\t\t\t_css(target, 'transition', 'none');\n\t\t\t\t_css(target, 'transform', 'translate3d('\n\t\t\t\t\t+ (prevRect.left - currentRect.left) + 'px,'\n\t\t\t\t\t+ (prevRect.top - currentRect.top) + 'px,0)'\n\t\t\t\t);\n\n\t\t\t\ttarget.offsetWidth; // repaint\n\n\t\t\t\t_css(target, 'transition', 'all ' + ms + 'ms');\n\t\t\t\t_css(target, 'transform', 'translate3d(0,0,0)');\n\n\t\t\t\tclearTimeout(target.animated);\n\t\t\t\ttarget.animated = setTimeout(function () {\n\t\t\t\t\t_css(target, 'transition', '');\n\t\t\t\t\t_css(target, 'transform', '');\n\t\t\t\t\ttarget.animated = false;\n\t\t\t\t}, ms);\n\t\t\t}\n\t\t},\n\n\t\t_offUpEvents: function () {\n\t\t\tvar ownerDocument = this.el.ownerDocument;\n\n\t\t\t_off(document, 'touchmove', this._onTouchMove);\n\t\t\t_off(ownerDocument, 'mouseup', this._onDrop);\n\t\t\t_off(ownerDocument, 'touchend', this._onDrop);\n\t\t\t_off(ownerDocument, 'touchcancel', this._onDrop);\n\t\t},\n\n\t\t_onDrop: function (/**Event*/evt) {\n\t\t\tvar el = this.el,\n\t\t\t\toptions = this.options;\n\n\t\t\tclearInterval(this._loopId);\n\t\t\tclearInterval(autoScroll.pid);\n\t\t\tclearTimeout(this._dragStartTimer);\n\n\t\t\t// Unbind events\n\t\t\t_off(document, 'mousemove', this._onTouchMove);\n\n\t\t\tif (this.nativeDraggable) {\n\t\t\t\t_off(document, 'drop', this);\n\t\t\t\t_off(el, 'dragstart', this._onDragStart);\n\t\t\t}\n\n\t\t\tthis._offUpEvents();\n\n\t\t\tif (evt) {\n\t\t\t\tif (moved) {\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t!options.dropBubble && evt.stopPropagation();\n\t\t\t\t}\n\n\t\t\t\tghostEl && ghostEl.parentNode.removeChild(ghostEl);\n\n\t\t\t\tif (dragEl) {\n\t\t\t\t\tif (this.nativeDraggable) {\n\t\t\t\t\t\t_off(dragEl, 'dragend', this);\n\t\t\t\t\t}\n\n\t\t\t\t\t_disableDraggable(dragEl);\n\n\t\t\t\t\t// Remove class's\n\t\t\t\t\t_toggleClass(dragEl, this.options.ghostClass, false);\n\t\t\t\t\t_toggleClass(dragEl, this.options.chosenClass, false);\n\n\t\t\t\t\tif (rootEl !== parentEl) {\n\t\t\t\t\t\tnewIndex = _index(dragEl, options.draggable);\n\n\t\t\t\t\t\tif (newIndex >= 0) {\n\t\t\t\t\t\t\t// drag from one list and drop into another\n\t\t\t\t\t\t\t_dispatchEvent(null, parentEl, 'sort', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'sort', dragEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t\t// Add event\n\t\t\t\t\t\t\t_dispatchEvent(null, parentEl, 'add', dragEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t\t// Remove event\n\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'remove', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Remove clone\n\t\t\t\t\t\tcloneEl && cloneEl.parentNode.removeChild(cloneEl);\n\n\t\t\t\t\t\tif (dragEl.nextSibling !== nextEl) {\n\t\t\t\t\t\t\t// Get the index of the dragged element within its parent\n\t\t\t\t\t\t\tnewIndex = _index(dragEl, options.draggable);\n\n\t\t\t\t\t\t\tif (newIndex >= 0) {\n\t\t\t\t\t\t\t\t// drag & drop within the same list\n\t\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'update', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'sort', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (KvSortable.active) {\n\t\t\t\t\t\tif (newIndex === null || newIndex === -1) {\n\t\t\t\t\t\t\tnewIndex = oldIndex;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'end', dragEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t// Save sorting\n\t\t\t\t\t\tthis.save();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tthis._nulling();\n\t\t},\n\n\t\t_nulling: function() {\n\t\t\t// Nulling\n\t\t\trootEl =\n\t\t\tdragEl =\n\t\t\tparentEl =\n\t\t\tghostEl =\n\t\t\tnextEl =\n\t\t\tcloneEl =\n\n\t\t\tscrollEl =\n\t\t\tscrollParentEl =\n\n\t\t\ttapEvt =\n\t\t\ttouchEvt =\n\n\t\t\tmoved =\n\t\t\tnewIndex =\n\n\t\t\tlastEl =\n\t\t\tlastCSS =\n\n\t\t\tactiveGroup =\n\t\t\tKvSortable.active = null;\n\t\t},\n\n\t\thandleEvent: function (/**Event*/evt) {\n\t\t\tvar type = evt.type;\n\n\t\t\tif (type === 'dragover' || type === 'dragenter') {\n\t\t\t\tif (dragEl) {\n\t\t\t\t\tthis._onDragOver(evt);\n\t\t\t\t\t_globalDragOver(evt);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (type === 'drop' || type === 'dragend') {\n\t\t\t\tthis._onDrop(evt);\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Serializes the item into an array of string.\n\t\t * @returns {String[]}\n\t\t */\n\t\ttoArray: function () {\n\t\t\tvar order = [],\n\t\t\t\tel,\n\t\t\t\tchildren = this.el.children,\n\t\t\t\ti = 0,\n\t\t\t\tn = children.length,\n\t\t\t\toptions = this.options;\n\n\t\t\tfor (; i < n; i++) {\n\t\t\t\tel = children[i];\n\t\t\t\tif (_closest(el, options.draggable, this.el)) {\n\t\t\t\t\torder.push(el.getAttribute(options.dataIdAttr) || _generateId(el));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn order;\n\t\t},\n\n\n\t\t/**\n\t\t * Sorts the elements according to the array.\n\t\t * @param  {String[]}  order  order of the items\n\t\t */\n\t\tsort: function (order) {\n\t\t\tvar items = {}, rootEl = this.el;\n\n\t\t\tthis.toArray().forEach(function (id, i) {\n\t\t\t\tvar el = rootEl.children[i];\n\n\t\t\t\tif (_closest(el, this.options.draggable, rootEl)) {\n\t\t\t\t\titems[id] = el;\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\torder.forEach(function (id) {\n\t\t\t\tif (items[id]) {\n\t\t\t\t\trootEl.removeChild(items[id]);\n\t\t\t\t\trootEl.appendChild(items[id]);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\n\t\t/**\n\t\t * Save the current sorting\n\t\t */\n\t\tsave: function () {\n\t\t\tvar store = this.options.store;\n\t\t\tstore && store.set(this);\n\t\t},\n\n\n\t\t/**\n\t\t * For each element in the set, get the first element that matches the selector by testing the element itself and traversing up through its ancestors in the DOM tree.\n\t\t * @param   {HTMLElement}  el\n\t\t * @param   {String}       [selector]  default: `options.draggable`\n\t\t * @returns {HTMLElement|null}\n\t\t */\n\t\tclosest: function (el, selector) {\n\t\t\treturn _closest(el, selector || this.options.draggable, this.el);\n\t\t},\n\n\n\t\t/**\n\t\t * Set/get option\n\t\t * @param   {string} name\n\t\t * @param   {*}      [value]\n\t\t * @returns {*}\n\t\t */\n\t\toption: function (name, value) {\n\t\t\tvar options = this.options;\n\n\t\t\tif (value === void 0) {\n\t\t\t\treturn options[name];\n\t\t\t} else {\n\t\t\t\toptions[name] = value;\n\n\t\t\t\tif (name === 'group') {\n\t\t\t\t\t_prepareGroup(options);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Destroy\n\t\t */\n\t\tdestroy: function () {\n\t\t\tvar el = this.el;\n\n\t\t\tel[expando] = null;\n\n\t\t\t_off(el, 'mousedown', this._onTapStart);\n\t\t\t_off(el, 'touchstart', this._onTapStart);\n\n\t\t\tif (this.nativeDraggable) {\n\t\t\t\t_off(el, 'dragover', this);\n\t\t\t\t_off(el, 'dragenter', this);\n\t\t\t}\n\n\t\t\t// Remove draggable attributes\n\t\t\tArray.prototype.forEach.call(el.querySelectorAll('[draggable]'), function (el) {\n\t\t\t\tel.removeAttribute('draggable');\n\t\t\t});\n\n\t\t\ttouchDragOverListeners.splice(touchDragOverListeners.indexOf(this._onDragOver), 1);\n\n\t\t\tthis._onDrop();\n\n\t\t\tthis.el = el = null;\n\t\t}\n\t};\n\n\n\tfunction _cloneHide(state) {\n\t\tif (cloneEl && (cloneEl.state !== state)) {\n\t\t\t_css(cloneEl, 'display', state ? 'none' : '');\n\t\t\t!state && cloneEl.state && rootEl.insertBefore(cloneEl, dragEl);\n\t\t\tcloneEl.state = state;\n\t\t}\n\t}\n\n\n\tfunction _closest(/**HTMLElement*/el, /**String*/selector, /**HTMLElement*/ctx) {\n\t\tif (el) {\n\t\t\tctx = ctx || document;\n\n\t\t\tdo {\n\t\t\t\tif (\n\t\t\t\t\t(selector === '>*' && el.parentNode === ctx)\n\t\t\t\t\t|| _matches(el, selector)\n\t\t\t\t) {\n\t\t\t\t\treturn el;\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (el !== ctx && (el = el.parentNode));\n\t\t}\n\n\t\treturn null;\n\t}\n\n\n\tfunction _globalDragOver(/**Event*/evt) {\n\t\tif (evt.dataTransfer) {\n\t\t\tevt.dataTransfer.dropEffect = 'move';\n\t\t}\n\t\tevt.preventDefault();\n\t}\n\n\n\tfunction _on(el, event, fn) {\n\t\tel.addEventListener(event, fn, false);\n\t}\n\n\n\tfunction _off(el, event, fn) {\n\t\tel.removeEventListener(event, fn, false);\n\t}\n\n\n\tfunction _toggleClass(el, name, state) {\n\t\tif (el) {\n\t\t\tif (el.classList) {\n\t\t\t\tel.classList[state ? 'add' : 'remove'](name);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar className = (' ' + el.className + ' ').replace(RSPACE, ' ').replace(' ' + name + ' ', ' ');\n\t\t\t\tel.className = (className + (state ? ' ' + name : '')).replace(RSPACE, ' ');\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction _css(el, prop, val) {\n\t\tvar style = el && el.style;\n\n\t\tif (style) {\n\t\t\tif (val === void 0) {\n\t\t\t\tif (document.defaultView && document.defaultView.getComputedStyle) {\n\t\t\t\t\tval = document.defaultView.getComputedStyle(el, '');\n\t\t\t\t}\n\t\t\t\telse if (el.currentStyle) {\n\t\t\t\t\tval = el.currentStyle;\n\t\t\t\t}\n\n\t\t\t\treturn prop === void 0 ? val : val[prop];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!(prop in style)) {\n\t\t\t\t\tprop = '-webkit-' + prop;\n\t\t\t\t}\n\n\t\t\t\tstyle[prop] = val + (typeof val === 'string' ? '' : 'px');\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction _find(ctx, tagName, iterator) {\n\t\tif (ctx) {\n\t\t\tvar list = ctx.getElementsByTagName(tagName), i = 0, n = list.length;\n\n\t\t\tif (iterator) {\n\t\t\t\tfor (; i < n; i++) {\n\t\t\t\t\titerator(list[i], i);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn list;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\n\n\tfunction _dispatchEvent(kvsortable, rootEl, name, targetEl, fromEl, startIndex, newIndex) {\n\t\tvar evt = document.createEvent('Event'),\n\t\t\toptions = (kvsortable || rootEl[expando]).options,\n\t\t\tonName = 'on' + name.charAt(0).toUpperCase() + name.substr(1);\n\n\t\tevt.initEvent(name, true, true);\n\n\t\tevt.to = rootEl;\n\t\tevt.from = fromEl || rootEl;\n\t\tevt.item = targetEl || rootEl;\n\t\tevt.clone = cloneEl;\n\n\t\tevt.oldIndex = startIndex;\n\t\tevt.newIndex = newIndex;\n\n\t\trootEl.dispatchEvent(evt);\n\n\t\tif (options[onName]) {\n\t\t\toptions[onName].call(kvsortable, evt);\n\t\t}\n\t}\n\n\n\tfunction _onMove(fromEl, toEl, dragEl, dragRect, targetEl, targetRect) {\n\t\tvar evt,\n\t\t\tkvsortable = fromEl[expando],\n\t\t\tonMoveFn = kvsortable.options.onMove,\n\t\t\tretVal;\n\n\t\tevt = document.createEvent('Event');\n\t\tevt.initEvent('move', true, true);\n\n\t\tevt.to = toEl;\n\t\tevt.from = fromEl;\n\t\tevt.dragged = dragEl;\n\t\tevt.draggedRect = dragRect;\n\t\tevt.related = targetEl || toEl;\n\t\tevt.relatedRect = targetRect || toEl.getBoundingClientRect();\n\n\t\tfromEl.dispatchEvent(evt);\n\n\t\tif (onMoveFn) {\n\t\t\tretVal = onMoveFn.call(kvsortable, evt);\n\t\t}\n\n\t\treturn retVal;\n\t}\n\n\n\tfunction _disableDraggable(el) {\n\t\tel.draggable = false;\n\t}\n\n\n\tfunction _unsilent() {\n\t\t_silent = false;\n\t}\n\n\n\t/** @returns {HTMLElement|false} */\n\tfunction _ghostIsLast(el, evt) {\n\t\tvar lastEl = el.lastElementChild,\n\t\t\t\trect = lastEl.getBoundingClientRect();\n\n\t\treturn ((evt.clientY - (rect.top + rect.height) > 5) || (evt.clientX - (rect.right + rect.width) > 5)) && lastEl; // min delta\n\t}\n\n\n\t/**\n\t * Generate id\n\t * @param   {HTMLElement} el\n\t * @returns {String}\n\t * @private\n\t */\n\tfunction _generateId(el) {\n\t\tvar str = el.tagName + el.className + el.src + el.href + el.textContent,\n\t\t\ti = str.length,\n\t\t\tsum = 0;\n\n\t\twhile (i--) {\n\t\t\tsum += str.charCodeAt(i);\n\t\t}\n\n\t\treturn sum.toString(36);\n\t}\n\n\t/**\n\t * Returns the index of an element within its parent for a selected set of\n\t * elements\n\t * @param  {HTMLElement} el\n\t * @param  {selector} selector\n\t * @return {number}\n\t */\n\tfunction _index(el, selector) {\n\t\tvar index = 0;\n\n\t\tif (!el || !el.parentNode) {\n\t\t\treturn -1;\n\t\t}\n\n\t\twhile (el && (el = el.previousElementSibling)) {\n\t\t\tif (el.nodeName.toUpperCase() !== 'TEMPLATE'\n\t\t\t\t\t&& _matches(el, selector)) {\n\t\t\t\tindex++;\n\t\t\t}\n\t\t}\n\n\t\treturn index;\n\t}\n\n\tfunction _matches(/**HTMLElement*/el, /**String*/selector) {\n\t\tif (el) {\n\t\t\tselector = selector.split('.');\n\n\t\t\tvar tag = selector.shift().toUpperCase(),\n\t\t\t\tre = new RegExp('\\\\s(' + selector.join('|') + ')(?=\\\\s)', 'g');\n\n\t\t\treturn (\n\t\t\t\t(tag === '' || el.nodeName.toUpperCase() == tag) &&\n\t\t\t\t(!selector.length || ((' ' + el.className + ' ').match(re) || []).length == selector.length)\n\t\t\t);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tfunction _throttle(callback, ms) {\n\t\tvar args, _this;\n\n\t\treturn function () {\n\t\t\tif (args === void 0) {\n\t\t\t\targs = arguments;\n\t\t\t\t_this = this;\n\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tif (args.length === 1) {\n\t\t\t\t\t\tcallback.call(_this, args[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcallback.apply(_this, args);\n\t\t\t\t\t}\n\n\t\t\t\t\targs = void 0;\n\t\t\t\t}, ms);\n\t\t\t}\n\t\t};\n\t}\n\n\tfunction _extend(dst, src) {\n\t\tif (dst && src) {\n\t\t\tfor (var key in src) {\n\t\t\t\tif (src.hasOwnProperty(key)) {\n\t\t\t\t\tdst[key] = src[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn dst;\n\t}\n\n\n\t// Export utils\n\tKvSortable.utils = {\n\t\ton: _on,\n\t\toff: _off,\n\t\tcss: _css,\n\t\tfind: _find,\n\t\tis: function (el, selector) {\n\t\t\treturn !!_closest(el, selector, el);\n\t\t},\n\t\textend: _extend,\n\t\tthrottle: _throttle,\n\t\tclosest: _closest,\n\t\ttoggleClass: _toggleClass,\n\t\tindex: _index\n\t};\n\n\n\t/**\n\t * Create kvsortable instance\n\t * @param {HTMLElement}  el\n\t * @param {Object}      [options]\n\t */\n\tKvSortable.create = function (el, options) {\n\t\treturn new KvSortable(el, options);\n\t};\n\n\n\t// Export\n\tKvSortable.version = '1.4.2';\n\treturn KvSortable;\n});\n/**\n * jQuery plugin for KvSortable\n * @author\tRubaXa   <trash@rubaxa.org>\n * @license MIT\n */\n(function (factory) {\n\t\"use strict\";\n\n\tif (typeof define === \"function\" && define.amd) {\n\t\tdefine([\"jquery\"], factory);\n\t}\n\telse {\n\t\t/* jshint sub:true */\n\t\tfactory(jQuery);\n\t}\n})(function ($) {\n\t\"use strict\";\n\n\n\t/* CODE */\n\n\n\t/**\n\t * jQuery plugin for KvSortable\n\t * @param   {Object|String} options\n\t * @param   {..*}           [args]\n\t * @returns {jQuery|*}\n\t */\n\t$.fn.kvsortable = function (options) {\n\t\tvar retVal,\n\t\t\targs = arguments;\n\n\t\tthis.each(function () {\n\t\t\tvar $el = $(this),\n\t\t\t\tkvsortable = $el.data('kvsortable');\n\n\t\t\tif (!kvsortable && (options instanceof Object || !options)) {\n\t\t\t\tkvsortable = new KvSortable(this, options);\n\t\t\t\t$el.data('kvsortable', kvsortable);\n\t\t\t}\n\n\t\t\tif (kvsortable) {\n\t\t\t\tif (options === 'widget') {\n\t\t\t\t\treturn kvsortable;\n\t\t\t\t}\n\t\t\t\telse if (options === 'destroy') {\n\t\t\t\t\tkvsortable.destroy();\n\t\t\t\t\t$el.removeData('kvsortable');\n\t\t\t\t}\n\t\t\t\telse if (typeof kvsortable[options] === 'function') {\n\t\t\t\t\tretVal = kvsortable[options].apply(kvsortable, [].slice.call(args, 1));\n\t\t\t\t}\n\t\t\t\telse if (options in kvsortable.options) {\n\t\t\t\t\tretVal = kvsortable.option.apply(kvsortable, args);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn (retVal === void 0) ? this : retVal;\n\t};\n});\n",";(function(factory) {\n    'use strict';\n    /* global window: false, define: false, module: false */\n    var root = typeof window === 'undefined' ? null : window;\n\n    if (typeof define === 'function' && define.amd) {\n        define(function(){ return factory(root); });\n    } else if (typeof module !== 'undefined') {\n        module.exports = factory(root);\n    } else {\n        root.DOMPurify = factory(root);\n    }\n}(function factory(window) {\n    'use strict';\n\n    var DOMPurify = function(window) {\n        return factory(window);\n    };\n\n    /**\n     * Version label, exposed for easier checks\n     * if DOMPurify is up to date or not\n     */\n    DOMPurify.version = '0.7.4';\n\n    if (!window || !window.document || window.document.nodeType !== 9) {\n        // not running in a browser, provide a factory function\n        // so that you can pass your own Window\n        DOMPurify.isSupported = false;\n        return DOMPurify;\n    }\n\n    var document = window.document;\n    var originalDocument = document;\n    var DocumentFragment = window.DocumentFragment;\n    var HTMLTemplateElement = window.HTMLTemplateElement;\n    var NodeFilter = window.NodeFilter;\n    var NamedNodeMap = window.NamedNodeMap || window.MozNamedAttrMap;\n    var Text = window.Text;\n    var Comment = window.Comment;\n    var DOMParser = window.DOMParser;\n\n    // As per issue #47, the web-components registry is inherited by a\n    // new document created via createHTMLDocument. As per the spec\n    // (http://w3c.github.io/webcomponents/spec/custom/#creating-and-passing-registries)\n    // a new empty registry is used when creating a template contents owner\n    // document, so we use that as our parent document to ensure nothing\n    // is inherited.\n    if (typeof HTMLTemplateElement === 'function') {\n        var template = document.createElement('template');\n        if (template.content && template.content.ownerDocument) {\n            document = template.content.ownerDocument;\n        }\n    }\n    var implementation = document.implementation;\n    var createNodeIterator = document.createNodeIterator;\n    var getElementsByTagName = document.getElementsByTagName;\n    var createDocumentFragment = document.createDocumentFragment;\n    var importNode = originalDocument.importNode;\n\n    var hooks = {};\n\n    /**\n     * Expose whether this browser supports running the full DOMPurify.\n     */\n    DOMPurify.isSupported =\n        typeof implementation.createHTMLDocument !== 'undefined' &&\n        document.documentMode !== 9;\n\n    /* Add properties to a lookup table */\n    var _addToSet = function(set, array) {\n        var l = array.length;\n        while (l--) {\n            if (typeof array[l] === 'string') {\n                array[l] = array[l].toLowerCase();\n            }\n            set[array[l]] = true;\n        }\n        return set;\n    };\n\n    /* Shallow clone an object */\n    var _cloneObj = function(object) {\n        var newObject = {};\n        var property;\n        for (property in object) {\n            if (object.hasOwnProperty(property)) {\n                newObject[property] = object[property];\n            }\n        }\n        return newObject;\n    };\n\n    /**\n     * We consider the elements and attributes below to be safe. Ideally\n     * don't add any new ones but feel free to remove unwanted ones.\n     */\n\n    /* allowed element names */\n    var ALLOWED_TAGS = null;\n    var DEFAULT_ALLOWED_TAGS = _addToSet({}, [\n\n        // HTML\n        'a','abbr','acronym','address','area','article','aside','audio','b',\n        'bdi','bdo','big','blink','blockquote','body','br','button','canvas',\n        'caption','center','cite','code','col','colgroup','content','data',\n        'datalist','dd','decorator','del','details','dfn','dir','div','dl','dt',\n        'element','em','fieldset','figcaption','figure','font','footer','form',\n        'h1','h2','h3','h4','h5','h6','head','header','hgroup','hr','html','i',\n        'img','input','ins','kbd','label','legend','li','main','map','mark',\n        'marquee','menu','menuitem','meter','nav','nobr','ol','optgroup',\n        'option','output','p','pre','progress','q','rp','rt','ruby','s','samp',\n        'section','select','shadow','small','source','spacer','span','strike',\n        'strong','style','sub','summary','sup','table','tbody','td','template',\n        'textarea','tfoot','th','thead','time','tr','track','tt','u','ul','var',\n        'video','wbr',\n\n        // SVG\n        'svg','altglyph','altglyphdef','altglyphitem','animatecolor',\n        'animatemotion','animatetransform','circle','clippath','defs','desc',\n        'ellipse','filter','font','g','glyph','glyphref','hkern','image','line',\n        'lineargradient','marker','mask','metadata','mpath','path','pattern',\n        'polygon','polyline','radialgradient','rect','stop','switch','symbol',\n        'text','textpath','title','tref','tspan','view','vkern',\n\n        // SVG Filters\n        'feBlend','feColorMatrix','feComponentTransfer','feComposite',\n        'feConvolveMatrix','feDiffuseLighting','feDisplacementMap',\n        'feFlood','feFuncA','feFuncB','feFuncG','feFuncR','feGaussianBlur',\n        'feMerge','feMergeNode','feMorphology','feOffset',\n        'feSpecularLighting','feTile','feTurbulence',\n\n        //MathML\n        'math','menclose','merror','mfenced','mfrac','mglyph','mi','mlabeledtr',\n        'mmuliscripts','mn','mo','mover','mpadded','mphantom','mroot','mrow',\n        'ms','mpspace','msqrt','mystyle','msub','msup','msubsup','mtable','mtd',\n        'mtext','mtr','munder','munderover',\n\n        //Text\n        '#text'\n    ]);\n\n    /* Allowed attribute names */\n    var ALLOWED_ATTR = null;\n    var DEFAULT_ALLOWED_ATTR = _addToSet({}, [\n\n        // HTML\n        'accept','action','align','alt','autocomplete','background','bgcolor',\n        'border','cellpadding','cellspacing','checked','cite','class','clear','color',\n        'cols','colspan','coords','datetime','default','dir','disabled',\n        'download','enctype','face','for','headers','height','hidden','high','href',\n        'hreflang','id','ismap','label','lang','list','loop', 'low','max',\n        'maxlength','media','method','min','multiple','name','noshade','novalidate',\n        'nowrap','open','optimum','pattern','placeholder','poster','preload','pubdate',\n        'radiogroup','readonly','rel','required','rev','reversed','rows',\n        'rowspan','spellcheck','scope','selected','shape','size','span',\n        'srclang','start','src','step','style','summary','tabindex','title',\n        'type','usemap','valign','value','width','xmlns',\n\n        // SVG\n        'accent-height','accumulate','additivive','alignment-baseline',\n        'ascent','attributename','attributetype','azimuth','basefrequency',\n        'baseline-shift','begin','bias','by','clip','clip-path','clip-rule',\n        'color','color-interpolation','color-interpolation-filters','color-profile',\n        'color-rendering','cx','cy','d','dx','dy','diffuseconstant','direction',\n        'display','divisor','dur','edgemode','elevation','end','fill','fill-opacity',\n        'fill-rule','filter','flood-color','flood-opacity','font-family','font-size',\n        'font-size-adjust','font-stretch','font-style','font-variant','font-weight',\n        'fx', 'fy','g1','g2','glyph-name','glyphref','gradientunits','gradienttransform',\n        'image-rendering','in','in2','k','k1','k2','k3','k4','kerning','keypoints',\n        'keysplines','keytimes','lengthadjust','letter-spacing','kernelmatrix',\n        'kernelunitlength','lighting-color','local','marker-end','marker-mid',\n        'marker-start','markerheight','markerunits','markerwidth','maskcontentunits',\n        'maskunits','max','mask','mode','min','numoctaves','offset','operator',\n        'opacity','order','orient','orientation','origin','overflow','paint-order',\n        'path','pathlength','patterncontentunits','patterntransform','patternunits',\n        'points','preservealpha','r','rx','ry','radius','refx','refy','repeatcount',\n        'repeatdur','restart','result','rotate','scale','seed','shape-rendering',\n        'specularconstant','specularexponent','spreadmethod','stddeviation','stitchtiles',\n        'stop-color','stop-opacity','stroke-dasharray','stroke-dashoffset','stroke-linecap',\n        'stroke-linejoin','stroke-miterlimit','stroke-opacity','stroke','stroke-width',\n        'surfacescale','targetx','targety','transform','text-anchor','text-decoration',\n        'text-rendering','textlength','u1','u2','unicode','values','viewbox',\n        'visibility','vert-adv-y','vert-origin-x','vert-origin-y','word-spacing',\n        'wrap','writing-mode','xchannelselector','ychannelselector','x','x1','x2',\n        'y','y1','y2','z','zoomandpan',\n\n        // MathML\n        'accent','accentunder','bevelled','close','columnsalign','columnlines',\n        'columnspan','denomalign','depth','display','displaystyle','fence',\n        'frame','largeop','length','linethickness','lspace','lquote',\n        'mathbackground','mathcolor','mathsize','mathvariant','maxsize',\n        'minsize','movablelimits','notation','numalign','open','rowalign',\n        'rowlines','rowspacing','rowspan','rspace','rquote','scriptlevel',\n        'scriptminsize','scriptsizemultiplier','selection','separator',\n        'separators','stretchy','subscriptshift','supscriptshift','symmetric',\n        'voffset',\n\n        // XML\n        'xlink:href','xml:id','xlink:title','xml:space','xmlns:xlink'\n    ]);\n\n    /* Explicitly forbidden tags (overrides ALLOWED_TAGS/ADD_TAGS) */\n    var FORBID_TAGS = null;\n\n    /* Explicitly forbidden attributes (overrides ALLOWED_ATTR/ADD_ATTR) */\n    var FORBID_ATTR = null;\n\n    /* Decide if custom data attributes are okay */\n    var ALLOW_DATA_ATTR = true;\n\n    /* Decide if unknown protocols are okay */\n    var ALLOW_UNKNOWN_PROTOCOLS = false;\n\n    /* Output should be safe for jQuery's $() factory? */\n    var SAFE_FOR_JQUERY = false;\n\n    /* Output should be safe for common template engines.\n     * This means, DOMPurify removes data attributes, mustaches and ERB\n     */\n    var SAFE_FOR_TEMPLATES = false;\n\n    /* Specify template detection regex for SAFE_FOR_TEMPLATES mode */\n    var MUSTACHE_EXPR = /\\{\\{[\\s\\S]*|[\\s\\S]*\\}\\}/gm;\n    var ERB_EXPR = /<%[\\s\\S]*|[\\s\\S]*%>/gm;\n\n    /* Decide if document with <html>... should be returned */\n    var WHOLE_DOCUMENT = false;\n\n    /* Decide if a DOM `HTMLBodyElement` should be returned, instead of a html string.\n     * If `WHOLE_DOCUMENT` is enabled a `HTMLHtmlElement` will be returned instead\n     */\n    var RETURN_DOM = false;\n\n    /* Decide if a DOM `DocumentFragment` should be returned, instead of a html string */\n    var RETURN_DOM_FRAGMENT = false;\n\n    /* If `RETURN_DOM` or `RETURN_DOM_FRAGMENT` is enabled, decide if the returned DOM\n     * `Node` is imported into the current `Document`. If this flag is not enabled the\n     * `Node` will belong (its ownerDocument) to a fresh `HTMLDocument`, created by\n     * DOMPurify. */\n    var RETURN_DOM_IMPORT = false;\n\n    /* Output should be free from DOM clobbering attacks? */\n    var SANITIZE_DOM = true;\n\n    /* Keep element content when removing element? */\n    var KEEP_CONTENT = true;\n\n    /* Tags to ignore content of when KEEP_CONTENT is true */\n    var FORBID_CONTENTS = _addToSet({}, [\n        'audio', 'head', 'math', 'script', 'style', 'svg', 'video'\n    ]);\n\n    /* Tags that are safe for data: URIs */\n    var DATA_URI_TAGS = _addToSet({}, [\n        'audio', 'video', 'img', 'source'\n    ]);\n\n    /* Attributes safe for values like \"javascript:\" */\n    var URI_SAFE_ATTRIBUTES = _addToSet({}, [\n        'alt','class','for','id','label','name','pattern','placeholder',\n        'summary','title','value','style','xmlns'\n    ]);\n\n    /* Keep a reference to config to pass to hooks */\n    var CONFIG = null;\n\n    /* Ideally, do not touch anything below this line */\n    /* ______________________________________________ */\n\n    var formElement = document.createElement('form');\n\n    /**\n     * _parseConfig\n     *\n     * @param  optional config literal\n     */\n    var _parseConfig = function(cfg) {\n        /* Shield configuration object from tampering */\n        if (typeof cfg !== 'object') {\n            cfg = {};\n        }\n\n        /* Set configuration parameters */\n        ALLOWED_TAGS = 'ALLOWED_TAGS' in cfg ?\n            _addToSet({}, cfg.ALLOWED_TAGS) : DEFAULT_ALLOWED_TAGS;\n        ALLOWED_ATTR = 'ALLOWED_ATTR' in cfg ?\n            _addToSet({}, cfg.ALLOWED_ATTR) : DEFAULT_ALLOWED_ATTR;\n        FORBID_TAGS = 'FORBID_TAGS' in cfg ?\n            _addToSet({}, cfg.FORBID_TAGS) : {};\n        FORBID_ATTR = 'FORBID_ATTR' in cfg ?\n            _addToSet({}, cfg.FORBID_ATTR) : {};\n        ALLOW_DATA_ATTR     = cfg.ALLOW_DATA_ATTR     !== false; // Default true\n        ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false; // Default false\n        SAFE_FOR_JQUERY     = cfg.SAFE_FOR_JQUERY     ||  false; // Default false\n        SAFE_FOR_TEMPLATES  = cfg.SAFE_FOR_TEMPLATES  ||  false; // Default false\n        WHOLE_DOCUMENT      = cfg.WHOLE_DOCUMENT      ||  false; // Default false\n        RETURN_DOM          = cfg.RETURN_DOM          ||  false; // Default false\n        RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT ||  false; // Default false\n        RETURN_DOM_IMPORT   = cfg.RETURN_DOM_IMPORT   ||  false; // Default false\n        SANITIZE_DOM        = cfg.SANITIZE_DOM        !== false; // Default true\n        KEEP_CONTENT        = cfg.KEEP_CONTENT        !== false; // Default true\n\n        if (SAFE_FOR_TEMPLATES) {\n            ALLOW_DATA_ATTR = false;\n        }\n\n        if (RETURN_DOM_FRAGMENT) {\n            RETURN_DOM = true;\n        }\n\n        /* Merge configuration parameters */\n        if (cfg.ADD_TAGS) {\n            if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {\n                ALLOWED_TAGS = _cloneObj(ALLOWED_TAGS);\n            }\n            _addToSet(ALLOWED_TAGS, cfg.ADD_TAGS);\n        }\n        if (cfg.ADD_ATTR) {\n            if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {\n                ALLOWED_ATTR = _cloneObj(ALLOWED_ATTR);\n            }\n            _addToSet(ALLOWED_ATTR, cfg.ADD_ATTR);\n        }\n\n        /* Add #text in case KEEP_CONTENT is set to true */\n        if (KEEP_CONTENT) { ALLOWED_TAGS['#text'] = true; }\n\n        // Prevent further manipulation of configuration.\n        // Not available in IE8, Safari 5, etc.\n        if (Object && 'freeze' in Object) { Object.freeze(cfg); }\n\n        CONFIG = cfg;\n    };\n\n   /**\n     * _forceRemove\n     *\n     * @param  a DOM node\n     */\n    var _forceRemove = function(node) {\n        try {\n            node.parentNode.removeChild(node);\n        } catch (e) {\n            node.outerHTML = '';\n        }\n    };\n\n   /**\n     * _initDocument\n     *\n     * @param  a string of dirty markup\n     * @return a DOM, filled with the dirty markup\n     */\n    var _initDocument = function(dirty) {\n        /* Create a HTML document using DOMParser */\n        var doc, body;\n        try {\n            doc = new DOMParser().parseFromString(dirty, 'text/html');\n        } catch (e) {}\n\n        /* Some browsers throw, some browsers return null for the code above\n           DOMParser with text/html support is only in very recent browsers. */\n        if (!doc) {\n            doc = implementation.createHTMLDocument('');\n            body = doc.body;\n            body.parentNode.removeChild(body.parentNode.firstElementChild);\n            body.outerHTML = dirty;\n        }\n\n        /* Work on whole document or just its body */\n        if (typeof doc.getElementsByTagName === 'function') {\n            return doc.getElementsByTagName(\n                WHOLE_DOCUMENT ? 'html' : 'body')[0];\n        }\n        return getElementsByTagName.call(doc,\n            WHOLE_DOCUMENT ? 'html' : 'body')[0];\n    };\n\n    /**\n     * _createIterator\n     *\n     * @param  document/fragment to create iterator for\n     * @return iterator instance\n     */\n    var _createIterator = function(root) {\n        return createNodeIterator.call(root.ownerDocument || root,\n            root,\n            NodeFilter.SHOW_ELEMENT\n            | NodeFilter.SHOW_COMMENT\n            | NodeFilter.SHOW_TEXT,\n            function() { return NodeFilter.FILTER_ACCEPT; },\n            false\n        );\n    };\n\n    /**\n     * _isClobbered\n     *\n     * @param  element to check for clobbering attacks\n     * @return true if clobbered, false if safe\n     */\n    var _isClobbered = function(elm) {\n        if (elm instanceof Text || elm instanceof Comment) {\n            return false;\n        }\n        if (  typeof elm.nodeName !== 'string'\n           || typeof elm.textContent !== 'string'\n           || typeof elm.removeChild !== 'function'\n           || !(elm.attributes instanceof NamedNodeMap)\n           || typeof elm.removeAttribute !== 'function'\n           || typeof elm.setAttribute !== 'function'\n        ) {\n            return true;\n        }\n        return false;\n    };\n\n    /**\n     * _sanitizeElements\n     *\n     * @protect nodeName\n     * @protect textContent\n     * @protect removeChild\n     *\n     * @param   node to check for permission to exist\n     * @return  true if node was killed, false if left alive\n     */\n    var _sanitizeElements = function(currentNode) {\n        var tagName, content;\n        /* Execute a hook if present */\n        _executeHook('beforeSanitizeElements', currentNode, null);\n\n        /* Check if element is clobbered or can clobber */\n        if (_isClobbered(currentNode)) {\n            _forceRemove(currentNode);\n            return true;\n        }\n\n        /* Now let's check the element's type and name */\n        tagName = currentNode.nodeName.toLowerCase();\n\n        /* Execute a hook if present */\n        _executeHook('uponSanitizeElement', currentNode, {\n            tagName: tagName\n        });\n\n        /* Remove element if anything forbids its presence */\n        if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n            /* Keep content except for black-listed elements */\n            if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]\n                    && typeof currentNode.insertAdjacentHTML === 'function') {\n                try {\n                    currentNode.insertAdjacentHTML('AfterEnd', currentNode.innerHTML);\n                } catch (e) {}\n            }\n            _forceRemove(currentNode);\n            return true;\n        }\n\n        /* Convert markup to cover jQuery behavior */\n        if (SAFE_FOR_JQUERY && !currentNode.firstElementChild &&\n                (!currentNode.content || !currentNode.content.firstElementChild)) {\n            currentNode.innerHTML = currentNode.textContent.replace(/</g, '&lt;');\n        }\n\n        /* Sanitize element content to be template-safe */\n        if (SAFE_FOR_TEMPLATES && currentNode.nodeType === 3) {\n            /* Get the element's text content */\n            content = currentNode.textContent;\n            content = content.replace(MUSTACHE_EXPR, ' ');\n            content = content.replace(ERB_EXPR, ' ');\n            currentNode.textContent = content;\n        }\n\n        /* Execute a hook if present */\n        _executeHook('afterSanitizeElements', currentNode, null);\n\n        return false;\n    };\n\n    var DATA_ATTR = /^data-[\\w.\\u00B7-\\uFFFF-]/;\n    var IS_ALLOWED_URI = /^(?:(?:(?:f|ht)tps?|mailto|tel):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i;\n    var IS_SCRIPT_OR_DATA = /^(?:\\w+script|data):/i;\n    /* This needs to be extensive thanks to Webkit/Blink's behavior */\n    var ATTR_WHITESPACE = /[\\x00-\\x20\\xA0\\u1680\\u180E\\u2000-\\u2029\\u205f\\u3000]/g;\n\n    /**\n     * _sanitizeAttributes\n     *\n     * @protect attributes\n     * @protect nodeName\n     * @protect removeAttribute\n     * @protect setAttribute\n     *\n     * @param   node to sanitize\n     * @return  void\n     */\n    var _sanitizeAttributes = function(currentNode) {\n        var attr, name, value, lcName, idAttr, attributes, hookEvent, l;\n        /* Execute a hook if present */\n        _executeHook('beforeSanitizeAttributes', currentNode, null);\n\n        attributes = currentNode.attributes;\n\n        /* Check if we have attributes; if not we might have a text node */\n        if (!attributes) { return; }\n\n        hookEvent = {\n            attrName: '',\n            attrValue: '',\n            keepAttr: true\n        };\n        l = attributes.length;\n\n        /* Go backwards over all attributes; safely remove bad ones */\n        while (l--) {\n            attr = attributes[l];\n            name = attr.name;\n            value = attr.value;\n            lcName = name.toLowerCase();\n\n            /* Execute a hook if present */\n            hookEvent.attrName = lcName;\n            hookEvent.attrValue = value;\n            hookEvent.keepAttr = true;\n            _executeHook('uponSanitizeAttribute', currentNode, hookEvent );\n            value = hookEvent.attrValue;\n\n            /* Remove attribute */\n            // Safari (iOS + Mac), last tested v8.0.5, crashes if you try to\n            // remove a \"name\" attribute from an <img> tag that has an \"id\"\n            // attribute at the time.\n            if (lcName === 'name'  &&\n                    currentNode.nodeName === 'IMG' && attributes.id) {\n                idAttr = attributes.id;\n                attributes = Array.prototype.slice.apply(attributes);\n                currentNode.removeAttribute('id');\n                currentNode.removeAttribute(name);\n                if (attributes.indexOf(idAttr) > l) {\n                    currentNode.setAttribute('id', idAttr.value);\n                }\n            } else {\n                // This avoids a crash in Safari v9.0 with double-ids.\n                // The trick is to first set the id to be empty and then to\n                // remove the attriubute\n                if (name === 'id') {\n                    currentNode.setAttribute(name, '');\n                }\n                currentNode.removeAttribute(name);\n            }\n\n            /* Did the hooks approve of the attribute? */\n            if (!hookEvent.keepAttr) {\n                continue;\n            }\n\n            /* Make sure attribute cannot clobber */\n            if (SANITIZE_DOM &&\n                    (lcName === 'id' || lcName === 'name') &&\n                    (value in window || value in document || value in formElement)) {\n                continue;\n            }\n\n            /* Sanitize attribute content to be template-safe */\n            if (SAFE_FOR_TEMPLATES) {\n                value = value.replace(MUSTACHE_EXPR, ' ');\n                value = value.replace(ERB_EXPR, ' ');\n            }\n\n            if (\n                /* Check the name is permitted */\n                (ALLOWED_ATTR[lcName] && !FORBID_ATTR[lcName] && (\n                  /* Check no script, data or unknown possibly unsafe URI\n                     unless we know URI values are safe for that attribute */\n                  URI_SAFE_ATTRIBUTES[lcName] ||\n                  IS_ALLOWED_URI.test(value.replace(ATTR_WHITESPACE,'')) ||\n                  /* Keep image data URIs alive if src is allowed */\n                  (lcName === 'src' && value.indexOf('data:') === 0 &&\n                   DATA_URI_TAGS[currentNode.nodeName.toLowerCase()])\n                )) ||\n                /* Allow potentially valid data-* attributes:\n                 * At least one character after \"-\" (https://html.spec.whatwg.org/multipage/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes)\n                 * XML-compatible (https://html.spec.whatwg.org/multipage/infrastructure.html#xml-compatible and http://www.w3.org/TR/xml/#d0e804)\n                 * We don't need to check the value; it's always URI safe.\n                 */\n                 (ALLOW_DATA_ATTR && DATA_ATTR.test(lcName)) ||\n                 /* Allow unknown protocols:\n                  * This provides support for links that are handled by protocol handlers which may be unknown\n                  * ahead of time, e.g. fb:, spotify:\n                  */\n                 (ALLOW_UNKNOWN_PROTOCOLS && !IS_SCRIPT_OR_DATA.test(value.replace(ATTR_WHITESPACE,'')))\n            ) {\n                /* Handle invalid data-* attribute set by try-catching it */\n                try {\n                    currentNode.setAttribute(name, value);\n                } catch (e) {}\n            }\n        }\n\n        /* Execute a hook if present */\n        _executeHook('afterSanitizeAttributes', currentNode, null);\n    };\n\n    /**\n     * _sanitizeShadowDOM\n     *\n     * @param  fragment to iterate over recursively\n     * @return void\n     */\n    var _sanitizeShadowDOM = function(fragment) {\n        var shadowNode;\n        var shadowIterator = _createIterator(fragment);\n\n        /* Execute a hook if present */\n        _executeHook('beforeSanitizeShadowDOM', fragment, null);\n\n        while ( (shadowNode = shadowIterator.nextNode()) ) {\n            /* Execute a hook if present */\n            _executeHook('uponSanitizeShadowNode', shadowNode, null);\n\n            /* Sanitize tags and elements */\n            if (_sanitizeElements(shadowNode)) {\n                continue;\n            }\n\n            /* Deep shadow DOM detected */\n            if (shadowNode.content instanceof DocumentFragment) {\n                _sanitizeShadowDOM(shadowNode.content);\n            }\n\n            /* Check attributes, sanitize if necessary */\n            _sanitizeAttributes(shadowNode);\n        }\n\n        /* Execute a hook if present */\n        _executeHook('afterSanitizeShadowDOM', fragment, null);\n    };\n\n    /**\n     * _executeHook\n     * Execute user configurable hooks\n     *\n     * @param  {String} entryPoint  Name of the hook's entry point\n     * @param  {Node} currentNode\n     */\n    var _executeHook = function(entryPoint, currentNode, data) {\n        if (!hooks[entryPoint]) { return; }\n\n        hooks[entryPoint].forEach(function(hook) {\n            hook.call(DOMPurify, currentNode, data, CONFIG);\n        });\n    };\n\n    /**\n     * sanitize\n     * Public method providing core sanitation functionality\n     *\n     * @param {String} dirty string\n     * @param {Object} configuration object\n     */\n    DOMPurify.sanitize = function(dirty, cfg) {\n        var body, currentNode, oldNode, nodeIterator, returnNode;\n        /* Make sure we have a string to sanitize.\n           DO NOT return early, as this will return the wrong type if\n           the user has requested a DOM object rather than a string */\n        if (!dirty) {\n            dirty = '';\n        }\n\n        /* Stringify, in case dirty is an object */\n        if (typeof dirty !== 'string') {\n            if (typeof dirty.toString !== 'function') {\n                throw new TypeError('toString is not a function');\n            } else {\n                dirty = dirty.toString();\n            }\n        }\n\n        /* Check we can run. Otherwise fall back or ignore */\n        if (!DOMPurify.isSupported) {\n            if (typeof window.toStaticHTML === 'object'\n                || typeof window.toStaticHTML === 'function') {\n                return window.toStaticHTML(dirty);\n            }\n            return dirty;\n        }\n\n        /* Assign config vars */\n        _parseConfig(cfg);\n\n        /* Exit directly if we have nothing to do */\n        if (!RETURN_DOM && !WHOLE_DOCUMENT && dirty.indexOf('<') === -1) {\n            return dirty;\n        }\n\n        /* Initialize the document to work on */\n        body = _initDocument(dirty);\n\n        /* Check we have a DOM node from the data */\n        if (!body) {\n            return RETURN_DOM ? null : '';\n        }\n\n        /* Get node iterator */\n        nodeIterator = _createIterator(body);\n\n        /* Now start iterating over the created document */\n        while ( (currentNode = nodeIterator.nextNode()) ) {\n\n            /* Fix IE's strange behavior with manipulated textNodes #89 */\n            if (currentNode.nodeType === 3 && currentNode === oldNode) {\n                continue;\n            }\n\n            /* Sanitize tags and elements */\n            if (_sanitizeElements(currentNode)) {\n                continue;\n            }\n\n            /* Shadow DOM detected, sanitize it */\n            if (currentNode.content instanceof DocumentFragment) {\n                _sanitizeShadowDOM(currentNode.content);\n            }\n\n            /* Check attributes, sanitize if necessary */\n            _sanitizeAttributes(currentNode);\n\n            oldNode = currentNode;\n        }\n\n        /* Return sanitized string or DOM */\n        if (RETURN_DOM) {\n\n            if (RETURN_DOM_FRAGMENT) {\n                returnNode = createDocumentFragment.call(body.ownerDocument);\n\n                while (body.firstChild) {\n                    returnNode.appendChild(body.firstChild);\n                }\n            } else {\n                returnNode = body;\n            }\n\n            if (RETURN_DOM_IMPORT) {\n                /* adoptNode() is not used because internal state is not reset\n                   (e.g. the past names map of a HTMLFormElement), this is safe\n                   in theory but we would rather not risk another attack vector.\n                   The state that is cloned by importNode() is explicitly defined\n                   by the specs. */\n                returnNode = importNode.call(originalDocument, returnNode, true);\n            }\n\n            return returnNode;\n        }\n\n        return WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;\n    };\n\n    /**\n     * addHook\n     * Public method to add DOMPurify hooks\n     *\n     * @param {String} entryPoint\n     * @param {Function} hookFunction\n     */\n    DOMPurify.addHook = function(entryPoint, hookFunction) {\n        if (typeof hookFunction !== 'function') { return; }\n        hooks[entryPoint] = hooks[entryPoint] || [];\n        hooks[entryPoint].push(hookFunction);\n    };\n\n    /**\n     * removeHook\n     * Public method to remove a DOMPurify hook at a given entryPoint\n     * (pops it from the stack of hooks if more are present)\n     *\n     * @param {String} entryPoint\n     * @return void\n     */\n    DOMPurify.removeHook = function(entryPoint) {\n        if (hooks[entryPoint]) {\n            hooks[entryPoint].pop();\n        }\n    };\n\n    /**\n     * removeHooks\n     * Public method to remove all DOMPurify hooks at a given entryPoint\n     *\n     * @param  {String} entryPoint\n     * @return void\n     */\n    DOMPurify.removeHooks = function(entryPoint) {\n        if (hooks[entryPoint]) {\n            hooks[entryPoint] = [];\n        }\n    };\n\n    /**\n     * removeAllHooks\n     * Public method to remove all DOMPurify hooks\n     *\n     * @return void\n     */\n    DOMPurify.removeAllHooks = function() {\n        hooks = [];\n    };\n\n    return DOMPurify;\n}));\n","/*!\n * bootstrap-fileinput v4.3.4\n * http://plugins.krajee.com/file-input\n *\n * Author: Kartik Visweswaran\n * Copyright: 2014 - 2016, Kartik Visweswaran, Krajee.com\n *\n * Licensed under the BSD 3-Clause\n * https://github.com/kartik-v/bootstrap-fileinput/blob/master/LICENSE.md\n */\n(function (factory) {\n    \"use strict\";\n    //noinspection JSUnresolvedVariable\n    if (typeof define === 'function' && define.amd) { // jshint ignore:line\n        // AMD. Register as an anonymous module.\n        define(['jquery'], factory); // jshint ignore:line\n    } else { // noinspection JSUnresolvedVariable\n        if (typeof module === 'object' && module.exports) { // jshint ignore:line\n            // Node/CommonJS\n            // noinspection JSUnresolvedVariable\n            module.exports = factory(require('jquery')); // jshint ignore:line\n        } else {\n            // Browser globals\n            factory(window.jQuery);\n        }\n    }\n}(function ($) {\n    \"use strict\";\n\n    $.fn.fileinputLocales = {};\n    $.fn.fileinputThemes = {};\n\n    var NAMESPACE, MODAL_ID, STYLE_SETTING, OBJECT_PARAMS, DEFAULT_PREVIEW, objUrl, compare, isIE, handler,\n        previewCache, getNum, hasFileAPISupport, hasDragDropSupport, hasFileUploadSupport, addCss, tMain1, tMain2,\n        tPreview, tFileIcon, tClose, tCaption, tBtnDefault, tBtnLink, tBtnBrowse, tModalMain, tModal, tProgress, tSize,\n        tFooter, tActions, tActionDelete, tActionUpload, tActionZoom, tActionDrag, tTagBef, tTagBef1, tTagBef2, tTagAft,\n        tGeneric, tHtml, tImage, tText, tVideo, tAudio, tFlash, tObject, tPdf, tOther, defaultFileActionSettings,\n        defaultLayoutTemplates, defaultPreviewTemplates, defaultPreviewZoomSettings, defaultPreviewTypes, getElement,\n        defaultPreviewSettings, defaultFileTypeSettings, isEmpty, isArray, ifSet, uniqId, htmlEncode, replaceTags,\n        cleanMemory, findFileName, checkFullScreen, toggleFullScreen, moveArray, FileInput;\n\n    NAMESPACE = '.fileinput';\n    MODAL_ID = 'kvFileinputModal';\n    STYLE_SETTING = 'style=\"width:{width};height:{height};\"';\n    OBJECT_PARAMS = '<param name=\"controller\" value=\"true\" />\\n' +\n        '<param name=\"allowFullScreen\" value=\"true\" />\\n' +\n        '<param name=\"allowScriptAccess\" value=\"always\" />\\n' +\n        '<param name=\"autoPlay\" value=\"false\" />\\n' +\n        '<param name=\"autoStart\" value=\"false\" />\\n' +\n        '<param name=\"quality\" value=\"high\" />\\n';\n    DEFAULT_PREVIEW = '<div class=\"file-preview-other\">\\n' +\n        '<span class=\"{previewFileIconClass}\">{previewFileIcon}</span>\\n' +\n        '</div>';\n    //noinspection JSUnresolvedVariable\n    objUrl = window.URL || window.webkitURL;\n    compare = function (input, str, exact) {\n        return input !== undefined && (exact ? input === str : input.match(str));\n    };\n    isIE = function (ver) {\n        // check for IE versions < 11\n        if (navigator.appName !== 'Microsoft Internet Explorer') {\n            return false;\n        }\n        if (ver === 10) {\n            return new RegExp('msie\\\\s' + ver, 'i').test(navigator.userAgent);\n        }\n        var div = document.createElement(\"div\"), status;\n        div.innerHTML = \"<!--[if IE \" + ver + \"]> <i></i> <![endif]-->\";\n        status = div.getElementsByTagName(\"i\").length;\n        document.body.appendChild(div);\n        div.parentNode.removeChild(div);\n        return status;\n    };\n    handler = function ($el, event, callback, skipNS) {\n        var ev = skipNS ? event : event.split(' ').join(NAMESPACE + ' ') + NAMESPACE;\n        $el.off(ev).on(ev, callback);\n    };\n    previewCache = {\n        data: {},\n        init: function (obj) {\n            var content = obj.initialPreview, id = obj.id;\n            if (content.length > 0 && !isArray(content)) {\n                content = content.split(obj.initialPreviewDelimiter);\n            }\n            previewCache.data[id] = {\n                content: content,\n                config: obj.initialPreviewConfig,\n                tags: obj.initialPreviewThumbTags,\n                delimiter: obj.initialPreviewDelimiter,\n                previewFileType: obj.initialPreviewFileType,\n                previewAsData: obj.initialPreviewAsData,\n                template: obj.previewGenericTemplate,\n                showZoom: obj.fileActionSettings.showZoom,\n                showDrag: obj.fileActionSettings.showDrag,\n                getSize: function (size) {\n                    return obj._getSize(size);\n                },\n                parseTemplate: function (cat, data, fname, ftype, pId, ftr, ind) {\n                    var fc = ' file-preview-initial';\n                    return obj._generatePreviewTemplate(cat, data, fname, ftype, pId, false, null, fc, ftr, ind);\n                },\n                msg: function (n) {\n                    return obj._getMsgSelected(n);\n                },\n                initId: obj.previewInitId,\n                footer: obj._getLayoutTemplate('footer').replace(/\\{progress}/g, obj._renderThumbProgress()),\n                isDelete: obj.initialPreviewShowDelete,\n                caption: obj.initialCaption,\n                actions: function (showUpload, showDelete, showZoom, showDrag, disabled, url, key) {\n                    return obj._renderFileActions(showUpload, showDelete, showZoom, showDrag, disabled, url, key, true);\n                }\n            };\n        },\n        fetch: function (id) {\n            return previewCache.data[id].content.filter(function (n) {\n                return n !== null;\n            });\n        },\n        count: function (id, all) {\n            return !!previewCache.data[id] && !!previewCache.data[id].content ?\n                (all ? previewCache.data[id].content.length : previewCache.fetch(id).length) : 0;\n        },\n        get: function (id, i, isDisabled) {\n            var ind = 'init_' + i, data = previewCache.data[id], config = data.config[i], content = data.content[i],\n                previewId = data.initId + '-' + ind, out, $tmp, frameClass = ' file-preview-initial', cat, cap, ftr,\n                ftype, asData = ifSet('previewAsData', config, data.previewAsData);\n            isDisabled = isDisabled === undefined ? true : isDisabled;\n            /** @namespace config.frameAttr */\n            /** @namespace config.frameClass */\n            /** @namespace config.filetype */\n            if (!content) {\n                return '';\n            }\n            if (config && config.frameClass) {\n                frameClass += ' ' + config.frameClass;\n            }\n            if (asData) {\n                cat = data.previewAsData ? ifSet('type', config, data.previewFileType || 'generic') : 'generic';\n                cap = ifSet('caption', config);\n                ftr = previewCache.footer(id, i, isDisabled, (config && config.size || null));\n                ftype = ifSet('filetype', config, cat);\n                out = data.parseTemplate(cat, content, cap, ftype, previewId, ftr, ind, null);\n            } else {\n                out = data.template\n                    .replace(/\\{previewId}/g, previewId).replace(/\\{frameClass}/g, frameClass)\n                    .replace(/\\{fileindex}/g, ind).replace(/\\{content}/g, data.content[i])\n                    .replace(/\\{template}/g, ifSet('type', config, data.previewFileType))\n                    .replace(/\\{footer}/g, previewCache.footer(id, i, isDisabled, (config && config.size || null)));\n            }\n            if (data.tags.length && data.tags[i]) {\n                out = replaceTags(out, data.tags[i]);\n            }\n            if (!isEmpty(config) && !isEmpty(config.frameAttr)) {\n                $tmp = $(document.createElement('div')).html(out);\n                $tmp.find('.file-preview-initial').attr(config.frameAttr);\n                out = $tmp.html();\n                $tmp.remove();\n            }\n            return out;\n        },\n        add: function (id, content, config, tags, append) {\n            var data = $.extend(true, {}, previewCache.data[id]), index;\n            if (!isArray(content)) {\n                content = content.split(data.delimiter);\n            }\n            if (append) {\n                index = data.content.push(content) - 1;\n                data.config[index] = config;\n                data.tags[index] = tags;\n            } else {\n                index = content.length - 1;\n                data.content = content;\n                data.config = config;\n                data.tags = tags;\n            }\n            previewCache.data[id] = data;\n            return index;\n        },\n        set: function (id, content, config, tags, append) {\n            var data = $.extend(true, {}, previewCache.data[id]), i, chk;\n            if (!content || !content.length) {\n                return;\n            }\n            if (!isArray(content)) {\n                content = content.split(data.delimiter);\n            }\n            chk = content.filter(function (n) {\n                return n !== null;\n            });\n            if (!chk.length) {\n                return;\n            }\n            if (data.content === undefined) {\n                data.content = [];\n            }\n            if (data.config === undefined) {\n                data.config = [];\n            }\n            if (data.tags === undefined) {\n                data.tags = [];\n            }\n            if (append) {\n                for (i = 0; i < content.length; i++) {\n                    if (content[i]) {\n                        data.content.push(content[i]);\n                    }\n                }\n                for (i = 0; i < config.length; i++) {\n                    if (config[i]) {\n                        data.config.push(config[i]);\n                    }\n                }\n                for (i = 0; i < tags.length; i++) {\n                    if (tags[i]) {\n                        data.tags.push(tags[i]);\n                    }\n                }\n            } else {\n                data.content = content;\n                data.config = config;\n                data.tags = tags;\n            }\n            previewCache.data[id] = data;\n        },\n        unset: function (id, index) {\n            var chk = previewCache.count(id);\n            if (!chk) {\n                return;\n            }\n            if (chk === 1) {\n                previewCache.data[id].content = [];\n                previewCache.data[id].config = [];\n                previewCache.data[id].tags = [];\n                return;\n            }\n            previewCache.data[id].content[index] = null;\n            previewCache.data[id].config[index] = null;\n            previewCache.data[id].tags[index] = null;\n        },\n        out: function (id) {\n            var html = '', data = previewCache.data[id], caption, len = previewCache.count(id, true);\n            if (len === 0) {\n                return {content: '', caption: ''};\n            }\n            for (var i = 0; i < len; i++) {\n                html += previewCache.get(id, i);\n            }\n            caption = data.msg(previewCache.count(id));\n            return {content: '<div class=\"file-initial-thumbs\">' + html + '</div>', caption: caption};\n        },\n        footer: function (id, i, isDisabled, size) {\n            var data = previewCache.data[id];\n            isDisabled = isDisabled === undefined ? true : isDisabled;\n            if (data.config.length === 0 || isEmpty(data.config[i])) {\n                return '';\n            }\n            var config = data.config[i], caption = ifSet('caption', config), width = ifSet('width', config, 'auto'),\n                url = ifSet('url', config, false), key = ifSet('key', config, null),\n                showDel = ifSet('showDelete', config, true), showZoom = ifSet('showZoom', config, data.showZoom),\n                showDrag = ifSet('showDrag', config, data.showDrag), disabled = (url === false) && isDisabled,\n                actions = data.isDelete ? data.actions(false, showDel, showZoom, showDrag, disabled, url, key) : '',\n                footer = data.footer.replace(/\\{actions}/g, actions);\n            return footer.replace(/\\{caption}/g, caption).replace(/\\{size}/g, data.getSize(size))\n                .replace(/\\{width}/g, width).replace(/\\{indicator}/g, '').replace(/\\{indicatorTitle}/g, '');\n        }\n    };\n    getNum = function (num, def) {\n        def = def || 0;\n        if (typeof num === \"number\") {\n            return num;\n        }\n        if (typeof num === \"string\") {\n            num = parseFloat(num);\n        }\n        return isNaN(num) ? def : num;\n    };\n    hasFileAPISupport = function () {\n        return !!(window.File && window.FileReader);\n    };\n    hasDragDropSupport = function () {\n        var div = document.createElement('div');\n        /** @namespace div.draggable */\n        /** @namespace div.ondragstart */\n        /** @namespace div.ondrop */\n        return !isIE(9) && (div.draggable !== undefined || (div.ondragstart !== undefined && div.ondrop !== undefined));\n    };\n    hasFileUploadSupport = function () {\n        return hasFileAPISupport() && window.FormData;\n    };\n    addCss = function ($el, css) {\n        $el.removeClass(css).addClass(css);\n    };\n    defaultFileActionSettings = {\n        showRemove: true,\n        showUpload: true,\n        showZoom: true,\n        showDrag: true,\n        removeIcon: '<i class=\"glyphicon glyphicon-trash text-danger\"></i>',\n        removeClass: 'btn btn-xs btn-default',\n        removeTitle: 'Remove file',\n        uploadIcon: '<i class=\"glyphicon glyphicon-upload text-info\"></i>',\n        uploadClass: 'btn btn-xs btn-default',\n        uploadTitle: 'Upload file',\n        zoomIcon: '<i class=\"glyphicon glyphicon-zoom-in\"></i>',\n        zoomClass: 'btn btn-xs btn-default',\n        zoomTitle: 'View Details',\n        dragIcon: '<i class=\"glyphicon glyphicon-menu-hamburger\"></i>',\n        dragClass: 'text-info',\n        dragTitle: 'Move / Rearrange',\n        dragSettings: {},\n        indicatorNew: '<i class=\"glyphicon glyphicon-hand-down text-warning\"></i>',\n        indicatorSuccess: '<i class=\"glyphicon glyphicon-ok-sign text-success\"></i>',\n        indicatorError: '<i class=\"glyphicon glyphicon-exclamation-sign text-danger\"></i>',\n        indicatorLoading: '<i class=\"glyphicon glyphicon-hand-up text-muted\"></i>',\n        indicatorNewTitle: 'Not uploaded yet',\n        indicatorSuccessTitle: 'Uploaded',\n        indicatorErrorTitle: 'Upload Error',\n        indicatorLoadingTitle: 'Uploading ...'\n    };\n    tMain1 = '{preview}\\n' +\n        '<div class=\"kv-upload-progress hide\"></div>\\n' +\n        '<div class=\"input-group {class}\">\\n' +\n        '   {caption}\\n' +\n        '   <div class=\"input-group-btn\">\\n' +\n        '       {remove}\\n' +\n        '       {cancel}\\n' +\n        '       {upload}\\n' +\n        '       {browse}\\n' +\n        '   </div>\\n' +\n        '</div>';\n    tMain2 = '{preview}\\n<div class=\"kv-upload-progress hide\"></div>\\n{remove}\\n{cancel}\\n{upload}\\n{browse}\\n';\n    tPreview = '<div class=\"file-preview {class}\">\\n' +\n        '    {close}' +\n        '    <div class=\"{dropClass}\">\\n' +\n        '    <div class=\"file-preview-thumbnails\">\\n' +\n        '    </div>\\n' +\n        '    <div class=\"clearfix\"></div>' +\n        '    <div class=\"file-preview-status text-center text-success\"></div>\\n' +\n        '    <div class=\"kv-fileinput-error\"></div>\\n' +\n        '    </div>\\n' +\n        '</div>';\n    tClose = '<div class=\"close fileinput-remove\">&times;</div>\\n';\n    tFileIcon = '<i class=\"glyphicon glyphicon-file kv-caption-icon\"></i>';\n    tCaption = '<div tabindex=\"500\" class=\"form-control file-caption {class}\">\\n' +\n        '   <div class=\"file-caption-name\"></div>\\n' +\n        '</div>\\n';\n    //noinspection HtmlUnknownAttribute\n    tBtnDefault = '<button type=\"{type}\" tabindex=\"500\" title=\"{title}\" class=\"{css}\" {status}>{icon} {label}</button>';\n    //noinspection HtmlUnknownAttribute\n    tBtnLink = '<a href=\"{href}\" tabindex=\"500\" title=\"{title}\" class=\"{css}\" {status}>{icon} {label}</a>';\n    //noinspection HtmlUnknownAttribute\n    tBtnBrowse = '<div tabindex=\"500\" class=\"{css}\" {status}>{icon} {label}</div>';\n    tModalMain = '<div id=\"' + MODAL_ID + '\" class=\"file-zoom-dialog modal fade\" tabindex=\"-1\" aria-labelledby=\"' +\n        MODAL_ID + 'Label\"></div>';\n    tModal = '<div class=\"modal-dialog modal-lg\" role=\"document\">\\n' +\n        '  <div class=\"modal-content\">\\n' +\n        '    <div class=\"modal-header\">\\n' +\n        '      <div class=\"kv-zoom-actions pull-right\">{toggleheader}{fullscreen}{borderless}{close}</div>\\n' +\n        '      <h3 class=\"modal-title\">{heading} <small><span class=\"kv-zoom-title\"></span></small></h3>\\n' +\n        '    </div>\\n' +\n        '    <div class=\"modal-body\">\\n' +\n        '      <div class=\"floating-buttons\"></div>\\n' +\n        '      <div class=\"kv-zoom-body file-zoom-content\"></div>\\n' + '{prev} {next}\\n' +\n        '    </div>\\n' +\n        '  </div>\\n' +\n        '</div>\\n';\n    tProgress = '<div class=\"progress\">\\n' +\n        '    <div class=\"{class}\" role=\"progressbar\"' +\n        ' aria-valuenow=\"{percent}\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width:{percent}%;\">\\n' +\n        '        {percent}%\\n' +\n        '     </div>\\n' +\n        '</div>';\n    tSize = ' <br><samp>({sizeText})</samp>';\n    tFooter = '<div class=\"file-thumbnail-footer\">\\n' +\n        '    <div class=\"file-footer-caption\" title=\"{caption}\">{caption}{size}</div>\\n' +\n        '    {progress} {actions}\\n' +\n        '</div>';\n    tActions = '<div class=\"file-actions\">\\n' +\n        '    <div class=\"file-footer-buttons\">\\n' +\n        '        {upload} {delete} {zoom} {other}' +\n        '    </div>\\n' +\n        '    {drag}\\n' +\n        '    <div class=\"file-upload-indicator\" title=\"{indicatorTitle}\">{indicator}</div>\\n' +\n        '    <div class=\"clearfix\"></div>\\n' +\n        '</div>';\n    //noinspection HtmlUnknownAttribute\n    tActionDelete = '<button type=\"button\" class=\"kv-file-remove {removeClass}\" ' + 'title=\"{removeTitle}\" {dataUrl}{dataKey}>{removeIcon}</button>\\n';\n    tActionUpload = '<button type=\"button\" class=\"kv-file-upload {uploadClass}\" title=\"{uploadTitle}\">' +\n        '{uploadIcon}</button>';\n    tActionZoom = '<button type=\"button\" class=\"kv-file-zoom {zoomClass}\" title=\"{zoomTitle}\">{zoomIcon}</button>';\n    tActionDrag = '<span class=\"file-drag-handle {dragClass}\" title=\"{dragTitle}\">{dragIcon}</span>';\n    tTagBef = '<div class=\"file-preview-frame{frameClass}\" id=\"{previewId}\" data-fileindex=\"{fileindex}\"' +\n        ' data-template=\"{template}\"';\n    tTagBef1 = tTagBef + '><div class=\"kv-file-content\">\\n';\n    tTagBef2 = tTagBef + ' title=\"{caption}\" ' + STYLE_SETTING + '><div class=\"kv-file-content\">\\n';\n    tTagAft = '</div>{footer}\\n</div>\\n';\n    tGeneric = '{content}\\n';\n    tHtml = '<div class=\"kv-preview-data file-preview-html\" title=\"{caption}\" ' + STYLE_SETTING + '>{data}</div>\\n';\n    tImage = '<img src=\"{data}\" class=\"kv-preview-data file-preview-image\" title=\"{caption}\" alt=\"{caption}\" ' +\n        STYLE_SETTING + '>\\n';\n    tText = '<textarea class=\"kv-preview-data file-preview-text\" title=\"{caption}\" readonly ' + STYLE_SETTING +\n        '>{data}</textarea>\\n';\n    tVideo = '<video class=\"kv-preview-data\" width=\"{width}\" height=\"{height}\" controls>\\n' +\n        '<source src=\"{data}\" type=\"{type}\">\\n' + DEFAULT_PREVIEW + '\\n</video>\\n';\n    tAudio = '<audio class=\"kv-preview-data\" controls>\\n<source src=\"' + '{data}' + '\" type=\"{type}\">\\n' +\n        DEFAULT_PREVIEW + '\\n</audio>\\n';\n    tFlash = '<object class=\"kv-preview-data file-object\" type=\"application/x-shockwave-flash\" ' +\n        'width=\"{width}\" height=\"{height}\" data=\"{data}\">\\n' + OBJECT_PARAMS + ' ' + DEFAULT_PREVIEW + '\\n</object>\\n';\n    tObject = '<object class=\"kv-preview-data file-object\" data=\"{data}\" type=\"{type}\" width=\"{width}\" height=\"{height}\">\\n' +\n        '<param name=\"movie\" value=\"{caption}\" />\\n' + OBJECT_PARAMS + ' ' + DEFAULT_PREVIEW + '\\n</object>\\n';\n    tPdf = '<embed class=\"kv-preview-data\" src=\"{data}\" width=\"{width}\" height=\"{height}\" type=\"application/pdf\">\\n';\n    tOther = '<div class=\"kv-preview-data file-preview-other-frame\">\\n' + DEFAULT_PREVIEW + '\\n</div>\\n';\n    defaultLayoutTemplates = {\n        main1: tMain1,\n        main2: tMain2,\n        preview: tPreview,\n        close: tClose,\n        fileIcon: tFileIcon,\n        caption: tCaption,\n        modalMain: tModalMain,\n        modal: tModal,\n        progress: tProgress,\n        size: tSize,\n        footer: tFooter,\n        actions: tActions,\n        actionDelete: tActionDelete,\n        actionUpload: tActionUpload,\n        actionZoom: tActionZoom,\n        actionDrag: tActionDrag,\n        btnDefault: tBtnDefault,\n        btnLink: tBtnLink,\n        btnBrowse: tBtnBrowse\n    };\n    defaultPreviewTemplates = {\n        generic: tTagBef1 + tGeneric + tTagAft,\n        html: tTagBef1 + tHtml + tTagAft,\n        image: tTagBef1 + tImage + tTagAft,\n        text: tTagBef1 + tText + tTagAft,\n        video: tTagBef2 + tVideo + tTagAft,\n        audio: tTagBef2 + tAudio + tTagAft,\n        flash: tTagBef2 + tFlash + tTagAft,\n        object: tTagBef2 + tObject + tTagAft,\n        pdf: tTagBef2 + tPdf + tTagAft,\n        other: tTagBef2 + tOther + tTagAft\n    };\n    defaultPreviewTypes = ['image', 'html', 'text', 'video', 'audio', 'flash', 'pdf', 'object'];\n    defaultPreviewSettings = {\n        image: {width: \"auto\", height: \"160px\"},\n        html: {width: \"213px\", height: \"160px\"},\n        text: {width: \"213px\", height: \"160px\"},\n        video: {width: \"213px\", height: \"160px\"},\n        audio: {width: \"213px\", height: \"80px\"},\n        flash: {width: \"213px\", height: \"160px\"},\n        object: {width: \"160px\", height: \"160px\"},\n        pdf: {width: \"160px\", height: \"160px\"},\n        other: {width: \"160px\", height: \"160px\"}\n    };\n    defaultPreviewZoomSettings = {\n        image: {width: \"100%\", height: \"100%\"},\n        html: {width: \"100%\", height: \"100%\", 'min-height': \"480px\"},\n        text: {width: \"100%\", height: \"100%\", 'min-height': \"480px\"},\n        video: {width: \"auto\", height: \"100%\", 'max-width': \"100%\"},\n        audio: {width: \"100%\", height: \"30px\"},\n        flash: {width: \"auto\", height: \"480px\"},\n        object: {width: \"auto\", height: \"100%\", 'min-height': \"480px\"},\n        pdf: {width: \"100%\", height: \"100%\", 'min-height': \"480px\"},\n        other: {width: \"auto\", height: \"100%\", 'min-height': \"480px\"}\n    };\n    defaultFileTypeSettings = {\n        image: function (vType, vName) {\n            return compare(vType, 'image.*') || compare(vName, /\\.(gif|png|jpe?g)$/i);\n        },\n        html: function (vType, vName) {\n            return compare(vType, 'text/html') || compare(vName, /\\.(htm|html)$/i);\n        },\n        text: function (vType, vName) {\n            return compare(vType, 'text.*') || compare(vName, /\\.(xml|javascript)$/i) ||\n                compare(vName, /\\.(txt|md|csv|nfo|ini|json|php|js|css)$/i);\n        },\n        video: function (vType, vName) {\n            return compare(vType, 'video.*') && (compare(vType, /(ogg|mp4|mp?g|webm|3gp)$/i) ||\n                compare(vName, /\\.(og?|mp4|webm|mp?g|3gp)$/i));\n        },\n        audio: function (vType, vName) {\n            return compare(vType, 'audio.*') && (compare(vName, /(ogg|mp3|mp?g|wav)$/i) ||\n                compare(vName, /\\.(og?|mp3|mp?g|wav)$/i));\n        },\n        flash: function (vType, vName) {\n            return compare(vType, 'application/x-shockwave-flash', true) || compare(vName, /\\.(swf)$/i);\n        },\n        pdf: function (vType, vName) {\n            return compare(vType, 'application/pdf', true) || compare(vName, /\\.(pdf)$/i);\n        },\n        object: function () {\n            return true;\n        },\n        other: function () {\n            return true;\n        }\n    };\n    isEmpty = function (value, trim) {\n        return value === undefined || value === null || value.length === 0 || (trim && $.trim(value) === '');\n    };\n    isArray = function (a) {\n        return Array.isArray(a) || Object.prototype.toString.call(a) === '[object Array]';\n    };\n    ifSet = function (needle, haystack, def) {\n        def = def || '';\n        return (haystack && typeof haystack === 'object' && needle in haystack) ? haystack[needle] : def;\n    };\n    getElement = function (options, param, value) {\n        return (isEmpty(options) || isEmpty(options[param])) ? value : $(options[param]);\n    };\n    uniqId = function () {\n        return Math.round(new Date().getTime() + (Math.random() * 100));\n    };\n    htmlEncode = function (str) {\n        return str.replace(/&/g, '&amp;')\n            .replace(/</g, '&lt;')\n            .replace(/>/g, '&gt;')\n            .replace(/\"/g, '&quot;')\n            .replace(/'/g, '&apos;');\n    };\n    replaceTags = function (str, tags) {\n        var out = str;\n        if (!tags) {\n            return out;\n        }\n        $.each(tags, function (key, value) {\n            if (typeof value === \"function\") {\n                value = value();\n            }\n            out = out.split(key).join(value);\n        });\n        return out;\n    };\n    cleanMemory = function ($thumb) {\n        var data = $thumb.is('img') ? $thumb.attr('src') : $thumb.find('source').attr('src');\n        /** @namespace objUrl.revokeObjectURL */\n        objUrl.revokeObjectURL(data);\n    };\n    findFileName = function (filePath) {\n        var sepIndex = filePath.lastIndexOf('/');\n        if (sepIndex === -1) {\n            sepIndex = filePath.lastIndexOf('\\\\');\n        }\n        return filePath.split(filePath.substring(sepIndex, sepIndex + 1)).pop();\n    };\n    checkFullScreen = function () {\n        //noinspection JSUnresolvedVariable\n        return document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement ||\n            document.msFullscreenElement;\n    };\n    toggleFullScreen = function (maximize) {\n        if (maximize && !checkFullScreen()) {\n            /** @namespace document.documentElement.requestFullscreen */\n            /** @namespace document.documentElement.msRequestFullscreen */\n            /** @namespace document.documentElement.mozRequestFullScreen */\n            /** @namespace document.documentElement.webkitRequestFullscreen */\n            /** @namespace Element.ALLOW_KEYBOARD_INPUT */\n            if (document.documentElement.requestFullscreen) {\n                document.documentElement.requestFullscreen();\n            } else if (document.documentElement.msRequestFullscreen) {\n                document.documentElement.msRequestFullscreen();\n            } else if (document.documentElement.mozRequestFullScreen) {\n                document.documentElement.mozRequestFullScreen();\n            } else if (document.documentElement.webkitRequestFullscreen) {\n                document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n            }\n        } else {\n            /** @namespace document.exitFullscreen */\n            /** @namespace document.msExitFullscreen */\n            /** @namespace document.mozCancelFullScreen */\n            /** @namespace document.webkitExitFullscreen */\n            if (document.exitFullscreen) {\n                document.exitFullscreen();\n            } else if (document.msExitFullscreen) {\n                document.msExitFullscreen();\n            } else if (document.mozCancelFullScreen) {\n                document.mozCancelFullScreen();\n            } else if (document.webkitExitFullscreen) {\n                document.webkitExitFullscreen();\n            }\n        }\n    };\n    moveArray = function (arr, oldIndex, newIndex) {\n        if (newIndex >= arr.length) {\n            var k = newIndex - arr.length;\n            while ((k--) + 1) {\n                arr.push(undefined);\n            }\n        }\n        arr.splice(newIndex, 0, arr.splice(oldIndex, 1)[0]);\n        return arr;\n    };\n    FileInput = function (element, options) {\n        var self = this;\n        self.$element = $(element);\n        if (!self._validate()) {\n            return;\n        }\n        self.isPreviewable = hasFileAPISupport();\n        self.isIE9 = isIE(9);\n        self.isIE10 = isIE(10);\n        if (self.isPreviewable || self.isIE9) {\n            self._init(options);\n            self._listen();\n        } else {\n            self.$element.removeClass('file-loading');\n        }\n    };\n    FileInput.prototype = {\n        constructor: FileInput,\n        _init: function (options) {\n            var self = this, $el = self.$element, t;\n            $.each(options, function (key, value) {\n                switch (key) {\n                    case 'minFileCount':\n                    case 'maxFileCount':\n                    case 'maxFileSize':\n                        self[key] = getNum(value);\n                        break;\n                    default:\n                        self[key] = value;\n                        break;\n                }\n            });\n            self.fileInputCleared = false;\n            self.fileBatchCompleted = true;\n            if (!self.isPreviewable) {\n                self.showPreview = false;\n            }\n            self.uploadFileAttr = !isEmpty($el.attr('name')) ? $el.attr('name') : 'file_data';\n            self.reader = null;\n            self.formdata = {};\n            self.clearStack();\n            self.uploadCount = 0;\n            self.uploadStatus = {};\n            self.uploadLog = [];\n            self.uploadAsyncCount = 0;\n            self.loadedImages = [];\n            self.totalImagesCount = 0;\n            self.ajaxRequests = [];\n            self.isError = false;\n            self.ajaxAborted = false;\n            self.cancelling = false;\n            t = self._getLayoutTemplate('progress');\n            self.progressTemplate = t.replace('{class}', self.progressClass);\n            self.progressCompleteTemplate = t.replace('{class}', self.progressCompleteClass);\n            self.progressErrorTemplate = t.replace('{class}', self.progressErrorClass);\n            self.dropZoneEnabled = hasDragDropSupport() && self.dropZoneEnabled;\n            self.isDisabled = self.$element.attr('disabled') || self.$element.attr('readonly');\n            self.isUploadable = hasFileUploadSupport() && !isEmpty(self.uploadUrl);\n            self.isClickable = self.browseOnZoneClick && self.showPreview &&\n                (self.isUploadable && self.dropZoneEnabled || !isEmpty(self.defaultPreviewContent));\n            self.slug = typeof options.slugCallback === \"function\" ? options.slugCallback : self._slugDefault;\n            self.mainTemplate = self.showCaption ? self._getLayoutTemplate('main1') : self._getLayoutTemplate('main2');\n            self.captionTemplate = self._getLayoutTemplate('caption');\n            self.previewGenericTemplate = self._getPreviewTemplate('generic');\n            if (self.resizeImage && (self.maxImageWidth || self.maxImageHeight)) {\n                self.imageCanvas = document.createElement('canvas');\n                self.imageCanvasContext = self.imageCanvas.getContext('2d');\n            }\n            if (isEmpty(self.$element.attr('id'))) {\n                self.$element.attr('id', uniqId());\n            }\n            if (self.$container === undefined) {\n                self.$container = self._createContainer();\n            } else {\n                self._refreshContainer();\n            }\n            self.$dropZone = self.$container.find('.file-drop-zone');\n            self.$progress = self.$container.find('.kv-upload-progress');\n            self.$btnUpload = self.$container.find('.fileinput-upload');\n            self.$captionContainer = getElement(options, 'elCaptionContainer', self.$container.find('.file-caption'));\n            self.$caption = getElement(options, 'elCaptionText', self.$container.find('.file-caption-name'));\n            self.$previewContainer = getElement(options, 'elPreviewContainer', self.$container.find('.file-preview'));\n            self.$preview = getElement(options, 'elPreviewImage', self.$container.find('.file-preview-thumbnails'));\n            self.$previewStatus = getElement(options, 'elPreviewStatus', self.$container.find('.file-preview-status'));\n            self.$errorContainer = getElement(options, 'elErrorContainer',\n                self.$previewContainer.find('.kv-fileinput-error'));\n            if (!isEmpty(self.msgErrorClass)) {\n                addCss(self.$errorContainer, self.msgErrorClass);\n            }\n            self.$errorContainer.hide();\n            self.fileActionSettings = $.extend(true, defaultFileActionSettings, options.fileActionSettings);\n            self.previewInitId = \"preview-\" + uniqId();\n            self.id = self.$element.attr('id');\n            previewCache.init(self);\n            self._initPreview(true);\n            self._initPreviewActions();\n            self.options = options;\n            self._setFileDropZoneTitle();\n            self.$element.removeClass('file-loading');\n            if (self.$element.attr('disabled')) {\n                self.disable();\n            }\n            self._initZoom();\n        },\n        _validate: function () {\n            var self = this, $exception;\n            if (self.$element.attr('type') === 'file') {\n                return true;\n            }\n            $exception = '<div class=\"help-block alert alert-warning\">' +\n                '<h4>Invalid Input Type</h4>' +\n                'You must set an input <code>type = file</code> for <b>bootstrap-fileinput</b> plugin to initialize.' +\n                '</div>';\n            self.$element.after($exception);\n            return false;\n        },\n        _errorsExist: function () {\n            var self = this, $err;\n            if (self.$errorContainer.find('li').length) {\n                return true;\n            }\n            $err = $(document.createElement('div')).html(self.$errorContainer.html());\n            $err.find('span.kv-error-close').remove();\n            $err.find('ul').remove();\n            return $.trim($err.text()).length ? true : false;\n        },\n        _errorHandler: function (evt, caption) {\n            var self = this, err = evt.target.error;\n            /** @namespace err.NOT_FOUND_ERR */\n            /** @namespace err.SECURITY_ERR */\n            /** @namespace err.NOT_READABLE_ERR */\n            if (err.code === err.NOT_FOUND_ERR) {\n                self._showError(self.msgFileNotFound.replace('{name}', caption));\n            } else if (err.code === err.SECURITY_ERR) {\n                self._showError(self.msgFileSecured.replace('{name}', caption));\n            } else if (err.code === err.NOT_READABLE_ERR) {\n                self._showError(self.msgFileNotReadable.replace('{name}', caption));\n            } else if (err.code === err.ABORT_ERR) {\n                self._showError(self.msgFilePreviewAborted.replace('{name}', caption));\n            } else {\n                self._showError(self.msgFilePreviewError.replace('{name}', caption));\n            }\n        },\n        _addError: function (msg) {\n            var self = this, $error = self.$errorContainer;\n            if (msg && $error.length) {\n                $error.html(self.errorCloseButton + msg);\n                handler($error.find('.kv-error-close'), 'click', function () {\n                    $error.fadeOut('slow');\n                });\n            }\n        },\n        _resetErrors: function (fade) {\n            var self = this, $error = self.$errorContainer;\n            self.isError = false;\n            self.$container.removeClass('has-error');\n            $error.html('');\n            if (fade) {\n                $error.fadeOut('slow');\n            } else {\n                $error.hide();\n            }\n        },\n        _showFolderError: function (folders) {\n            var self = this, $error = self.$errorContainer, msg;\n            if (!folders) {\n                return;\n            }\n            msg = self.msgFoldersNotAllowed.replace(/\\{n}/g, folders);\n            self._addError(msg);\n            addCss(self.$container, 'has-error');\n            $error.fadeIn(800);\n            self._raise('filefoldererror', [folders, msg]);\n        },\n        _showUploadError: function (msg, params, event) {\n            var self = this, $error = self.$errorContainer, ev = event || 'fileuploaderror', e = params && params.id ?\n            '<li data-file-id=\"' + params.id + '\">' + msg + '</li>' : '<li>' + msg + '</li>';\n            if ($error.find('ul').length === 0) {\n                self._addError('<ul>' + e + '</ul>');\n            } else {\n                $error.find('ul').append(e);\n            }\n            $error.fadeIn(800);\n            self._raise(ev, [params, msg]);\n            self.$container.removeClass('file-input-new');\n            addCss(self.$container, 'has-error');\n            return true;\n        },\n        _showError: function (msg, params, event) {\n            var self = this, $error = self.$errorContainer, ev = event || 'fileerror';\n            params = params || {};\n            params.reader = self.reader;\n            self._addError(msg);\n            $error.fadeIn(800);\n            self._raise(ev, [params, msg]);\n            if (!self.isUploadable) {\n                self._clearFileInput();\n            }\n            self.$container.removeClass('file-input-new');\n            addCss(self.$container, 'has-error');\n            self.$btnUpload.attr('disabled', true);\n            return true;\n        },\n        _noFilesError: function (params) {\n            var self = this, label = self.minFileCount > 1 ? self.filePlural : self.fileSingle,\n                msg = self.msgFilesTooLess.replace('{n}', self.minFileCount).replace('{files}', label),\n                $error = self.$errorContainer;\n            self._addError(msg);\n            self.isError = true;\n            self._updateFileDetails(0);\n            $error.fadeIn(800);\n            self._raise('fileerror', [params, msg]);\n            self._clearFileInput();\n            addCss(self.$container, 'has-error');\n        },\n        _parseError: function (jqXHR, errorThrown, fileName) {\n            /** @namespace jqXHR.responseJSON */\n            var self = this, errMsg = $.trim(errorThrown + ''),\n                dot = errMsg.slice(-1) === '.' ? '' : '.',\n                text = jqXHR.responseJSON !== undefined && jqXHR.responseJSON.error !== undefined ?\n                    jqXHR.responseJSON.error : jqXHR.responseText;\n            if (self.cancelling && self.msgUploadAborted) {\n                errMsg = self.msgUploadAborted;\n            }\n            if (self.showAjaxErrorDetails && text) {\n                text = $.trim(text.replace(/\\n\\s*\\n/g, '\\n'));\n                text = text.length > 0 ? '<pre>' + text + '</pre>' : '';\n                errMsg += dot + text;\n            } else {\n                errMsg += dot;\n            }\n            self.cancelling = false;\n            return fileName ? '<b>' + fileName + ': </b>' + errMsg : errMsg;\n        },\n        _parseFileType: function (file) {\n            var self = this, isValid, vType, cat, i;\n            for (i = 0; i < defaultPreviewTypes.length; i += 1) {\n                cat = defaultPreviewTypes[i];\n                isValid = ifSet(cat, self.fileTypeSettings, defaultFileTypeSettings[cat]);\n                vType = isValid(file.type, file.name) ? cat : '';\n                if (!isEmpty(vType)) {\n                    return vType;\n                }\n            }\n            return 'other';\n        },\n        _parseFilePreviewIcon: function (content, fname) {\n            var self = this, proceed, ext, icn = self.previewFileIcon;\n            if (fname && fname.indexOf('.') > -1) {\n                ext = fname.split('.').pop();\n                if (self.previewFileIconSettings && self.previewFileIconSettings[ext]) {\n                    icn = self.previewFileIconSettings[ext];\n                }\n                if (self.previewFileExtSettings) {\n                    $.each(self.previewFileExtSettings, function (key, func) {\n                        if (self.previewFileIconSettings[key] && func(ext)) {\n                            icn = self.previewFileIconSettings[key];\n                            return;\n                        }\n                        proceed = true;\n                    });\n                }\n            }\n            if (content.indexOf('{previewFileIcon}') > -1) {\n                return content.replace(/\\{previewFileIconClass}/g, self.previewFileIconClass).replace(\n                    /\\{previewFileIcon}/g, icn);\n            }\n            return content;\n        },\n        _raise: function (event, params) {\n            var self = this, e = $.Event(event);\n            if (params !== undefined) {\n                self.$element.trigger(e, params);\n            } else {\n                self.$element.trigger(e);\n            }\n            if (e.isDefaultPrevented()) {\n                return false;\n            }\n            if (!e.result) {\n                return e.result;\n            }\n            switch (event) {\n                // ignore these events\n                case 'filebatchuploadcomplete':\n                case 'filebatchuploadsuccess':\n                case 'fileuploaded':\n                case 'fileclear':\n                case 'filecleared':\n                case 'filereset':\n                case 'fileerror':\n                case 'filefoldererror':\n                case 'fileuploaderror':\n                case 'filebatchuploaderror':\n                case 'filedeleteerror':\n                case 'filecustomerror':\n                case 'filesuccessremove':\n                    break;\n                // receive data response via `filecustomerror` event`\n                default:\n                    self.ajaxAborted = e.result;\n                    break;\n            }\n            return true;\n        },\n        _listenFullScreen: function (isFullScreen) {\n            var self = this, $modal = self.$modal, $btnFull, $btnBord;\n            if (!$modal || !$modal.length) {\n                return;\n            }\n            $btnFull = $modal && $modal.find('.btn-fullscreen');\n            $btnBord = $modal && $modal.find('.btn-borderless');\n            if (!$btnFull.length || !$btnBord.length) {\n                return;\n            }\n            $btnFull.removeClass('active').attr('aria-pressed', 'false');\n            $btnBord.removeClass('active').attr('aria-pressed', 'false');\n            if (isFullScreen) {\n                $btnFull.addClass('active').attr('aria-pressed', 'true');\n            } else {\n                $btnBord.addClass('active').attr('aria-pressed', 'true');\n            }\n            if ($modal.hasClass('file-zoom-fullscreen')) {\n                self._maximizeZoomDialog();\n            } else {\n                if (isFullScreen) {\n                    self._maximizeZoomDialog();\n                } else {\n                    $btnBord.removeClass('active').attr('aria-pressed', 'false');\n                }\n            }\n        },\n        _listen: function () {\n            var self = this, $el = self.$element, $form = $el.closest('form'), $cont = self.$container;\n            handler($el, 'change', $.proxy(self._change, self));\n            if (self.showBrowse) {\n                handler(self.$btnFile, 'click', $.proxy(self._browse, self));\n            }\n            handler($form, 'reset', $.proxy(self.reset, self));\n            handler($cont.find('.fileinput-remove:not([disabled])'), 'click', $.proxy(self.clear, self));\n            handler($cont.find('.fileinput-cancel'), 'click', $.proxy(self.cancel, self));\n            self._initDragDrop();\n            if (!self.isUploadable) {\n                handler($form, 'submit', $.proxy(self._submitForm, self));\n            }\n            handler(self.$container.find('.fileinput-upload'), 'click', $.proxy(self._uploadClick, self));\n            handler($(window), 'resize', function () {\n                self._listenFullScreen(screen.width === window.innerWidth && screen.height === window.innerHeight);\n            });\n            handler($(document), 'webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange',\n                function () {\n                    self._listenFullScreen(checkFullScreen());\n                });\n            self._initClickable();\n        },\n        _initClickable: function () {\n            var self = this, $zone;\n            if (!self.isClickable) {\n                return;\n            }\n            $zone = self.isUploadable ? self.$dropZone : self.$preview.find('.file-default-preview');\n            addCss($zone, 'clickable');\n            $zone.attr('tabindex', -1);\n            handler($zone, 'click', function (e) {\n                var $target = $(e.target);\n                if (!$target.parents('.file-preview-thumbnails').length || $target.parents(\n                        '.file-default-preview').length) {\n                    self.$element.trigger('click');\n                    $zone.blur();\n                }\n            });\n        },\n        _initDragDrop: function () {\n            var self = this, $zone = self.$dropZone;\n            if (self.isUploadable && self.dropZoneEnabled && self.showPreview) {\n                handler($zone, 'dragenter dragover', $.proxy(self._zoneDragEnter, self));\n                handler($zone, 'dragleave', $.proxy(self._zoneDragLeave, self));\n                handler($zone, 'drop', $.proxy(self._zoneDrop, self));\n                handler($(document), 'dragenter dragover drop', self._zoneDragDropInit);\n            }\n        },\n        _zoneDragDropInit: function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n        },\n        _zoneDragEnter: function (e) {\n            var self = this, hasFiles = $.inArray('Files', e.originalEvent.dataTransfer.types) > -1;\n            self._zoneDragDropInit(e);\n            if (self.isDisabled || !hasFiles) {\n                e.originalEvent.dataTransfer.effectAllowed = 'none';\n                e.originalEvent.dataTransfer.dropEffect = 'none';\n                return;\n            }\n            addCss(self.$dropZone, 'file-highlighted');\n        },\n        _zoneDragLeave: function (e) {\n            var self = this;\n            self._zoneDragDropInit(e);\n            if (self.isDisabled) {\n                return;\n            }\n            self.$dropZone.removeClass('file-highlighted');\n        },\n        _zoneDrop: function (e) {\n            var self = this;\n            e.preventDefault();\n            /** @namespace e.originalEvent.dataTransfer */\n            if (self.isDisabled || isEmpty(e.originalEvent.dataTransfer.files)) {\n                return;\n            }\n            self._change(e, 'dragdrop');\n            self.$dropZone.removeClass('file-highlighted');\n        },\n        _uploadClick: function (e) {\n            var self = this, $btn = self.$container.find('.fileinput-upload'), $form,\n                isEnabled = !$btn.hasClass('disabled') && isEmpty($btn.attr('disabled'));\n            if (e && e.isDefaultPrevented()) {\n                return;\n            }\n            if (!self.isUploadable) {\n                if (isEnabled && $btn.attr('type') !== 'submit') {\n                    $form = $btn.closest('form');\n                    // downgrade to normal form submit if possible\n                    if ($form.length) {\n                        $form.trigger('submit');\n                    }\n                    e.preventDefault();\n                }\n                return;\n            }\n            e.preventDefault();\n            if (isEnabled) {\n                self.upload();\n            }\n        },\n        _submitForm: function () {\n            var self = this, $el = self.$element, files = $el.get(0).files;\n            if (files && self.minFileCount > 0 && self._getFileCount(files.length) < self.minFileCount) {\n                self._noFilesError({});\n                return false;\n            }\n            return !self._abort({});\n        },\n        _clearPreview: function () {\n            var self = this, $thumbs = !self.showUploadedThumbs ? self.$preview.find('.file-preview-frame') :\n                self.$preview.find('.file-preview-frame:not(.file-preview-success)');\n            $thumbs.remove();\n            if (!self.$preview.find('.file-preview-frame').length || !self.showPreview) {\n                self._resetUpload();\n            }\n            self._validateDefaultPreview();\n        },\n        _initSortable: function () {\n            var self = this, $preview = self.$preview, $el, settings;\n            if (!window.KvSortable) {\n                return;\n            }\n            $el = $preview.find('.file-initial-thumbs');\n            //noinspection JSUnusedGlobalSymbols\n            settings = {\n                handle: '.drag-handle-init',\n                dataIdAttr: 'data-preview-id',\n                draggable: '.file-preview-initial',\n                onSort: function (e) {\n                    var oldIndex = e.oldIndex, newIndex = e.newIndex;\n                    self.initialPreview = moveArray(self.initialPreview, oldIndex, newIndex);\n                    self.initialPreviewConfig = moveArray(self.initialPreviewConfig, oldIndex, newIndex);\n                    previewCache.init(self);\n                    self._raise('filesorted', {\n                        previewId: $(e.item).attr('id'),\n                        'oldIndex': oldIndex,\n                        'newIndex': newIndex,\n                        stack: self.initialPreviewConfig\n                    });\n                }\n            };\n            if ($el.data('kvsortable')) {\n                $el.kvsortable('destroy');\n            }\n            $.extend(true, settings, self.fileActionSettings.dragSettings);\n            $el.kvsortable(settings);\n        },\n        _initPreview: function (isInit) {\n            var self = this, cap = self.initialCaption || '', out;\n            if (!previewCache.count(self.id)) {\n                self._clearPreview();\n                if (isInit) {\n                    self._setCaption(cap);\n                } else {\n                    self._initCaption();\n                }\n                return;\n            }\n            out = previewCache.out(self.id);\n            cap = isInit && self.initialCaption ? self.initialCaption : out.caption;\n            self.$preview.html(out.content);\n            self._setCaption(cap);\n            self._initSortable();\n            if (!isEmpty(out.content)) {\n                self.$container.removeClass('file-input-new');\n            }\n        },\n        _getZoomButton: function (type) {\n            var self = this, label = self.previewZoomButtonIcons[type], css = self.previewZoomButtonClasses[type],\n                title = ' title=\"' + (self.previewZoomButtonTitles[type] || '') + '\" ',\n                params = title + (type === 'close' ? ' data-dismiss=\"modal\" aria-hidden=\"true\"' : '');\n            if (type === 'fullscreen' || type === 'borderless' || type === 'toggleheader') {\n                params += ' data-toggle=\"button\" aria-pressed=\"false\" autocomplete=\"off\"';\n            }\n            return '<button type=\"button\" class=\"' + css + ' btn-' + type + '\"' + params + '>' + label + '</button>';\n        },\n        _getModalContent: function () {\n            var self = this;\n            return self._getLayoutTemplate('modal')\n                .replace(/\\{heading}/g, self.msgZoomModalHeading)\n                .replace(/\\{prev}/g, self._getZoomButton('prev'))\n                .replace(/\\{next}/g, self._getZoomButton('next'))\n                .replace(/\\{toggleheader}/g, self._getZoomButton('toggleheader'))\n                .replace(/\\{fullscreen}/g, self._getZoomButton('fullscreen'))\n                .replace(/\\{borderless}/g, self._getZoomButton('borderless'))\n                .replace(/\\{close}/g, self._getZoomButton('close'));\n        },\n        _listenModalEvent: function (event) {\n            var self = this, $modal = self.$modal, getParams = function (e) {\n                return {\n                    sourceEvent: e,\n                    previewId: $modal.data('previewId'),\n                    modal: $modal\n                };\n            };\n            $modal.on(event + '.bs.modal', function (e) {\n                var $btnFull = $modal.find('.btn-fullscreen'), $btnBord = $modal.find('.btn-borderless');\n                self._raise('filezoom' + event, getParams(e));\n                if (event === 'shown') {\n                    $btnBord.removeClass('active').attr('aria-pressed', 'false');\n                    $btnFull.removeClass('active').attr('aria-pressed', 'false');\n                    if ($modal.hasClass('file-zoom-fullscreen')) {\n                        self._maximizeZoomDialog();\n                        if (checkFullScreen()) {\n                            $btnFull.addClass('active').attr('aria-pressed', 'true');\n                        } else {\n                            $btnBord.addClass('active').attr('aria-pressed', 'true');\n                        }\n                    }\n                }\n            });\n        },\n        _initZoom: function () {\n            var self = this, $dialog, modalMain = self._getLayoutTemplate('modalMain'), modalId = '#' + MODAL_ID;\n            self.$modal = $(modalId);\n            if (!self.$modal || !self.$modal.length) {\n                $dialog = $(document.createElement('div')).html(modalMain).insertAfter(self.$container);\n                self.$modal = $('#' + MODAL_ID).insertBefore($dialog);\n                $dialog.remove();\n            }\n            self.$modal.html(self._getModalContent());\n            self._listenModalEvent('show');\n            self._listenModalEvent('shown');\n            self._listenModalEvent('hide');\n            self._listenModalEvent('hidden');\n            self._listenModalEvent('loaded');\n        },\n        _initZoomButtons: function () {\n            var self = this, previewId = self.$modal.data('previewId') || '', $first, $last,\n                frames = self.$preview.find('.file-preview-frame').toArray(), len = frames.length,\n                $prev = self.$modal.find('.btn-prev'), $next = self.$modal.find('.btn-next');\n\n            if (!len) {\n                return;\n            }\n            $first = $(frames[0]);\n            $last = $(frames[len - 1]);\n            $prev.removeAttr('disabled');\n            $next.removeAttr('disabled');\n            if ($first.length && $first.attr('id') === previewId) {\n                $prev.attr('disabled', true);\n            }\n            if ($last.length && $last.attr('id') === previewId) {\n                $next.attr('disabled', true);\n            }\n        },\n        _maximizeZoomDialog: function () {\n            var self = this, $modal = self.$modal, $head = $modal.find('.modal-header:visible'),\n                $foot = $modal.find('.modal-footer:visible'), $body = $modal.find('.modal-body'),\n                h = $(window).height(), diff = 0;\n            $modal.addClass('file-zoom-fullscreen');\n            if ($head && $head.length) {\n                h -= $head.outerHeight(true);\n            }\n            if ($foot && $foot.length) {\n                h -= $foot.outerHeight(true);\n            }\n            if ($body && $body.length) {\n                diff = $body.outerHeight(true) - $body.height();\n                h -= diff;\n            }\n            $modal.find('.kv-zoom-body').height(h);\n        },\n        _resizeZoomDialog: function (fullScreen) {\n            var self = this, $modal = self.$modal, $btnFull = $modal.find('.btn-fullscreen'),\n                $btnBord = $modal.find('.btn-borderless');\n            if ($modal.hasClass('file-zoom-fullscreen')) {\n                toggleFullScreen(false);\n                if (!fullScreen) {\n                    if (!$btnFull.hasClass('active')) {\n                        $modal.removeClass('file-zoom-fullscreen');\n                        self.$modal.find('.kv-zoom-body').css('height', self.zoomModalHeight);\n                    } else {\n                        $btnFull.removeClass('active').attr('aria-pressed', 'false');\n                    }\n                } else {\n                    if (!$btnFull.hasClass('active')) {\n                        $modal.removeClass('file-zoom-fullscreen');\n                        self._resizeZoomDialog(true);\n                        if ($btnBord.hasClass('active')) {\n                            $btnBord.removeClass('active').attr('aria-pressed', 'false');\n                        }\n                    }\n                }\n            } else {\n                if (!fullScreen) {\n                    self._maximizeZoomDialog();\n                    return;\n                }\n                toggleFullScreen(true);\n            }\n            $modal.focus();\n        },\n        _setZoomContent: function ($preview, animate) {\n            var self = this, $content, tmplt, body, title, $body, $dataEl, config, previewId = $preview.attr('id'),\n                $modal = self.$modal, $prev = $modal.find('.btn-prev'), $next = $modal.find('.btn-next'), $tmp,\n                $btnFull = $modal.find('.btn-fullscreen'), $btnBord = $modal.find('.btn-borderless'),\n                $btnTogh = $modal.find('.btn-toggleheader');\n            tmplt = $preview.data('template') || 'generic';\n            $content = $preview.find('.kv-file-content');\n            body = $content.length ? $content.html() : '';\n            title = $preview.find('.file-footer-caption').text() || '';\n            $modal.find('.kv-zoom-title').html(title);\n            $body = $modal.find('.kv-zoom-body');\n            if (animate) {\n                $tmp = $body.clone().insertAfter($body);\n                $body.html(body).hide();\n                $tmp.fadeOut('fast', function () {\n                    $body.fadeIn('fast');\n                    $tmp.remove();\n                });\n            } else {\n                $body.html(body);\n            }\n            config = self.previewZoomSettings[tmplt];\n            if (config) {\n                $dataEl = $body.find('.kv-preview-data');\n                addCss($dataEl, 'file-zoom-detail');\n                $.each(config, function (key, value) {\n                    $dataEl.css(key, value);\n                    if (($dataEl.attr('width') && key === 'width') || ($dataEl.attr('height') && key === 'height')) {\n                        $dataEl.removeAttr(key);\n                    }\n                });\n            }\n            $modal.data('previewId', previewId);\n            handler($prev, 'click', function () {\n                self._zoomSlideShow('prev', previewId);\n            });\n            handler($next, 'click', function () {\n                self._zoomSlideShow('next', previewId);\n            });\n            handler($btnFull, 'click', function () {\n                self._resizeZoomDialog(true);\n            });\n            handler($btnBord, 'click', function () {\n                self._resizeZoomDialog(false);\n            });\n            handler($btnTogh, 'click', function () {\n                var $header = $modal.find('.modal-header'), $floatBar = $modal.find('.modal-body .floating-buttons'),\n                    ht, $actions = $header.find('.kv-zoom-actions'), resize = function (height) {\n                        var $body = self.$modal.find('.kv-zoom-body'), h = self.zoomModalHeight;\n                        if ($modal.hasClass('file-zoom-fullscreen')) {\n                            h = $body.outerHeight(true);\n                            if (!height) {\n                                h = h - $header.outerHeight(true);\n                            }\n                        }\n                        $body.css('height', height ? h + height : h);\n                    };\n                if ($header.is(':visible')) {\n                    ht = $header.outerHeight(true);\n                    $header.slideUp('slow', function () {\n                        $actions.find('.btn').appendTo($floatBar);\n                        resize(ht);\n                    });\n                } else {\n                    $floatBar.find('.btn').appendTo($actions);\n                    $header.slideDown('slow', function () {\n                        resize();\n                    });\n                }\n                $modal.focus();\n            });\n            handler($modal, 'keydown', function (e) {\n                var key = e.which || e.keyCode;\n                if (key === 37 && !$prev.attr('disabled')) {\n                    self._zoomSlideShow('prev', previewId);\n                }\n                if (key === 39 && !$next.attr('disabled')) {\n                    self._zoomSlideShow('next', previewId);\n                }\n            });\n        },\n        _zoomPreview: function ($btn) {\n            var self = this, $preview;\n            if (!$btn.length) {\n                throw 'Cannot zoom to detailed preview!';\n            }\n            self.$modal.html(self._getModalContent());\n            $preview = $btn.closest('.file-preview-frame');\n            self._setZoomContent($preview);\n            self.$modal.modal('show');\n            self._initZoomButtons();\n        },\n        _zoomSlideShow: function (dir, previewId) {\n            var self = this, $btn = self.$modal.find('.kv-zoom-actions .btn-' + dir), $targFrame, i,\n                frames = self.$preview.find('.file-preview-frame').toArray(), len = frames.length, out;\n            if ($btn.attr('disabled')) {\n                return;\n            }\n            for (i = 0; i < len; i++) {\n                if ($(frames[i]).attr('id') === previewId) {\n                    out = dir === 'prev' ? i - 1 : i + 1;\n                    break;\n                }\n            }\n            if (out < 0 || out >= len || !frames[out]) {\n                return;\n            }\n            $targFrame = $(frames[out]);\n            if ($targFrame.length) {\n                self._setZoomContent($targFrame, true);\n            }\n            self._initZoomButtons();\n            self._raise('filezoom' + dir, {'previewId': previewId, modal: self.$modal});\n        },\n        _initZoomButton: function () {\n            var self = this;\n            self.$preview.find('.kv-file-zoom').each(function () {\n                var $el = $(this);\n                handler($el, 'click', function () {\n                    self._zoomPreview($el);\n                });\n            });\n        },\n        _initPreviewActions: function () {\n            var self = this, deleteExtraData = self.deleteExtraData || {},\n                resetProgress = function () {\n                    var hasFiles = self.isUploadable ? previewCache.count(self.id) : self.$element.get(0).files.length;\n                    if (self.$preview.find('.kv-file-remove').length === 0 && !hasFiles) {\n                        self.reset();\n                        self.initialCaption = '';\n                    }\n                };\n            self._initZoomButton();\n            self.$preview.find('.kv-file-remove').each(function () {\n                var $el = $(this), vUrl = $el.data('url') || self.deleteUrl, vKey = $el.data('key');\n                if (isEmpty(vUrl) || vKey === undefined) {\n                    return;\n                }\n                var $frame = $el.closest('.file-preview-frame'), cache = previewCache.data[self.id],\n                    settings, params, index = $frame.data('fileindex'), config, extraData;\n                index = parseInt(index.replace('init_', ''));\n                config = isEmpty(cache.config) && isEmpty(cache.config[index]) ? null : cache.config[index];\n                extraData = isEmpty(config) || isEmpty(config.extra) ? deleteExtraData : config.extra;\n                if (typeof extraData === \"function\") {\n                    extraData = extraData();\n                }\n                params = {id: $el.attr('id'), key: vKey, extra: extraData};\n                settings = $.extend(true, {}, {\n                    url: vUrl,\n                    type: 'POST',\n                    dataType: 'json',\n                    data: $.extend(true, {}, {key: vKey}, extraData),\n                    beforeSend: function (jqXHR) {\n                        self.ajaxAborted = false;\n                        self._raise('filepredelete', [vKey, jqXHR, extraData]);\n                        if (self.ajaxAborted) {\n                            jqXHR.abort();\n                        } else {\n                            addCss($frame, 'file-uploading');\n                            addCss($el, 'disabled');\n                        }\n                    },\n                    success: function (data, textStatus, jqXHR) {\n                        var n, cap;\n                        if (isEmpty(data) || isEmpty(data.error)) {\n                            previewCache.unset(self.id, index);\n                            n = previewCache.count(self.id);\n                            cap = n > 0 ? self._getMsgSelected(n) : '';\n                            self._raise('filedeleted', [vKey, jqXHR, extraData]);\n                            self._setCaption(cap);\n                        } else {\n                            params.jqXHR = jqXHR;\n                            params.response = data;\n                            self._showError(data.error, params, 'filedeleteerror');\n                            $frame.removeClass('file-uploading');\n                            $el.removeClass('disabled');\n                            resetProgress();\n                            return;\n                        }\n                        $frame.removeClass('file-uploading').addClass('file-deleted');\n                        $frame.fadeOut('slow', function () {\n                            self._clearObjects($frame);\n                            $frame.remove();\n                            resetProgress();\n                            if (!n && self.getFileStack().length === 0) {\n                                self._setCaption('');\n                                self.reset();\n                            }\n                        });\n                    },\n                    error: function (jqXHR, textStatus, errorThrown) {\n                        var errMsg = self._parseError(jqXHR, errorThrown);\n                        params.jqXHR = jqXHR;\n                        params.response = {};\n                        self._showError(errMsg, params, 'filedeleteerror');\n                        $frame.removeClass('file-uploading');\n                        resetProgress();\n                    }\n                }, self.ajaxDeleteSettings);\n                handler($el, 'click', function () {\n                    if (!self._validateMinCount()) {\n                        return false;\n                    }\n                    $.ajax(settings);\n                });\n            });\n        },\n        _clearObjects: function ($el) {\n            $el.find('video audio').each(function () {\n                this.pause();\n                $(this).remove();\n            });\n            $el.find('img object div').each(function () {\n                $(this).remove();\n            });\n        },\n        _clearFileInput: function () {\n            var self = this, $el = self.$element, $srcFrm, $tmpFrm, $tmpEl;\n            if (isEmpty($el.val())) {\n                return;\n            }\n            // Fix for IE ver < 11, that does not clear file inputs. Requires a sequence of steps to prevent IE\n            // crashing but still allow clearing of the file input.\n            if (self.isIE9 || self.isIE10) {\n                $srcFrm = $el.closest('form');\n                $tmpFrm = $(document.createElement('form'));\n                $tmpEl = $(document.createElement('div'));\n                $el.before($tmpEl);\n                if ($srcFrm.length) {\n                    $srcFrm.after($tmpFrm);\n                } else {\n                    $tmpEl.after($tmpFrm);\n                }\n                $tmpFrm.append($el).trigger('reset');\n                $tmpEl.before($el).remove();\n                $tmpFrm.remove();\n            } else { // normal input clear behavior for other sane browsers\n                $el.val('');\n            }\n            self.fileInputCleared = true;\n        },\n        _resetUpload: function () {\n            var self = this;\n            self.uploadCache = {content: [], config: [], tags: [], append: true};\n            self.uploadCount = 0;\n            self.uploadStatus = {};\n            self.uploadLog = [];\n            self.uploadAsyncCount = 0;\n            self.loadedImages = [];\n            self.totalImagesCount = 0;\n            self.$btnUpload.removeAttr('disabled');\n            self._setProgress(0);\n            addCss(self.$progress, 'hide');\n            self._resetErrors(false);\n            self.ajaxAborted = false;\n            self.ajaxRequests = [];\n            self._resetCanvas();\n        },\n        _resetCanvas: function () {\n            var self = this;\n            if (self.canvas && self.imageCanvasContext) {\n                self.imageCanvasContext.clearRect(0, 0, self.canvas.width, self.canvas.height);\n            }\n        },\n        _hasInitialPreview: function () {\n            var self = this;\n            return !self.overwriteInitial && previewCache.count(self.id);\n        },\n        _resetPreview: function () {\n            var self = this, out, cap;\n            if (previewCache.count(self.id)) {\n                out = previewCache.out(self.id);\n                self.$preview.html(out.content);\n                cap = self.initialCaption ? self.initialCaption : out.caption;\n                self._setCaption(cap);\n            } else {\n                self._clearPreview();\n                self._initCaption();\n            }\n            if (self.showPreview) {\n                self._initZoom();\n                self._initSortable();\n            }\n        },\n        _clearDefaultPreview: function () {\n            var self = this;\n            self.$preview.find('.file-default-preview').remove();\n        },\n        _validateDefaultPreview: function () {\n            var self = this;\n            if (!self.showPreview || isEmpty(self.defaultPreviewContent)) {\n                return;\n            }\n            self.$preview.html('<div class=\"file-default-preview\">' + self.defaultPreviewContent + '</div>');\n            self.$container.removeClass('file-input-new');\n            self._initClickable();\n        },\n        _resetPreviewThumbs: function (isAjax) {\n            var self = this, out;\n            if (isAjax) {\n                self._clearPreview();\n                self.clearStack();\n                return;\n            }\n            if (self._hasInitialPreview()) {\n                out = previewCache.out(self.id);\n                self.$preview.html(out.content);\n                self._setCaption(out.caption);\n                self._initPreviewActions();\n            } else {\n                self._clearPreview();\n            }\n        },\n        _getLayoutTemplate: function (t) {\n            var self = this,\n                template = ifSet(t, self.layoutTemplates, defaultLayoutTemplates[t]);\n            if (isEmpty(self.customLayoutTags)) {\n                return template;\n            }\n            return replaceTags(template, self.customLayoutTags);\n        },\n        _getPreviewTemplate: function (t) {\n            var self = this,\n                template = ifSet(t, self.previewTemplates, defaultPreviewTemplates[t]);\n            if (isEmpty(self.customPreviewTags)) {\n                return template;\n            }\n            return replaceTags(template, self.customPreviewTags);\n        },\n        _getOutData: function (jqXHR, responseData, filesData) {\n            var self = this;\n            jqXHR = jqXHR || {};\n            responseData = responseData || {};\n            filesData = filesData || self.filestack.slice(0) || {};\n            return {\n                form: self.formdata,\n                files: filesData,\n                filenames: self.filenames,\n                filescount: self.getFilesCount(),\n                extra: self._getExtraData(),\n                response: responseData,\n                reader: self.reader,\n                jqXHR: jqXHR\n            };\n        },\n        _getMsgSelected: function (n) {\n            var self = this, strFiles = n === 1 ? self.fileSingle : self.filePlural;\n            return n > 0 ? self.msgSelected.replace('{n}', n).replace('{files}', strFiles) : self.msgNoFilesSelected;\n        },\n        _getThumbs: function (css) {\n            css = css || '';\n            return this.$preview.find('.file-preview-frame:not(.file-preview-initial)' + css);\n        },\n        _getExtraData: function (previewId, index) {\n            var self = this, data = self.uploadExtraData;\n            if (typeof self.uploadExtraData === \"function\") {\n                data = self.uploadExtraData(previewId, index);\n            }\n            return data;\n        },\n        _initXhr: function (xhrobj, previewId, fileCount) {\n            var self = this;\n            if (xhrobj.upload) {\n                xhrobj.upload.addEventListener('progress', function (event) {\n                    var pct = 0, total = event.total, position = event.loaded || event.position;\n                    /** @namespace event.lengthComputable */\n                    if (event.lengthComputable) {\n                        pct = Math.floor(position / total * 100);\n                    }\n                    if (previewId) {\n                        self._setAsyncUploadStatus(previewId, pct, fileCount);\n                    } else {\n                        self._setProgress(pct);\n                    }\n                }, false);\n            }\n            return xhrobj;\n        },\n        _ajaxSubmit: function (fnBefore, fnSuccess, fnComplete, fnError, previewId, index) {\n            var self = this, settings;\n            self._raise('filepreajax', [previewId, index]);\n            self._uploadExtra(previewId, index);\n            settings = $.extend(true, {}, {\n                xhr: function () {\n                    var xhrobj = $.ajaxSettings.xhr();\n                    return self._initXhr(xhrobj, previewId, self.getFileStack().length);\n                },\n                url: self.uploadUrl,\n                type: 'POST',\n                dataType: 'json',\n                data: self.formdata,\n                cache: false,\n                processData: false,\n                contentType: false,\n                beforeSend: fnBefore,\n                success: fnSuccess,\n                complete: fnComplete,\n                error: fnError\n            }, self.ajaxSettings);\n            self.ajaxRequests.push($.ajax(settings));\n        },\n        _initUploadSuccess: function (out, $thumb, allFiles) {\n            var self = this, append, data, index, $newThumb, content, config, tags, i,\n                mergeArray = function (prop, content) {\n                    if (!(self[prop] instanceof Array)) {\n                        self[prop] = [];\n                    }\n                    if (content && content.length) {\n                        self[prop] = self[prop].concat(content);\n                    }\n                };\n            if (!self.showPreview || typeof out !== 'object' || $.isEmptyObject(out)) {\n                return;\n            }\n            if (out.initialPreview !== undefined && out.initialPreview.length > 0) {\n                self.hasInitData = true;\n                content = out.initialPreview || [];\n                config = out.initialPreviewConfig || [];\n                tags = out.initialPreviewThumbTags || [];\n                append = out.append === undefined || out.append ? true : false;\n                if (content.length > 0 && !isArray(content)) {\n                    content = content.split(self.initialPreviewDelimiter);\n                }\n                self.overwriteInitial = false;\n                mergeArray('initialPreview', content);\n                mergeArray('initialPreviewConfig', config);\n                mergeArray('initialPreviewThumbTags', tags);\n                if ($thumb !== undefined) {\n                    if (!allFiles) {\n                        index = previewCache.add(self.id, content, config[0], tags[0], append);\n                        data = previewCache.get(self.id, index, false);\n                        $newThumb = $(data).hide();\n                        $thumb.after($newThumb).fadeOut('slow', function () {\n                            $newThumb.fadeIn('slow').css('display:inline-block');\n                            self._initPreviewActions();\n                            self._clearFileInput();\n                            $thumb.remove();\n                        });\n                    } else {\n                        i = $thumb.attr('data-fileindex');\n                        self.uploadCache.content[i] = content[0];\n                        self.uploadCache.config[i] = config[0] || [];\n                        self.uploadCache.tags[i] = tags[0] || [];\n                        self.uploadCache.append = append;\n                    }\n                } else {\n                    previewCache.set(self.id, content, config, tags, append);\n                    self._initPreview();\n                    self._initPreviewActions();\n                }\n            }\n        },\n        _initSuccessThumbs: function () {\n            var self = this;\n            if (!self.showPreview) {\n                return;\n            }\n            self._getThumbs('.file-preview-success').each(function () {\n                var $thumb = $(this), $remove = $thumb.find('.kv-file-remove');\n                $remove.removeAttr('disabled');\n                handler($remove, 'click', function () {\n                    var out = self._raise('filesuccessremove', [$thumb.attr('id'), $thumb.data('fileindex')]);\n                    cleanMemory($thumb);\n                    if (out === false) {\n                        return;\n                    }\n                    $thumb.fadeOut('slow', function () {\n                        $thumb.remove();\n                        if (!self.$preview.find('.file-preview-frame').length) {\n                            self.reset();\n                        }\n                    });\n                });\n            });\n        },\n        _checkAsyncComplete: function () {\n            var self = this, previewId, i;\n            for (i = 0; i < self.filestack.length; i++) {\n                if (self.filestack[i]) {\n                    previewId = self.previewInitId + \"-\" + i;\n                    if ($.inArray(previewId, self.uploadLog) === -1) {\n                        return false;\n                    }\n                }\n            }\n            return (self.uploadAsyncCount === self.uploadLog.length);\n        },\n        _uploadExtra: function (previewId, index) {\n            var self = this, data = self._getExtraData(previewId, index);\n            if (data.length === 0) {\n                return;\n            }\n            $.each(data, function (key, value) {\n                self.formdata.append(key, value);\n            });\n        },\n        _uploadSingle: function (i, files, allFiles) {\n            var self = this, total = self.getFileStack().length, formdata = new FormData(), outData,\n                previewId = self.previewInitId + \"-\" + i, $thumb, chkComplete, $btnUpload, $btnDelete,\n                hasPostData = self.filestack.length > 0 || !$.isEmptyObject(self.uploadExtraData),\n                fnBefore, fnSuccess, fnComplete, fnError, updateUploadLog, params = {id: previewId, index: i};\n            self.formdata = formdata;\n            if (self.showPreview) {\n                $thumb = $('#' + previewId + ':not(.file-preview-initial)');\n                $btnUpload = $thumb.find('.kv-file-upload');\n                $btnDelete = $thumb.find('.kv-file-remove');\n                $('#' + previewId).find('.file-thumb-progress').removeClass('hide');\n            }\n            if (total === 0 || !hasPostData || ($btnUpload && $btnUpload.hasClass('disabled')) || self._abort(params)) {\n                return;\n            }\n            updateUploadLog = function (i, previewId) {\n                self.updateStack(i, undefined);\n                self.uploadLog.push(previewId);\n                if (self._checkAsyncComplete()) {\n                    self.fileBatchCompleted = true;\n                }\n            };\n            chkComplete = function () {\n                var u = self.uploadCache;\n                if (!self.fileBatchCompleted) {\n                    return;\n                }\n                setTimeout(function () {\n                    if (self.showPreview) {\n                        previewCache.set(self.id, u.content, u.config, u.tags, u.append);\n                        if (self.hasInitData) {\n                            self._initPreview();\n                            self._initPreviewActions();\n                        }\n                    }\n                    self.unlock();\n                    self._clearFileInput();\n                    self._raise('filebatchuploadcomplete', [self.filestack, self._getExtraData()]);\n                    self.uploadCount = 0;\n                    self.uploadStatus = {};\n                    self.uploadLog = [];\n                    self._setProgress(101);\n                }, 100);\n            };\n            fnBefore = function (jqXHR) {\n                outData = self._getOutData(jqXHR);\n                self.fileBatchCompleted = false;\n                if (self.showPreview) {\n                    if (!$thumb.hasClass('file-preview-success')) {\n                        self._setThumbStatus($thumb, 'Loading');\n                        addCss($thumb, 'file-uploading');\n                    }\n                    $btnUpload.attr('disabled', true);\n                    $btnDelete.attr('disabled', true);\n                }\n                if (!allFiles) {\n                    self.lock();\n                }\n                self._raise('filepreupload', [outData, previewId, i]);\n                $.extend(true, params, outData);\n                if (self._abort(params)) {\n                    jqXHR.abort();\n                    self._setProgressCancelled();\n                }\n            };\n            fnSuccess = function (data, textStatus, jqXHR) {\n                outData = self._getOutData(jqXHR, data);\n                $.extend(true, params, outData);\n                setTimeout(function () {\n                    if (isEmpty(data) || isEmpty(data.error)) {\n                        if (self.showPreview) {\n                            self._setThumbStatus($thumb, 'Success');\n                            $btnUpload.hide();\n                            self._initUploadSuccess(data, $thumb, allFiles);\n                        }\n                        self._raise('fileuploaded', [outData, $thumb.attr('id'), i]);\n                        if (!allFiles) {\n                            self.updateStack(i, undefined);\n                        } else {\n                            updateUploadLog(i, previewId);\n                        }\n                    } else {\n                        self._showUploadError(data.error, params);\n                        self._setPreviewError($thumb, i);\n                        if (allFiles) {\n                            updateUploadLog(i, previewId);\n                        }\n                    }\n                }, 100);\n            };\n            fnComplete = function () {\n                setTimeout(function () {\n                    if (self.showPreview) {\n                        $btnUpload.removeAttr('disabled');\n                        $btnDelete.removeAttr('disabled');\n                        $thumb.removeClass('file-uploading');\n                        self._setProgress(101, $('#' + previewId).find('.file-thumb-progress'));\n                    }\n                    if (!allFiles) {\n                        self.unlock(false);\n                        self._clearFileInput();\n                    } else {\n                        chkComplete();\n                    }\n                    self._initSuccessThumbs();\n                }, 100);\n            };\n            fnError = function (jqXHR, textStatus, errorThrown) {\n                var errMsg = self._parseError(jqXHR, errorThrown, (allFiles ? files[i].name : null));\n                setTimeout(function () {\n                    if (allFiles) {\n                        updateUploadLog(i, previewId);\n                    }\n                    self.uploadStatus[previewId] = 100;\n                    self._setPreviewError($thumb, i);\n                    $.extend(true, params, self._getOutData(jqXHR));\n                    self._showUploadError(errMsg, params);\n                }, 100);\n            };\n            formdata.append(self.uploadFileAttr, files[i], self.filenames[i]);\n            formdata.append('file_id', i);\n            self._ajaxSubmit(fnBefore, fnSuccess, fnComplete, fnError, previewId, i);\n        },\n        _uploadBatch: function () {\n            var self = this, files = self.filestack, total = files.length, params = {}, fnBefore, fnSuccess, fnError,\n                fnComplete, hasPostData = self.filestack.length > 0 || !$.isEmptyObject(self.uploadExtraData),\n                setAllUploaded;\n            self.formdata = new FormData();\n            if (total === 0 || !hasPostData || self._abort(params)) {\n                return;\n            }\n            setAllUploaded = function () {\n                $.each(files, function (key) {\n                    self.updateStack(key, undefined);\n                });\n                self._clearFileInput();\n            };\n            fnBefore = function (jqXHR) {\n                self.lock();\n                var outData = self._getOutData(jqXHR);\n                if (self.showPreview) {\n                    self._getThumbs().each(function () {\n                        var $thumb = $(this), $btnUpload = $thumb.find('.kv-file-upload'),\n                            $btnDelete = $thumb.find('.kv-file-remove');\n                        if (!$thumb.hasClass('file-preview-success')) {\n                            self._setThumbStatus($thumb, 'Loading');\n                            addCss($thumb, 'file-uploading');\n                        }\n                        $btnUpload.attr('disabled', true);\n                        $btnDelete.attr('disabled', true);\n                    });\n                }\n                self._raise('filebatchpreupload', [outData]);\n                if (self._abort(outData)) {\n                    jqXHR.abort();\n                    self._setProgressCancelled();\n                }\n            };\n            fnSuccess = function (data, textStatus, jqXHR) {\n                /** @namespace data.errorkeys */\n                var outData = self._getOutData(jqXHR, data), $thumbs = self._getThumbs(':not(.file-preview-error)'), key = 0,\n                    keys = isEmpty(data) || isEmpty(data.errorkeys) ? [] : data.errorkeys;\n                if (isEmpty(data) || isEmpty(data.error)) {\n                    self._raise('filebatchuploadsuccess', [outData]);\n                    setAllUploaded();\n                    if (self.showPreview) {\n                        $thumbs.each(function () {\n                            var $thumb = $(this), $btnUpload = $thumb.find('.kv-file-upload');\n                            $thumb.find('.kv-file-upload').hide();\n                            self._setThumbStatus($thumb, 'Success');\n                            $thumb.removeClass('file-uploading');\n                            $btnUpload.removeAttr('disabled');\n                        });\n                        self._initUploadSuccess(data);\n                    } else {\n                        self.reset();\n                    }\n                } else {\n                    if (self.showPreview) {\n                        $thumbs.each(function () {\n                            var $thumb = $(this), $btnDelete = $thumb.find('.kv-file-remove'),\n                                $btnUpload = $thumb.find('.kv-file-upload');\n                            $thumb.removeClass('file-uploading');\n                            $btnUpload.removeAttr('disabled');\n                            $btnDelete.removeAttr('disabled');\n                            if (keys.length === 0) {\n                                self._setPreviewError($thumb);\n                                return;\n                            }\n                            if ($.inArray(key, keys) !== -1) {\n                                self._setPreviewError($thumb);\n                            } else {\n                                $thumb.find('.kv-file-upload').hide();\n                                self._setThumbStatus($thumb, 'Success');\n                                self.updateStack(key, undefined);\n                            }\n                            key++;\n                        });\n                        self._initUploadSuccess(data);\n                    }\n                    self._showUploadError(data.error, outData, 'filebatchuploaderror');\n                }\n            };\n            fnComplete = function () {\n                self._setProgress(101);\n                self.unlock();\n                self._initSuccessThumbs();\n                self._clearFileInput();\n                self._raise('filebatchuploadcomplete', [self.filestack, self._getExtraData()]);\n            };\n            fnError = function (jqXHR, textStatus, errorThrown) {\n                var outData = self._getOutData(jqXHR), errMsg = self._parseError(jqXHR, errorThrown);\n                self._showUploadError(errMsg, outData, 'filebatchuploaderror');\n                self.uploadFileCount = total - 1;\n                if (!self.showPreview) {\n                    return;\n                }\n                self._getThumbs().each(function () {\n                    var $thumb = $(this), key = $thumb.attr('data-fileindex');\n                    $thumb.removeClass('file-uploading');\n                    if (self.filestack[key] !== undefined) {\n                        self._setPreviewError($thumb);\n                    }\n                });\n                self._getThumbs().removeClass('file-uploading');\n                self._getThumbs(' .kv-file-upload').removeAttr('disabled');\n                self._getThumbs(' .kv-file-delete').removeAttr('disabled');\n            };\n            $.each(files, function (key, data) {\n                if (!isEmpty(files[key])) {\n                    self.formdata.append(self.uploadFileAttr, data, self.filenames[key]);\n                }\n            });\n            self._ajaxSubmit(fnBefore, fnSuccess, fnComplete, fnError);\n        },\n        _uploadExtraOnly: function () {\n            var self = this, params = {}, fnBefore, fnSuccess, fnComplete, fnError;\n            self.formdata = new FormData();\n            if (self._abort(params)) {\n                return;\n            }\n            fnBefore = function (jqXHR) {\n                self.lock();\n                var outData = self._getOutData(jqXHR);\n                self._raise('filebatchpreupload', [outData]);\n                self._setProgress(50);\n                params.data = outData;\n                params.xhr = jqXHR;\n                if (self._abort(params)) {\n                    jqXHR.abort();\n                    self._setProgressCancelled();\n                }\n            };\n            fnSuccess = function (data, textStatus, jqXHR) {\n                var outData = self._getOutData(jqXHR, data);\n                if (isEmpty(data) || isEmpty(data.error)) {\n                    self._raise('filebatchuploadsuccess', [outData]);\n                    self._clearFileInput();\n                    self._initUploadSuccess(data);\n                } else {\n                    self._showUploadError(data.error, outData, 'filebatchuploaderror');\n                }\n            };\n            fnComplete = function () {\n                self._setProgress(101);\n                self.unlock();\n                self._clearFileInput();\n                self._raise('filebatchuploadcomplete', [self.filestack, self._getExtraData()]);\n            };\n            fnError = function (jqXHR, textStatus, errorThrown) {\n                var outData = self._getOutData(jqXHR), errMsg = self._parseError(jqXHR, errorThrown);\n                params.data = outData;\n                self._showUploadError(errMsg, outData, 'filebatchuploaderror');\n            };\n            self._ajaxSubmit(fnBefore, fnSuccess, fnComplete, fnError);\n        },\n        _initFileActions: function () {\n            var self = this;\n            if (!self.showPreview) {\n                return;\n            }\n            self._initZoomButton();\n            self.$preview.find('.kv-file-remove').each(function () {\n                var $el = $(this), $frame = $el.closest('.file-preview-frame'), hasError,\n                    id = $frame.attr('id'), ind = $frame.attr('data-fileindex'), n, cap, status;\n                handler($el, 'click', function () {\n                    status = self._raise('filepreremove', [id, ind]);\n                    if (status === false || !self._validateMinCount()) {\n                        return false;\n                    }\n                    hasError = $frame.hasClass('file-preview-error');\n                    cleanMemory($frame);\n                    $frame.fadeOut('slow', function () {\n                        self.updateStack(ind, undefined);\n                        self._clearObjects($frame);\n                        $frame.remove();\n                        if (id && hasError) {\n                            self.$errorContainer.find('li[data-file-id=\"' + id + '\"]').fadeOut('fast', function () {\n                                $(this).remove();\n                                if (!self._errorsExist()) {\n                                    self._resetErrors();\n                                }\n                            });\n                        }\n                        self._clearFileInput();\n                        var filestack = self.getFileStack(true), chk = previewCache.count(self.id),\n                            len = filestack.length,\n                            hasThumb = self.showPreview && self.$preview.find('.file-preview-frame').length;\n                        if (len === 0 && chk === 0 && !hasThumb) {\n                            self.reset();\n                        } else {\n                            n = chk + len;\n                            cap = n > 1 ? self._getMsgSelected(n) : (filestack[0] ? self._getFileNames()[0] : '');\n                            self._setCaption(cap);\n                        }\n                        self._raise('fileremoved', [id, ind]);\n                    });\n                });\n            });\n            self.$preview.find('.kv-file-upload').each(function () {\n                var $el = $(this);\n                handler($el, 'click', function () {\n                    var $frame = $el.closest('.file-preview-frame'),\n                        ind = $frame.attr('data-fileindex');\n                    if (!$frame.hasClass('file-preview-error')) {\n                        self._uploadSingle(ind, self.filestack, false);\n                    }\n                });\n            });\n        },\n        _hideFileIcon: function () {\n            if (this.overwriteInitial) {\n                this.$captionContainer.find('.kv-caption-icon').hide();\n            }\n        },\n        _showFileIcon: function () {\n            this.$captionContainer.find('.kv-caption-icon').show();\n        },\n        _getSize: function (bytes) {\n            var size = parseFloat(bytes);\n            if (bytes === null || isNaN(size)) {\n                return '';\n            }\n            var self = this, i, func = self.fileSizeGetter, sizes, out;\n            if (typeof func === 'function') {\n                out = func(bytes);\n            } else {\n                i = Math.floor(Math.log(size) / Math.log(1024));\n                sizes = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n                out = (size / Math.pow(1024, i)).toFixed(2) * 1 + ' ' + sizes[i];\n            }\n            return self._getLayoutTemplate('size').replace('{sizeText}', out);\n        },\n        _generatePreviewTemplate: function (cat, data, fname, ftype, previewId, isError, size, frameClass, foot, ind) {\n            var self = this, tmplt = self._getPreviewTemplate(cat), content, sText, css = frameClass || '',\n                config = ifSet(cat, self.previewSettings, defaultPreviewSettings[cat]), caption = self.slug(fname),\n                footer = foot || self._renderFileFooter(caption, size, config.width, isError);\n            ind = ind || previewId.slice(previewId.lastIndexOf('-') + 1);\n            tmplt = self._parseFilePreviewIcon(tmplt, fname);\n            if (cat === 'text' || cat === 'html') {\n                sText = cat === 'text' ? htmlEncode(data) : data;\n                content = tmplt.replace(/\\{previewId}/g, previewId).replace(/\\{caption}/g, caption)\n                    .replace(/\\{width}/g, config.width).replace(/\\{height}/g, config.height)\n                    .replace(/\\{frameClass}/g, css).replace(/\\{cat}/g, ftype)\n                    .replace(/\\{footer}/g, footer).replace(/\\{fileindex}/g, ind)\n                    .replace(/\\{data}/g, sText).replace(/\\{template}/g, cat);\n            } else {\n                content = tmplt.replace(/\\{previewId}/g, previewId).replace(/\\{caption}/g, caption)\n                    .replace(/\\{frameClass}/g, css).replace(/\\{type}/g, ftype).replace(/\\{fileindex}/g, ind)\n                    .replace(/\\{width}/g, config.width).replace(/\\{height}/g, config.height)\n                    .replace(/\\{footer}/g, footer).replace(/\\{data}/g, data).replace(/\\{template}/g, cat);\n            }\n            return content;\n        },\n        _previewDefault: function (file, previewId, isDisabled) {\n            var self = this, $preview = self.$preview, $previewLive = $preview.find('.file-live-thumbs');\n            if (!self.showPreview) {\n                return;\n            }\n            var fname = file ? file.name : '', ftype = file ? file.type : '', content,\n                isError = isDisabled === true && !self.isUploadable, data = objUrl.createObjectURL(file);\n            self._clearDefaultPreview();\n            content = self._generatePreviewTemplate('other', data, fname, ftype, previewId, isError, file.size);\n            if (!$previewLive.length) {\n                $previewLive = $(document.createElement('div')).addClass('file-live-thumbs').appendTo($preview);\n            }\n            $previewLive.append(\"\\n\" + content);\n            if (isDisabled === true && self.isUploadable) {\n                self._setThumbStatus($('#' + previewId), 'Error');\n            }\n        },\n        _previewFile: function (i, file, theFile, previewId, data) {\n            if (!this.showPreview) {\n                return;\n            }\n            var self = this, cat = self._parseFileType(file), fname = file ? file.name : '', caption = self.slug(fname),\n                types = self.allowedPreviewTypes, mimes = self.allowedPreviewMimeTypes, $preview = self.$preview,\n                chkTypes = types && types.indexOf(cat) >= 0, $previewLive = $preview.find('.file-live-thumbs'),\n                iData = (cat === 'text' || cat === 'html' || cat === 'image') ? theFile.target.result : data, content,\n                chkMimes = mimes && mimes.indexOf(file.type) !== -1;\n            if (!$previewLive.length) {\n                $previewLive = $(document.createElement('div')).addClass('file-live-thumbs').appendTo($preview);\n            }\n            /** @namespace window.DOMPurify */\n            if (cat === 'html' && self.purifyHtml && window.DOMPurify) {\n                iData = window.DOMPurify.sanitize(iData);\n            }\n            if (chkTypes || chkMimes) {\n                content = self._generatePreviewTemplate(cat, iData, fname, file.type, previewId, false, file.size);\n                self._clearDefaultPreview();\n                $previewLive.append(\"\\n\" + content);\n                self._validateImage(i, previewId, caption, file.type);\n            } else {\n                self._previewDefault(file, previewId);\n            }\n            self._initSortable();\n        },\n        _slugDefault: function (text) {\n            return isEmpty(text) ? '' : String(text).replace(/[\\-\\[\\]\\/\\{}:;#%=\\(\\)\\*\\+\\?\\\\\\^\\$\\|<>&\"']/g, '_');\n        },\n        _readFiles: function (files) {\n            this.reader = new FileReader();\n            var self = this, $el = self.$element, $preview = self.$preview, reader = self.reader,\n                $container = self.$previewContainer, $status = self.$previewStatus, msgLoading = self.msgLoading,\n                msgProgress = self.msgProgress, previewInitId = self.previewInitId, numFiles = files.length,\n                settings = self.fileTypeSettings, ctr = self.filestack.length, readFile,\n                maxPreviewSize = self.maxFilePreviewSize && parseFloat(self.maxFilePreviewSize),\n                canPreview = $preview.length && (!maxPreviewSize || isNaN(maxPreviewSize)),\n                throwError = function (msg, file, previewId, index) {\n                    var p1 = $.extend(true, {}, self._getOutData({}, {}, files), {id: previewId, index: index}),\n                        p2 = {id: previewId, index: index, file: file, files: files};\n                    self._previewDefault(file, previewId, true);\n                    if (self.isUploadable) {\n                        self.addToStack(undefined);\n                    }\n                    setTimeout(function () {\n                        readFile(index + 1);\n                    }, 100);\n                    self._initFileActions();\n                    if (self.removeFromPreviewOnError) {\n                        $('#' + previewId).remove();\n                    }\n                    return self.isUploadable ? self._showUploadError(msg, p1) : self._showError(msg, p2);\n                };\n\n            self.loadedImages = [];\n            self.totalImagesCount = 0;\n\n            $.each(files, function (key, file) {\n                var func = self.fileTypeSettings.image || defaultFileTypeSettings.image;\n                if (func && func(file.type)) {\n                    self.totalImagesCount++;\n                }\n            });\n            readFile = function (i) {\n                if (isEmpty($el.attr('multiple'))) {\n                    numFiles = 1;\n                }\n                if (i >= numFiles) {\n                    if (self.isUploadable && self.filestack.length > 0) {\n                        self._raise('filebatchselected', [self.getFileStack()]);\n                    } else {\n                        self._raise('filebatchselected', [files]);\n                    }\n                    $container.removeClass('file-thumb-loading');\n                    $status.html('');\n                    return;\n                }\n                var node = ctr + i, previewId = previewInitId + \"-\" + node, isText, isImage, file = files[i],\n                    caption = self.slug(file.name), fileSize = (file.size || 0) / 1000, checkFile, fileExtExpr = '',\n                    previewData = objUrl.createObjectURL(file), fileCount = 0, j, msg, typ, chk,\n                    fileTypes = self.allowedFileTypes, strTypes = isEmpty(fileTypes) ? '' : fileTypes.join(', '),\n                    fileExt = self.allowedFileExtensions, strExt = isEmpty(fileExt) ? '' : fileExt.join(', ');\n                if (!isEmpty(fileExt)) {\n                    fileExtExpr = new RegExp('\\\\.(' + fileExt.join('|') + ')$', 'i');\n                }\n                fileSize = fileSize.toFixed(2);\n                if (self.maxFileSize > 0 && fileSize > self.maxFileSize) {\n                    msg = self.msgSizeTooLarge.replace('{name}', caption)\n                        .replace('{size}', fileSize)\n                        .replace('{maxSize}', self.maxFileSize);\n                    self.isError = throwError(msg, file, previewId, i);\n                    return;\n                }\n                if (!isEmpty(fileTypes) && isArray(fileTypes)) {\n                    for (j = 0; j < fileTypes.length; j += 1) {\n                        typ = fileTypes[j];\n                        checkFile = settings[typ];\n                        chk = (checkFile !== undefined && checkFile(file.type, caption));\n                        fileCount += isEmpty(chk) ? 0 : chk.length;\n                    }\n                    if (fileCount === 0) {\n                        msg = self.msgInvalidFileType.replace('{name}', caption).replace('{types}', strTypes);\n                        self.isError = throwError(msg, file, previewId, i);\n                        return;\n                    }\n                }\n                if (fileCount === 0 && !isEmpty(fileExt) && isArray(fileExt) && !isEmpty(fileExtExpr)) {\n                    chk = compare(caption, fileExtExpr);\n                    fileCount += isEmpty(chk) ? 0 : chk.length;\n                    if (fileCount === 0) {\n                        msg = self.msgInvalidFileExtension.replace('{name}', caption).replace('{extensions}',\n                            strExt);\n                        self.isError = throwError(msg, file, previewId, i);\n                        return;\n                    }\n                }\n                if (!self.showPreview) {\n                    self.addToStack(file);\n                    setTimeout(function () {\n                        readFile(i + 1);\n                    }, 100);\n                    self._raise('fileloaded', [file, previewId, i, reader]);\n                    return;\n                }\n                if (!canPreview && fileSize > maxPreviewSize) {\n                    self.addToStack(file);\n                    $container.addClass('file-thumb-loading');\n                    self._previewDefault(file, previewId);\n                    self._initFileActions();\n                    self._updateFileDetails(numFiles);\n                    readFile(i + 1);\n                    return;\n                }\n                if ($preview.length && FileReader !== undefined) {\n                    $status.html(msgLoading.replace('{index}', i + 1).replace('{files}', numFiles));\n                    $container.addClass('file-thumb-loading');\n                    reader.onerror = function (evt) {\n                        self._errorHandler(evt, caption);\n                    };\n                    reader.onload = function (theFile) {\n                        self._previewFile(i, file, theFile, previewId, previewData);\n                        self._initFileActions();\n                    };\n                    reader.onloadend = function () {\n                        msg = msgProgress.replace('{index}', i + 1).replace('{files}', numFiles)\n                            .replace('{percent}', 50).replace('{name}', caption);\n                        setTimeout(function () {\n                            $status.html(msg);\n                            self._updateFileDetails(numFiles);\n                            readFile(i + 1);\n                        }, 100);\n                        self._raise('fileloaded', [file, previewId, i, reader]);\n                    };\n                    reader.onprogress = function (data) {\n                        if (data.lengthComputable) {\n                            var fact = (data.loaded / data.total) * 100, progress = Math.ceil(fact);\n                            msg = msgProgress.replace('{index}', i + 1).replace('{files}', numFiles)\n                                .replace('{percent}', progress).replace('{name}', caption);\n                            setTimeout(function () {\n                                $status.html(msg);\n                            }, 100);\n                        }\n                    };\n                    isText = ifSet('text', settings, defaultFileTypeSettings.text);\n                    isImage = ifSet('image', settings, defaultFileTypeSettings.image);\n\n                    if (isText(file.type, caption)) {\n                        reader.readAsText(file, self.textEncoding);\n                    } else {\n                        if (isImage(file.type, caption)) {\n                            reader.readAsDataURL(file);\n                        } else {\n                            reader.readAsArrayBuffer(file);\n                        }\n                    }\n                } else {\n                    self._previewDefault(file, previewId);\n                    setTimeout(function () {\n                        readFile(i + 1);\n                        self._updateFileDetails(numFiles);\n                    }, 100);\n                    self._raise('fileloaded', [file, previewId, i, reader]);\n                }\n                self.addToStack(file);\n            };\n\n            readFile(0);\n            self._updateFileDetails(numFiles, false);\n        },\n        _updateFileDetails: function (numFiles) {\n            var self = this, $el = self.$element, fileStack = self.getFileStack(),\n                name = (isIE(9) && findFileName($el.val())) ||\n                    ($el[0].files[0] && $el[0].files[0].name) || (fileStack.length && fileStack[0].name) || '',\n                label = self.slug(name), n = self.isUploadable ? fileStack.length : numFiles,\n                nFiles = previewCache.count(self.id) + n, log = n > 1 ? self._getMsgSelected(nFiles) : label;\n            if (self.isError) {\n                self.$previewContainer.removeClass('file-thumb-loading');\n                self.$previewStatus.html('');\n                self.$captionContainer.find('.kv-caption-icon').hide();\n            } else {\n                self._showFileIcon();\n            }\n            self._setCaption(log, self.isError);\n            self.$container.removeClass('file-input-new file-input-ajax-new');\n            if (arguments.length === 1) {\n                self._raise('fileselect', [numFiles, label]);\n            }\n            if (previewCache.count(self.id)) {\n                self._initPreviewActions();\n            }\n        },\n        _setThumbStatus: function ($thumb, status) {\n            var self = this;\n            if (!self.showPreview) {\n                return;\n            }\n            var icon = 'indicator' + status, msg = icon + 'Title',\n                css = 'file-preview-' + status.toLowerCase(),\n                $indicator = $thumb.find('.file-upload-indicator'),\n                config = self.fileActionSettings;\n            $thumb.removeClass('file-preview-success file-preview-error file-preview-loading');\n            if (status === 'Error') {\n                $thumb.find('.kv-file-upload').attr('disabled', true);\n            }\n            if (status === 'Success') {\n                $thumb.find('.file-drag-handle').remove();\n                $indicator.css('margin-left', 0);\n            }\n            $indicator.html(config[icon]);\n            $indicator.attr('title', config[msg]);\n            $thumb.addClass(css);\n        },\n        _setProgressCancelled: function () {\n            var self = this;\n            self._setProgress(101, self.$progress, self.msgCancelled);\n        },\n        _setProgress: function (p, $el, error) {\n            var self = this, pct = Math.min(p, 100), template = pct < 100 ? self.progressTemplate :\n                    (error ? self.progressErrorTemplate : (p <= 100 ? self.progressTemplate : self.progressCompleteTemplate)),\n                pctLimit = self.progressUploadThreshold;\n            $el = $el || self.$progress;\n            if (!isEmpty(template)) {\n                if (pctLimit && pct > pctLimit && p <= 100) {\n                    var out = template.replace('{percent}', pctLimit).replace('{percent}', pctLimit).replace('{percent}%', self.msgUploadThreshold);\n                    $el.html(out);\n                } else {\n                    $el.html(template.replace(/\\{percent}/g, pct));\n                }\n                if (error) {\n                    $el.find('[role=\"progressbar\"]').html(error);\n                }\n            }\n        },\n        _setFileDropZoneTitle: function () {\n            var self = this, $zone = self.$container.find('.file-drop-zone'), title = self.dropZoneTitle, strFiles;\n            if (self.isClickable) {\n                strFiles = isEmpty(self.$element.attr('multiple')) ? self.fileSingle : self.filePlural;\n                title += self.dropZoneClickTitle.replace('{files}', strFiles);\n            }\n            $zone.find('.' + self.dropZoneTitleClass).remove();\n            if (!self.isUploadable || !self.showPreview || $zone.length === 0 || self.getFileStack().length > 0 || !self.dropZoneEnabled) {\n                return;\n            }\n            if ($zone.find('.file-preview-frame').length === 0 && isEmpty(self.defaultPreviewContent)) {\n                $zone.prepend('<div class=\"' + self.dropZoneTitleClass + '\">' + title + '</div>');\n            }\n            self.$container.removeClass('file-input-new');\n            addCss(self.$container, 'file-input-ajax-new');\n        },\n        _setAsyncUploadStatus: function (previewId, pct, total) {\n            var self = this, sum = 0;\n            self._setProgress(pct, $('#' + previewId).find('.file-thumb-progress'));\n            self.uploadStatus[previewId] = pct;\n            $.each(self.uploadStatus, function (key, value) {\n                sum += value;\n            });\n            self._setProgress(Math.floor(sum / total));\n\n        },\n        _validateMinCount: function () {\n            var self = this, len = self.isUploadable ? self.getFileStack().length : self.$element.get(0).files.length;\n            if (self.validateInitialCount && self.minFileCount > 0 && self._getFileCount(len - 1) < self.minFileCount) {\n                self._noFilesError({});\n                return false;\n            }\n            return true;\n        },\n        _getFileCount: function (fileCount) {\n            var self = this, addCount = 0;\n            if (self.validateInitialCount && !self.overwriteInitial) {\n                addCount = previewCache.count(self.id);\n                fileCount += addCount;\n            }\n            return fileCount;\n        },\n        _getFileName: function (file) {\n            return file && file.name ? this.slug(file.name) : undefined;\n        },\n        _getFileNames: function (skipNull) {\n            var self = this;\n            return self.filenames.filter(function (n) {\n                return (skipNull ? n !== undefined : n !== undefined && n !== null);\n            });\n        },\n        _setPreviewError: function ($thumb, i, val) {\n            var self = this;\n            if (i !== undefined) {\n                self.updateStack(i, val);\n            }\n            if (self.removeFromPreviewOnError) {\n                $thumb.remove();\n            } else {\n                self._setThumbStatus($thumb, 'Error');\n            }\n        },\n        _checkDimensions: function (i, chk, $img, $thumb, fname, type, params) {\n            var self = this, msg, dim, tag = chk === 'Small' ? 'min' : 'max', limit = self[tag + 'Image' + type],\n                $imgEl, isValid;\n            if (isEmpty(limit) || !$img.length) {\n                return;\n            }\n            $imgEl = $img[0];\n            dim = (type === 'Width') ? $imgEl.naturalWidth || $imgEl.width : $imgEl.naturalHeight || $imgEl.height;\n            isValid = chk === 'Small' ? dim >= limit : dim <= limit;\n            if (isValid) {\n                return;\n            }\n            msg = self['msgImage' + type + chk].replace('{name}', fname).replace('{size}', limit);\n            self._showUploadError(msg, params);\n            self._setPreviewError($thumb, i, null);\n        },\n        _validateImage: function (i, previewId, fname, ftype) {\n            var self = this, $preview = self.$preview, params, w1, w2,\n                $thumb = $preview.find(\"#\" + previewId), $img = $thumb.find('img');\n            fname = fname || 'Untitled';\n            if (!$img.length) {\n                return;\n            }\n            handler($img, 'load', function () {\n                w1 = $thumb.width();\n                w2 = $preview.width();\n                if (w1 > w2) {\n                    $img.css('width', '100%');\n                    $thumb.css('width', '97%');\n                }\n                params = {ind: i, id: previewId};\n                self._checkDimensions(i, 'Small', $img, $thumb, fname, 'Width', params);\n                self._checkDimensions(i, 'Small', $img, $thumb, fname, 'Height', params);\n                if (!self.resizeImage) {\n                    self._checkDimensions(i, 'Large', $img, $thumb, fname, 'Width', params);\n                    self._checkDimensions(i, 'Large', $img, $thumb, fname, 'Height', params);\n                }\n                self._raise('fileimageloaded', [previewId]);\n                self.loadedImages.push({ind: i, img: $img, thumb: $thumb, pid: previewId, typ: ftype});\n                self._validateAllImages();\n                objUrl.revokeObjectURL($img.attr('src'));\n            });\n        },\n        _validateAllImages: function () {\n            var self = this, i, config, $img, $thumb, pid, ind, params = {}, errFunc;\n            if (self.loadedImages.length !== self.totalImagesCount) {\n                return;\n            }\n            self._raise('fileimagesloaded');\n            if (!self.resizeImage) {\n                return;\n            }\n            errFunc = self.isUploadable ? self._showUploadError : self._showError;\n            for (i = 0; i < self.loadedImages.length; i++) {\n                config = self.loadedImages[i];\n                $img = config.img;\n                $thumb = config.thumb;\n                pid = config.pid;\n                ind = config.ind;\n                params = {id: pid, 'index': ind};\n                if (!self._getResizedImage($img[0], config.typ, pid, ind)) {\n                    errFunc(self.msgImageResizeError, params, 'fileimageresizeerror');\n                    self._setPreviewError($thumb, ind);\n                }\n            }\n            self._raise('fileimagesresized');\n        },\n        _getResizedImage: function (image, type, pid, ind) {\n            var self = this, width = image.naturalWidth, height = image.naturalHeight, ratio = 1,\n                maxWidth = self.maxImageWidth || width, maxHeight = self.maxImageHeight || height,\n                isValidImage = (width && height), chkWidth, chkHeight,\n                canvas = self.imageCanvas, context = self.imageCanvasContext;\n            if (!isValidImage) {\n                return false;\n            }\n            if (width === maxWidth && height === maxHeight) {\n                return true;\n            }\n            type = type || self.resizeDefaultImageType;\n            chkWidth = width > maxWidth;\n            chkHeight = height > maxHeight;\n            if (self.resizePreference === 'width') {\n                ratio = chkWidth ? maxWidth / width : (chkHeight ? maxHeight / height : 1);\n            } else {\n                ratio = chkHeight ? maxHeight / height : (chkWidth ? maxWidth / width : 1);\n            }\n            self._resetCanvas();\n            width *= ratio;\n            height *= ratio;\n            canvas.width = width;\n            canvas.height = height;\n            try {\n                context.drawImage(image, 0, 0, width, height);\n                canvas.toBlob(function (blob) {\n                    self._raise('fileimageresized', [pid, ind]);\n                    self.filestack[ind] = blob;\n                }, type, self.resizeQuality);\n                return true;\n            }\n            catch (err) {\n                return false;\n            }\n        },\n        _initBrowse: function ($container) {\n            var self = this;\n            if (self.showBrowse) {\n                self.$btnFile = $container.find('.btn-file');\n                self.$btnFile.append(self.$element);\n            } else {\n                self.$element.hide();\n            }\n        },\n        _initCaption: function () {\n            var self = this, cap = self.initialCaption || '';\n            if (self.overwriteInitial || isEmpty(cap)) {\n                self.$caption.html('');\n                return false;\n            }\n            self._setCaption(cap);\n            return true;\n        },\n        _setCaption: function (content, isError) {\n            var self = this, title, out, n, cap, stack = self.getFileStack();\n            if (!self.$caption.length) {\n                return;\n            }\n            if (isError) {\n                title = $('<div>' + self.msgValidationError + '</div>').text();\n                n = stack.length;\n                if (n) {\n                    cap = n === 1 && stack[0] ? self._getFileNames()[0] : self._getMsgSelected(n);\n                } else {\n                    cap = self._getMsgSelected(self.msgNo);\n                }\n                out = '<span class=\"' + self.msgValidationErrorClass + '\">' + self.msgValidationErrorIcon +\n                    (isEmpty(content) ? cap : content) + '</span>';\n            } else {\n                if (isEmpty(content)) {\n                    return;\n                }\n                title = $('<div>' + content + '</div>').text();\n                out = self._getLayoutTemplate('fileIcon') + title;\n            }\n            self.$caption.html(out);\n            self.$caption.attr('title', title);\n            self.$captionContainer.find('.file-caption-ellipsis').attr('title', title);\n        },\n        _createContainer: function () {\n            var self = this, $container = $(document.createElement(\"div\"))\n                .attr({\"class\": 'file-input file-input-new'})\n                .html(self._renderMain());\n            self.$element.before($container);\n            self._initBrowse($container);\n            if (self.theme) {\n                $container.addClass('theme-' + self.theme);\n            }\n            return $container;\n        },\n        _refreshContainer: function () {\n            var self = this, $container = self.$container;\n            $container.before(self.$element);\n            $container.html(self._renderMain());\n            self._initBrowse($container);\n        },\n        _renderMain: function () {\n            var self = this, dropCss = (self.isUploadable && self.dropZoneEnabled) ? ' file-drop-zone' : 'file-drop-disabled',\n                close = !self.showClose ? '' : self._getLayoutTemplate('close'),\n                preview = !self.showPreview ? '' : self._getLayoutTemplate('preview')\n                    .replace(/\\{class}/g, self.previewClass)\n                    .replace(/\\{dropClass}/g, dropCss),\n                css = self.isDisabled ? self.captionClass + ' file-caption-disabled' : self.captionClass,\n                caption = self.captionTemplate.replace(/\\{class}/g, css + ' kv-fileinput-caption');\n            return self.mainTemplate.replace(/\\{class}/g, self.mainClass +\n                (!self.showBrowse && self.showCaption ? ' no-browse' : ''))\n                .replace(/\\{preview}/g, preview)\n                .replace(/\\{close}/g, close)\n                .replace(/\\{caption}/g, caption)\n                .replace(/\\{upload}/g, self._renderButton('upload'))\n                .replace(/\\{remove}/g, self._renderButton('remove'))\n                .replace(/\\{cancel}/g, self._renderButton('cancel'))\n                .replace(/\\{browse}/g, self._renderButton('browse'));\n        },\n        _renderButton: function (type) {\n            var self = this, tmplt = self._getLayoutTemplate('btnDefault'), css = self[type + 'Class'],\n                title = self[type + 'Title'], icon = self[type + 'Icon'], label = self[type + 'Label'],\n                status = self.isDisabled ? ' disabled' : '', btnType = 'button';\n            switch (type) {\n                case 'remove':\n                    if (!self.showRemove) {\n                        return '';\n                    }\n                    break;\n                case 'cancel':\n                    if (!self.showCancel) {\n                        return '';\n                    }\n                    css += ' hide';\n                    break;\n                case 'upload':\n                    if (!self.showUpload) {\n                        return '';\n                    }\n                    if (self.isUploadable && !self.isDisabled) {\n                        tmplt = self._getLayoutTemplate('btnLink').replace('{href}', self.uploadUrl);\n                    } else {\n                        btnType = 'submit';\n                    }\n                    break;\n                case 'browse':\n                    if (!self.showBrowse) {\n                        return '';\n                    }\n                    tmplt = self._getLayoutTemplate('btnBrowse');\n                    break;\n                default:\n                    return '';\n            }\n\n            css += type === 'browse' ? ' btn-file' : ' fileinput-' + type + ' fileinput-' + type + '-button';\n            if (!isEmpty(label)) {\n                label = ' <span class=\"' + self.buttonLabelClass + '\">' + label + '</span>';\n            }\n            return tmplt.replace('{type}', btnType).replace('{css}', css).replace('{title}', title)\n                .replace('{status}', status).replace('{icon}', icon).replace('{label}', label);\n        },\n        _renderThumbProgress: function () {\n            return '<div class=\"file-thumb-progress hide\">' + this.progressTemplate.replace(/\\{percent}/g,\n                    '0') + '</div>';\n        },\n        _renderFileFooter: function (caption, size, width, isError) {\n            var self = this, config = self.fileActionSettings, rem = config.showRemove, drg = config.showDrag,\n                upl = config.showUpload, zoom = config.showZoom, out, template = self._getLayoutTemplate('footer'),\n                indicator = isError ? config.indicatorError : config.indicatorNew,\n                title = isError ? config.indicatorErrorTitle : config.indicatorNewTitle;\n            size = self._getSize(size);\n            if (self.isUploadable) {\n                out = template.replace(/\\{actions}/g, self._renderFileActions(upl, rem, zoom, drg, false, false, false))\n                    .replace(/\\{caption}/g, caption).replace(/\\{size}/g, size).replace(/\\{width}/g, width)\n                    .replace(/\\{progress}/g, self._renderThumbProgress()).replace(/\\{indicator}/g, indicator)\n                    .replace(/\\{indicatorTitle}/g, title);\n            } else {\n                out = template.replace(/\\{actions}/g,\n                    self._renderFileActions(false, false, zoom, drg, false, false, false))\n                    .replace(/\\{caption}/g, caption).replace(/\\{size}/g, size).replace(/\\{width}/g, width)\n                    .replace(/\\{progress}/g, '').replace(/\\{indicator}/g, indicator)\n                    .replace(/\\{indicatorTitle}/g, title);\n            }\n            out = replaceTags(out, self.previewThumbTags);\n            return out;\n        },\n        _renderFileActions: function (showUpload, showDelete, showZoom, showDrag, disabled, url, key, isInit) {\n            if (!showUpload && !showDelete && !showZoom && !showDrag) {\n                return '';\n            }\n            var self = this,\n                vUrl = url === false ? '' : ' data-url=\"' + url + '\"',\n                vKey = key === false ? '' : ' data-key=\"' + key + '\"',\n                btnDelete = '', btnUpload = '', btnZoom = '', btnDrag = '', css,\n                template = self._getLayoutTemplate('actions'), config = self.fileActionSettings,\n                otherButtons = self.otherActionButtons.replace(/\\{dataKey}/g, vKey),\n                removeClass = disabled ? config.removeClass + ' disabled' : config.removeClass;\n            if (showDelete) {\n                btnDelete = self._getLayoutTemplate('actionDelete')\n                    .replace(/\\{removeClass}/g, removeClass)\n                    .replace(/\\{removeIcon}/g, config.removeIcon)\n                    .replace(/\\{removeTitle}/g, config.removeTitle)\n                    .replace(/\\{dataUrl}/g, vUrl)\n                    .replace(/\\{dataKey}/g, vKey);\n            }\n            if (showUpload) {\n                btnUpload = self._getLayoutTemplate('actionUpload')\n                    .replace(/\\{uploadClass}/g, config.uploadClass)\n                    .replace(/\\{uploadIcon}/g, config.uploadIcon)\n                    .replace(/\\{uploadTitle}/g, config.uploadTitle);\n            }\n            if (showZoom) {\n                btnZoom = self._getLayoutTemplate('actionZoom')\n                    .replace(/\\{zoomClass}/g, config.zoomClass)\n                    .replace(/\\{zoomIcon}/g, config.zoomIcon)\n                    .replace(/\\{zoomTitle}/g, config.zoomTitle);\n            }\n            if (showDrag && isInit) {\n                css = 'drag-handle-init ' + config.dragClass;\n                btnDrag = self._getLayoutTemplate('actionDrag').replace(/\\{dragClass}/g, css)\n                    .replace(/\\{dragTitle}/g, config.dragTitle)\n                    .replace(/\\{dragIcon}/g, config.dragIcon);\n            }\n            return template.replace(/\\{delete}/g, btnDelete)\n                .replace(/\\{upload}/g, btnUpload)\n                .replace(/\\{zoom}/g, btnZoom)\n                .replace(/\\{drag}/g, btnDrag)\n                .replace(/\\{other}/g, otherButtons);\n        },\n        _browse: function (e) {\n            var self = this;\n            self._raise('filebrowse');\n            if (e && e.isDefaultPrevented()) {\n                return;\n            }\n            if (self.isError && !self.isUploadable) {\n                self.clear();\n            }\n            self.$captionContainer.focus();\n        },\n        _change: function (e) {\n            var self = this, $el = self.$element;\n            if (!self.isUploadable && isEmpty($el.val()) && self.fileInputCleared) { // IE 11 fix\n                self.fileInputCleared = false;\n                return;\n            }\n            self.fileInputCleared = false;\n            var tfiles, msg, total, isDragDrop = arguments.length > 1, isAjaxUpload = self.isUploadable, i = 0, f, n, len,\n                files = isDragDrop ? e.originalEvent.dataTransfer.files : $el.get(0).files, ctr = self.filestack.length,\n                isSingleUpload = isEmpty($el.attr('multiple')), flagSingle = (isSingleUpload && ctr > 0), folders = 0,\n                throwError = function (mesg, file, previewId, index) {\n                    var p1 = $.extend(true, {}, self._getOutData({}, {}, files), {id: previewId, index: index}),\n                        p2 = {id: previewId, index: index, file: file, files: files};\n                    return self.isUploadable ? self._showUploadError(mesg, p1) : self._showError(mesg, p2);\n                };\n            self.reader = null;\n            self._resetUpload();\n            self._hideFileIcon();\n            if (self.isUploadable) {\n                self.$container.find('.file-drop-zone .' + self.dropZoneTitleClass).remove();\n            }\n            if (isDragDrop) {\n                tfiles = [];\n                while (files[i]) {\n                    f = files[i];\n                    if (!f.type && f.size % 4096 === 0) {\n                        folders++;\n                    } else {\n                        tfiles.push(f);\n                    }\n                    i++;\n                }\n            } else {\n                if (e.target.files === undefined) {\n                    tfiles = e.target && e.target.value ? [\n                        {name: e.target.value.replace(/^.+\\\\/, '')}\n                    ] : [];\n                } else {\n                    tfiles = e.target.files;\n                }\n            }\n            if (isEmpty(tfiles) || tfiles.length === 0) {\n                if (!isAjaxUpload) {\n                    self.clear();\n                }\n                self._showFolderError(folders);\n                self._raise('fileselectnone');\n                return;\n            }\n            self._resetErrors();\n            len = tfiles.length;\n            total = self._getFileCount(self.isUploadable ? (self.getFileStack().length + len) : len);\n            if (self.maxFileCount > 0 && total > self.maxFileCount) {\n                if (!self.autoReplace || len > self.maxFileCount) {\n                    n = (self.autoReplace && len > self.maxFileCount) ? len : total;\n                    msg = self.msgFilesTooMany.replace('{m}', self.maxFileCount).replace('{n}', n);\n                    self.isError = throwError(msg, null, null, null);\n                    self.$captionContainer.find('.kv-caption-icon').hide();\n                    self._setCaption('', true);\n                    self.$container.removeClass('file-input-new file-input-ajax-new');\n                    return;\n                }\n                if (total > self.maxFileCount) {\n                    self._resetPreviewThumbs(isAjaxUpload);\n                }\n            } else {\n                if (!isAjaxUpload || flagSingle) {\n                    self._resetPreviewThumbs(false);\n                    if (flagSingle) {\n                        self.clearStack();\n                    }\n                } else {\n                    if (isAjaxUpload && ctr === 0 && (!previewCache.count(self.id) || self.overwriteInitial)) {\n                        self._resetPreviewThumbs(true);\n                    }\n                }\n            }\n            if (self.isPreviewable) {\n                self._readFiles(tfiles);\n            } else {\n                self._updateFileDetails(1);\n            }\n            self._showFolderError(folders);\n        },\n        _abort: function (params) {\n            var self = this, data;\n            if (self.ajaxAborted && typeof self.ajaxAborted === \"object\" && self.ajaxAborted.message !== undefined) {\n                data = $.extend(true, {}, self._getOutData(), params);\n                data.abortData = self.ajaxAborted.data || {};\n                data.abortMessage = self.ajaxAborted.message;\n                self.cancel();\n                self._setProgress(101, self.$progress, self.msgCancelled);\n                self._showUploadError(self.ajaxAborted.message, data, 'filecustomerror');\n                return true;\n            }\n            return false;\n        },\n        _resetFileStack: function () {\n            var self = this, i = 0, newstack = [], newnames = [];\n            self._getThumbs().each(function () {\n                var $thumb = $(this), ind = $thumb.attr('data-fileindex'),\n                    file = self.filestack[ind];\n                if (ind === -1) {\n                    return;\n                }\n                if (file !== undefined) {\n                    newstack[i] = file;\n                    newnames[i] = self._getFileName(file);\n                    $thumb.attr({\n                        'id': self.previewInitId + '-' + i,\n                        'data-fileindex': i\n                    });\n                    i++;\n                } else {\n                    $thumb.attr({\n                        'id': 'uploaded-' + uniqId(),\n                        'data-fileindex': '-1'\n                    });\n                }\n            });\n            self.filestack = newstack;\n            self.filenames = newnames;\n        },\n        clearStack: function () {\n            var self = this;\n            self.filestack = [];\n            self.filenames = [];\n            return self.$element;\n        },\n        updateStack: function (i, file) {\n            var self = this;\n            self.filestack[i] = file;\n            self.filenames[i] = self._getFileName(file);\n            return self.$element;\n        },\n        addToStack: function (file) {\n            var self = this;\n            self.filestack.push(file);\n            self.filenames.push(self._getFileName(file));\n            return self.$element;\n        },\n        getFileStack: function (skipNull) {\n            var self = this;\n            return self.filestack.filter(function (n) {\n                return (skipNull ? n !== undefined : n !== undefined && n !== null);\n            });\n        },\n        getFilesCount: function () {\n            var self = this, len = self.isUploadable ? self.getFileStack().length : self.$element.get(0).files.length;\n            return self._getFileCount(len);\n        },\n        lock: function () {\n            var self = this;\n            self._resetErrors();\n            self.disable();\n            if (self.showRemove) {\n                addCss(self.$container.find('.fileinput-remove'), 'hide');\n            }\n            if (self.showCancel) {\n                self.$container.find('.fileinput-cancel').removeClass('hide');\n            }\n            self._raise('filelock', [self.filestack, self._getExtraData()]);\n            return self.$element;\n        },\n        unlock: function (reset) {\n            var self = this;\n            if (reset === undefined) {\n                reset = true;\n            }\n            self.enable();\n            if (self.showCancel) {\n                addCss(self.$container.find('.fileinput-cancel'), 'hide');\n            }\n            if (self.showRemove) {\n                self.$container.find('.fileinput-remove').removeClass('hide');\n            }\n            if (reset) {\n                self._resetFileStack();\n            }\n            self._raise('fileunlock', [self.filestack, self._getExtraData()]);\n            return self.$element;\n        },\n        cancel: function () {\n            var self = this, xhr = self.ajaxRequests, len = xhr.length, i;\n            if (len > 0) {\n                for (i = 0; i < len; i += 1) {\n                    self.cancelling = true;\n                    xhr[i].abort();\n                }\n            }\n            self._setProgressCancelled();\n            self._getThumbs().each(function () {\n                var $thumb = $(this), ind = $thumb.attr('data-fileindex');\n                $thumb.removeClass('file-uploading');\n                if (self.filestack[ind] !== undefined) {\n                    $thumb.find('.kv-file-upload').removeClass('disabled').removeAttr('disabled');\n                    $thumb.find('.kv-file-remove').removeClass('disabled').removeAttr('disabled');\n                }\n                self.unlock();\n            });\n            return self.$element;\n        },\n        clear: function () {\n            var self = this, cap;\n            self.$btnUpload.removeAttr('disabled');\n            self._getThumbs().find('video,audio,img').each(function () {\n                cleanMemory($(this));\n            });\n            self._resetUpload();\n            self.clearStack();\n            self._clearFileInput();\n            self._resetErrors(true);\n            self._raise('fileclear');\n            if (self._hasInitialPreview()) {\n                self._showFileIcon();\n                self._resetPreview();\n                self._initPreviewActions();\n                self.$container.removeClass('file-input-new');\n            } else {\n                self._getThumbs().each(function () {\n                    self._clearObjects($(this));\n                });\n                if (self.isUploadable) {\n                    previewCache.data[self.id] = {};\n                }\n                self.$preview.html('');\n                cap = (!self.overwriteInitial && self.initialCaption.length > 0) ? self.initialCaption : '';\n                self.$caption.html(cap);\n                self.$caption.attr('title', '');\n                addCss(self.$container, 'file-input-new');\n                self._validateDefaultPreview();\n            }\n            if (self.$container.find('.file-preview-frame').length === 0) {\n                if (!self._initCaption()) {\n                    self.$captionContainer.find('.kv-caption-icon').hide();\n                }\n            }\n            self._hideFileIcon();\n            self._raise('filecleared');\n            self.$captionContainer.focus();\n            self._setFileDropZoneTitle();\n            return self.$element;\n        },\n        reset: function () {\n            var self = this;\n            self._resetPreview();\n            self.$container.find('.fileinput-filename').text('');\n            self._raise('filereset');\n            addCss(self.$container, 'file-input-new');\n            if (self.$preview.find('.file-preview-frame').length || self.isUploadable && self.dropZoneEnabled) {\n                self.$container.removeClass('file-input-new');\n            }\n            self._setFileDropZoneTitle();\n            self.clearStack();\n            self.formdata = {};\n            return self.$element;\n        },\n        disable: function () {\n            var self = this;\n            self.isDisabled = true;\n            self._raise('filedisabled');\n            self.$element.attr('disabled', 'disabled');\n            self.$container.find(\".kv-fileinput-caption\").addClass(\"file-caption-disabled\");\n            self.$container.find(\".btn-file, .fileinput-remove, .fileinput-upload, .file-preview-frame button\").attr(\n                \"disabled\",\n                true);\n            self._initDragDrop();\n            return self.$element;\n        },\n        enable: function () {\n            var self = this;\n            self.isDisabled = false;\n            self._raise('fileenabled');\n            self.$element.removeAttr('disabled');\n            self.$container.find(\".kv-fileinput-caption\").removeClass(\"file-caption-disabled\");\n            self.$container.find(\n                \".btn-file, .fileinput-remove, .fileinput-upload, .file-preview-frame button\").removeAttr(\"disabled\");\n            self._initDragDrop();\n            return self.$element;\n        },\n        upload: function () {\n            var self = this, totLen = self.getFileStack().length, params = {},\n                i, outData, len, hasExtraData = !$.isEmptyObject(self._getExtraData());\n            if (self.minFileCount > 0 && self._getFileCount(totLen) < self.minFileCount) {\n                self._noFilesError(params);\n                return;\n            }\n            if (!self.isUploadable || self.isDisabled || (totLen === 0 && !hasExtraData)) {\n                return;\n            }\n            self._resetUpload();\n            self.$progress.removeClass('hide');\n            self.uploadCount = 0;\n            self.uploadStatus = {};\n            self.uploadLog = [];\n            self.lock();\n            self._setProgress(2);\n            if (totLen === 0 && hasExtraData) {\n                self._uploadExtraOnly();\n                return;\n            }\n            len = self.filestack.length;\n            self.hasInitData = false;\n            if (self.uploadAsync) {\n                outData = self._getOutData();\n                self._raise('filebatchpreupload', [outData]);\n                self.fileBatchCompleted = false;\n                self.uploadCache = {content: [], config: [], tags: [], append: true};\n                self.uploadAsyncCount = self.getFileStack().length;\n                for (i = 0; i < len; i++) {\n                    self.uploadCache.content[i] = null;\n                    self.uploadCache.config[i] = null;\n                    self.uploadCache.tags[i] = null;\n                }\n                for (i = 0; i < len; i++) {\n                    if (self.filestack[i] !== undefined) {\n                        self._uploadSingle(i, self.filestack, true);\n                    }\n                }\n                return;\n            }\n            self._uploadBatch();\n            return self.$element;\n        },\n        destroy: function () {\n            var self = this, $cont = self.$container;\n            $cont.find('.file-drop-zone').off();\n            self.$element.insertBefore($cont).off(NAMESPACE).removeData();\n            $cont.off().remove();\n            return self.$element;\n        },\n        refresh: function (options) {\n            var self = this, $el = self.$element;\n            options = options ? $.extend(true, {}, self.options, options) : self.options;\n            self.destroy();\n            $el.fileinput(options);\n            if ($el.val()) {\n                $el.trigger('change.fileinput');\n            }\n            return $el;\n        }\n    };\n\n    $.fn.fileinput = function (option) {\n        if (!hasFileAPISupport() && !isIE(9)) {\n            return;\n        }\n        var args = Array.apply(null, arguments), retvals = [];\n        args.shift();\n        this.each(function () {\n            var self = $(this), data = self.data('fileinput'), options = typeof option === 'object' && option,\n                theme = options.theme || self.data('theme'), l = {}, t = {},\n                lang = options.language || self.data('language') || 'en', opts;\n            if (!data) {\n                if (theme) {\n                    t = $.fn.fileinputThemes[theme] || {};\n                }\n                if (lang !== 'en' && !isEmpty($.fn.fileinputLocales[lang])) {\n                    l = $.fn.fileinputLocales[lang] || {};\n                }\n                opts = $.extend(true, {}, $.fn.fileinput.defaults, t, $.fn.fileinputLocales.en, l, options,\n                    self.data());\n                data = new FileInput(this, opts);\n                self.data('fileinput', data);\n            }\n\n            if (typeof option === 'string') {\n                retvals.push(data[option].apply(data, args));\n            }\n        });\n        switch (retvals.length) {\n            case 0:\n                return this;\n            case 1:\n                return retvals[0];\n            default:\n                return retvals;\n        }\n    };\n\n    $.fn.fileinput.defaults = {\n        language: 'en',\n        showCaption: true,\n        showBrowse: true,\n        showPreview: true,\n        showRemove: true,\n        showUpload: true,\n        showCancel: true,\n        showClose: true,\n        showUploadedThumbs: true,\n        browseOnZoneClick: false,\n        autoReplace: false,\n        previewClass: '',\n        captionClass: '',\n        mainClass: 'file-caption-main',\n        mainTemplate: null,\n        purifyHtml: true,\n        fileSizeGetter: null,\n        initialCaption: '',\n        initialPreview: [],\n        initialPreviewDelimiter: '*$$*',\n        initialPreviewAsData: false,\n        initialPreviewFileType: 'image',\n        initialPreviewConfig: [],\n        initialPreviewThumbTags: [],\n        previewThumbTags: {},\n        initialPreviewShowDelete: true,\n        removeFromPreviewOnError: false,\n        deleteUrl: '',\n        deleteExtraData: {},\n        overwriteInitial: true,\n        layoutTemplates: defaultLayoutTemplates,\n        previewTemplates: defaultPreviewTemplates,\n        previewZoomSettings: defaultPreviewZoomSettings,\n        previewZoomButtonIcons: {\n            prev: '<i class=\"glyphicon glyphicon-triangle-left\"></i>',\n            next: '<i class=\"glyphicon glyphicon-triangle-right\"></i>',\n            toggleheader: '<i class=\"glyphicon glyphicon-resize-vertical\"></i>',\n            fullscreen: '<i class=\"glyphicon glyphicon-fullscreen\"></i>',\n            borderless: '<i class=\"glyphicon glyphicon-resize-full\"></i>',\n            close: '<i class=\"glyphicon glyphicon-remove\"></i>'\n        },\n        previewZoomButtonClasses: {\n            prev: 'btn btn-navigate',\n            next: 'btn btn-navigate',\n            toggleheader: 'btn btn-default btn-header-toggle',\n            fullscreen: 'btn btn-default',\n            borderless: 'btn btn-default',\n            close: 'btn btn-default'\n        },\n        allowedPreviewTypes: defaultPreviewTypes,\n        allowedPreviewMimeTypes: null,\n        allowedFileTypes: null,\n        allowedFileExtensions: null,\n        defaultPreviewContent: null,\n        customLayoutTags: {},\n        customPreviewTags: {},\n        previewSettings: defaultPreviewSettings,\n        fileTypeSettings: defaultFileTypeSettings,\n        previewFileIcon: '<i class=\"glyphicon glyphicon-file\"></i>',\n        previewFileIconClass: 'file-other-icon',\n        previewFileIconSettings: {},\n        previewFileExtSettings: {},\n        buttonLabelClass: 'hidden-xs',\n        browseIcon: '<i class=\"glyphicon glyphicon-folder-open\"></i>&nbsp;',\n        browseClass: 'btn btn-primary',\n        removeIcon: '<i class=\"glyphicon glyphicon-trash\"></i>',\n        removeClass: 'btn btn-default',\n        cancelIcon: '<i class=\"glyphicon glyphicon-ban-circle\"></i>',\n        cancelClass: 'btn btn-default',\n        uploadIcon: '<i class=\"glyphicon glyphicon-upload\"></i>',\n        uploadClass: 'btn btn-default',\n        uploadUrl: null,\n        uploadAsync: true,\n        uploadExtraData: {},\n        zoomModalHeight: 480,\n        minImageWidth: null,\n        minImageHeight: null,\n        maxImageWidth: null,\n        maxImageHeight: null,\n        resizeImage: false,\n        resizePreference: 'width',\n        resizeQuality: 0.92,\n        resizeDefaultImageType: 'image/jpeg',\n        maxFileSize: 0,\n        maxFilePreviewSize: 25600, // 25 MB\n        minFileCount: 0,\n        maxFileCount: 0,\n        validateInitialCount: false,\n        msgValidationErrorClass: 'text-danger',\n        msgValidationErrorIcon: '<i class=\"glyphicon glyphicon-exclamation-sign\"></i> ',\n        msgErrorClass: 'file-error-message',\n        progressThumbClass: \"progress-bar progress-bar-success progress-bar-striped active\",\n        progressClass: \"progress-bar progress-bar-success progress-bar-striped active\",\n        progressCompleteClass: \"progress-bar progress-bar-success\",\n        progressErrorClass: \"progress-bar progress-bar-danger\",\n        progressUploadThreshold: 99,\n        previewFileType: 'image',\n        elCaptionContainer: null,\n        elCaptionText: null,\n        elPreviewContainer: null,\n        elPreviewImage: null,\n        elPreviewStatus: null,\n        elErrorContainer: null,\n        errorCloseButton: '<span class=\"close kv-error-close\">&times;</span>',\n        slugCallback: null,\n        dropZoneEnabled: true,\n        dropZoneTitleClass: 'file-drop-zone-title',\n        fileActionSettings: {},\n        otherActionButtons: '',\n        textEncoding: 'UTF-8',\n        ajaxSettings: {},\n        ajaxDeleteSettings: {},\n        showAjaxErrorDetails: true\n    };\n\n    $.fn.fileinputLocales.en = {\n        fileSingle: 'file',\n        filePlural: 'files',\n        browseLabel: 'Browse &hellip;',\n        removeLabel: 'Remove',\n        removeTitle: 'Clear selected files',\n        cancelLabel: 'Cancel',\n        cancelTitle: 'Abort ongoing upload',\n        uploadLabel: 'Upload',\n        uploadTitle: 'Upload selected files',\n        msgNo: 'No',\n        msgNoFilesSelected: 'No files selected',\n        msgCancelled: 'Cancelled',\n        msgZoomModalHeading: 'Detailed Preview',\n        msgSizeTooLarge: 'File \"{name}\" (<b>{size} KB</b>) exceeds maximum allowed upload size of <b>{maxSize} KB</b>.',\n        msgFilesTooLess: 'You must select at least <b>{n}</b> {files} to upload.',\n        msgFilesTooMany: 'Number of files selected for upload <b>({n})</b> exceeds maximum allowed limit of <b>{m}</b>.',\n        msgFileNotFound: 'File \"{name}\" not found!',\n        msgFileSecured: 'Security restrictions prevent reading the file \"{name}\".',\n        msgFileNotReadable: 'File \"{name}\" is not readable.',\n        msgFilePreviewAborted: 'File preview aborted for \"{name}\".',\n        msgFilePreviewError: 'An error occurred while reading the file \"{name}\".',\n        msgInvalidFileType: 'Invalid type for file \"{name}\". Only \"{types}\" files are supported.',\n        msgInvalidFileExtension: 'Invalid extension for file \"{name}\". Only \"{extensions}\" files are supported.',\n        msgUploadAborted: 'The file upload was aborted',\n        msgUploadThreshold: 'Processing...',\n        msgValidationError: 'Validation Error',\n        msgLoading: 'Loading file {index} of {files} &hellip;',\n        msgProgress: 'Loading file {index} of {files} - {name} - {percent}% completed.',\n        msgSelected: '{n} {files} selected',\n        msgFoldersNotAllowed: 'Drag & drop files only! {n} folder(s) dropped were skipped.',\n        msgImageWidthSmall: 'Width of image file \"{name}\" must be at least {size} px.',\n        msgImageHeightSmall: 'Height of image file \"{name}\" must be at least {size} px.',\n        msgImageWidthLarge: 'Width of image file \"{name}\" cannot exceed {size} px.',\n        msgImageHeightLarge: 'Height of image file \"{name}\" cannot exceed {size} px.',\n        msgImageResizeError: 'Could not get the image dimensions to resize.',\n        msgImageResizeException: 'Error while resizing the image.<pre>{errors}</pre>',\n        dropZoneTitle: 'Drag & drop files here &hellip;',\n        dropZoneClickTitle: '<br>(or click to select {files})',\n        previewZoomButtonTitles: {\n            prev: 'View previous file',\n            next: 'View next file',\n            toggleheader: 'Toggle header',\n            fullscreen: 'Toggle full screen',\n            borderless: 'Toggle borderless mode',\n            close: 'Close detailed preview'\n        }\n    };\n\n    $.fn.fileinput.Constructor = FileInput;\n\n    /**\n     * Convert automatically file inputs with class 'file' into a bootstrap fileinput control.\n     */\n    $(document).ready(function () {\n        var $input = $('input.file[type=file]');\n        if ($input.length) {\n            $input.fileinput();\n        }\n    });\n}));","/*!\n * FileInput Russian Translations\n *\n * This file must be loaded after 'fileinput.js'. Patterns in braces '{}', or\n * any HTML markup tags in the messages must not be converted or translated.\n *\n * @see http://github.com/kartik-v/bootstrap-fileinput\n * @author CyanoFresh <cyanofresh@gmail.com>\n *\n * NOTE: this file must be saved in UTF-8 encoding.\n */\n(function ($) {\n    \"use strict\";\n\n    $.fn.fileinputLocales['ru'] = {\n        fileSingle: 'файл',\n        filePlural: 'файлы',\n        browseLabel: 'Выбрать &hellip;',\n        removeLabel: 'Удалить',\n        removeTitle: 'Очистить выбранные файлы',\n        cancelLabel: 'Отмена',\n        cancelTitle: 'Отменить текущую загрузку',\n        uploadLabel: 'Загрузить',\n        uploadTitle: 'Загрузить выбранные файлы',\n        msgNo: 'нет',\n        msgNoFilesSelected: '',\n        msgCancelled: 'Отменено',\n        msgZoomModalHeading: 'Подробное превью',\n        msgSizeTooLarge: 'Файл \"{name}\" (<b>{size} KB</b>) превышает максимальный размер <b>{maxSize} KB</b>.',\n        msgFilesTooLess: 'Вы должны выбрать как минимум <b>{n}</b> {files} для загрузки.',\n        msgFilesTooMany: 'Количество выбранных файлов <b>({n})</b> превышает максимально допустимое количество <b>{m}</b>.',\n        msgFileNotFound: 'Файл \"{name}\" не найден!',\n        msgFileSecured: 'Ограничения безопасности запрещают читать файл \"{name}\".',\n        msgFileNotReadable: 'Файл \"{name}\" невозможно прочитать.',\n        msgFilePreviewAborted: 'Предпросмотр отменен для файла \"{name}\".',\n        msgFilePreviewError: 'Произошла ошибка при чтении файла \"{name}\".',\n        msgInvalidFileType: 'Запрещенный тип файла для \"{name}\". Только \"{types}\" разрешены.',\n        msgInvalidFileExtension: 'Запрещенное расширение для файла \"{name}\". Только \"{extensions}\" разрешены.',\n        msgUploadAborted: 'Выгрузка файла прервана',\n        msgUploadThreshold: 'Processing...',\n        msgValidationError: 'Ошибка проверки',\n        msgLoading: 'Загрузка файла {index} из {files} &hellip;',\n        msgProgress: 'Загрузка файла {index} из {files} - {name} - {percent}% завершено.',\n        msgSelected: 'Выбрано файлов: {n}',\n        msgFoldersNotAllowed: 'Разрешено перетаскивание только файлов! Пропущено {n} папок.',\n        msgImageWidthSmall: 'Ширина изображения {name} должна быть не меньше {size} px.',\n        msgImageHeightSmall: 'Высота изображения {name} должна быть не меньше {size} px.',\n        msgImageWidthLarge: 'Ширина изображения \"{name}\" не может превышать {size} px.',\n        msgImageHeightLarge: 'Высота изображения \"{name}\" не может превышать {size} px.',\n        msgImageResizeError: 'Не удалось получить размеры изображения, чтобы изменить размер.',\n        msgImageResizeException: 'Ошибка при изменении размера изображения.<pre>{errors}</pre>',\n        dropZoneTitle: 'Перетащите файлы сюда &hellip;',\n        dropZoneClickTitle: '<br>(or click to select {files})',\n        fileActionSettings: {\n            removeTitle: 'Удалить файл',\n            uploadTitle: 'Загрузить файл',\n            zoomTitle: 'посмотреть детали',\n            dragTitle: 'Move / Rearrange',\n            indicatorNewTitle: 'Еще не загружен',\n            indicatorSuccessTitle: 'Загружен',\n            indicatorErrorTitle: 'Ошибка загрузки',\n            indicatorLoadingTitle: 'Загрузка ...'\n        },\n        previewZoomButtonTitles: {\n            prev: 'View previous file',\n            next: 'View next file',\n            toggleheader: 'Toggle header',\n            fullscreen: 'Toggle full screen',\n            borderless: 'Toggle borderless mode',\n            close: 'Close detailed preview'\n        }\n    };\n})(window.jQuery);\n","/*!\n * FileInput Ukrainian Translations\n *\n * This file must be loaded after 'fileinput.js'. Patterns in braces '{}', or\n * any HTML markup tags in the messages must not be converted or translated.\n *\n * @see http://github.com/kartik-v/bootstrap-fileinput\n * @author CyanoFresh <cyanofresh@gmail.com>\n *\n * NOTE: this file must be saved in UTF-8 encoding.\n */\n(function ($) {\n    \"use strict\";\n\n    $.fn.fileinputLocales['uk'] = {\n        fileSingle: 'файл',\n        filePlural: 'файли',\n        browseLabel: 'Вибрати &hellip;',\n        removeLabel: 'Видалити',\n        removeTitle: 'Видалити вибрані файли',\n        cancelLabel: 'Скасувати',\n        cancelTitle: 'Скасувати поточну загрузку',\n        uploadLabel: 'Загрузити',\n        uploadTitle: 'Загрузити вибрані файли',\n        msgNo: 'Немає',\n        msgNoFilesSelected: '',\n        msgCancelled: 'Cкасовано',\n        msgZoomModalHeading: 'Детальний превью',\n        msgSizeTooLarge: 'Файл \"{name}\" (<b>{size} KB</b>) перевищує максимальний розмір <b>{maxSize} KB</b>.',\n        msgFilesTooLess: 'Ви повинні вибрати як мінімум <b>{n}</b> {files} для загрузки.',\n        msgFilesTooMany: 'Кількість вибраних файлів <b>({n})</b> перевищує максимально допустиму кількість <b>{m}</b>.',\n        msgFileNotFound: 'Файл \"{name}\" не знайдено!',\n        msgFileSecured: 'Обмеження безпеки перешкоджають читанню файла \"{name}\".',\n        msgFileNotReadable: 'Файл \"{name}\" неможливо прочитати.',\n        msgFilePreviewAborted: 'Перегляд скасований для файла \"{name}\".',\n        msgFilePreviewError: 'Сталася помилка під час читання файла \"{name}\".',\n        msgInvalidFileType: 'Заборонений тип файла для \"{name}\". Тільки \"{types}\" дозволені.',\n        msgInvalidFileExtension: 'Заборонене розширення для файла \"{name}\". Тільки \"{extensions}\" дозволені.',\n        msgUploadAborted: 'Вивантаження файлу перервана',\n        msgUploadThreshold: 'Processing...',\n        msgValidationError: 'Помилка перевірки',\n        msgLoading: 'Загрузка файла {index} із {files} &hellip;',\n        msgProgress: 'Загрузка файла {index} із {files} - {name} - {percent}% завершено.',\n        msgSelected: '{n} {files} вибрано',\n        msgFoldersNotAllowed: 'Дозволено перетягувати тільки файли! Пропущено {n} папок.',\n        msgImageWidthSmall: 'Ширина зображення \"{name}\" повинна бути не менше {size} px.',\n        msgImageHeightSmall: 'Висота зображення \"{name}\" повинна бути не менше {size} px.',\n        msgImageWidthLarge: 'Ширина зображення \"{name}\" не може перевищувати {size} px.',\n        msgImageHeightLarge: 'Висота зображення \"{name}\" не може перевищувати {size} px.',\n        msgImageResizeError: 'Не вдалося розміри зображення, щоб змінити розмір.',\n        msgImageResizeException: 'Помилка при зміні розміру зображення.<pre>{errors}</pre>',\n        dropZoneTitle: 'Перетягніть файли сюди &hellip;',\n        dropZoneClickTitle: '<br>(or click to select {files})',\n        fileActionSettings: {\n            removeTitle: 'Видалити файл',\n            uploadTitle: 'Загрузити файл',\n            zoomTitle: 'Подивитися деталі',\n            dragTitle: 'Move / Rearrange',\n            indicatorNewTitle: 'Ще не загружено',\n            indicatorSuccessTitle: 'Загружено',\n            indicatorErrorTitle: 'Помилка при загрузці',\n            indicatorLoadingTitle: 'Загрузка ...'\n        },\n        previewZoomButtonTitles: {\n            prev: 'View previous file',\n            next: 'View next file',\n            toggleheader: 'Toggle header',\n            fullscreen: 'Toggle full screen',\n            borderless: 'Toggle borderless mode',\n            close: 'Close detailed preview'\n        }\n    };\n})(window.jQuery);\n"]}