$(document).ready(function(){function t(){$.get("/administration/menu/"+$(".check-language").data("lang"),function(e){if("ok"==e.status){$("#tree").empty();var a=$("#menu-template").html();Mustache.parse(a),$.each(e.data,function(t,e){e.parent>0?($("#"+e.parent+" > ol").append(Mustache.render(a,e)),$("#"+e.parent+" > ol").css("display","none"),$("#"+e.parent+" > i").removeClass("fake-width").addClass("fa fa-angle-right pull-left")):$("#tree").append(Mustache.render(a,e))}),$(".root ol").sortable({cursor:"pointer",connectWith:"ol",dropOnEmpty:!0,delay:500,placeholder:"placeholder",start:function(t,e){e.item.children("ol").addClass("hidden")},stop:function(e,a){var n=a.item.parent().closest("li").attr("id");n||"tree"!=a.item.closest("ol").attr("id")||(n=0),a.item.attr("parent",n),a.item.children("ol").removeClass("hidden");var i=[],s=[],n=[];$(".root li").each(function(t){$(this).attr("sort",t+1),i.push($(this).attr("id")),s.push($(this).attr("sort")),n.push($(this).attr("parent"))}),$.ajax("/administration/menu-sort",{data:{id:i,weight:s,parent:n},type:"POST",beforeSend:function(t){t.setRequestHeader("X-CSRF-TOKEN",$("[name='_token']").val())},error:function(t){},success:function(e){t()}})}})}},"JSON")}$(".lang").click(function(e){$(".check-language").data("lang",$(this).data("lang")),$(".current-language").html($(this).html()),t()}),t(),$("#tree").on("click","span",function(t){$(this).siblings("ol").children().is("li")&&("none"==$(this).siblings("ol").css("display")?($(this).siblings("ol").slideDown(),$(this).siblings("i").addClass("fa-angle-down").removeClass("fa-angle-right")):($(this).siblings("ol").slideUp(),$(this).siblings("i").removeClass("fa-angle-down").addClass("fa-angle-right")))}),$("#tree").on("click",".btn-edit",function(t){$.get("/administration/menu-item/"+$(this).data("id"),function(t){if("ok"==t.status){var e=JSON.parse(t.data.name);$("#slug").val(t.data.slug),$("#menu-en").val(e.en),$("#menu-ru").val(e.ru),$("#menu-uk").val(e.uk),$("#menu-id").val(t.data.id)}},"json")}),$("#tree").on("click",".btn-delete",function(t){$("#menu-item-id").val($(this).data("id")),$(".delete-name-item").html($(this).data("name"))})});